{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// Use API URL from environment, fallback to localhost:3002\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:3002';\nconst AdddogForm = () => {\n  _s();\n  const {\n    t\n  } = useTranslation();\n  const {\n    token,\n    isAuthenticated\n  } = useAuth();\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', {\n      isAuthenticated,\n      hasToken: !!token,\n      tokenLength: token === null || token === void 0 ? void 0 : token.length\n    });\n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n  const [mediaFile, setMediaFile] = useState(null);\n  const [mediaPreview, setMediaPreview] = useState(null);\n  const [smallPreview, setSmallPreview] = useState(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState(null);\n  const [mediaError, setMediaError] = useState(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = file => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob(blob => {\n          cleanup();\n          if (blob) resolve(blob);else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = e => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file, size = 64) => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = e => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  const onFileChange = async e => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try {\n        URL.revokeObjectURL(mediaPreview);\n      } catch (err) {/* ignore */}\n    }\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState(null);\n  const [successMessage, setSuccessMessage] = useState(null);\n  const abortControllerRef = useRef(null);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n  const onSubmit = async fields => {\n    var _fields$name, _fields$location;\n    console.log('Form submit triggered with fields:', fields);\n\n    // Basic validation\n    if (!((_fields$name = fields.name) !== null && _fields$name !== void 0 && _fields$name.trim())) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!((_fields$location = fields.location) !== null && _fields$location !== void 0 && _fields$location.trim())) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    if (!mediaFile) {\n      setMediaError(t('adddog.mediaRequired') || 'Image is required');\n      return;\n    } else {\n      setMediaError(null);\n    }\n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', {\n            type: 'image/jpeg'\n          });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      abortControllerRef.current = new AbortController();\n      const headers = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      });\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => {\n          if (isMountedRef.current) navigate('/psi');\n        }, 1400);\n      }\n    } catch (err) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: t('adddog.title')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: '#f0f0f0',\n        padding: '8px',\n        margin: '8px 0',\n        fontSize: '11px',\n        borderRadius: '4px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Debug:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this), \" API_URL = \", API_URL, \" | hostname = \", window.location.hostname]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"adddog-form\",\n      onSubmit: handleSubmit(onSubmit),\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-name\",\n        children: t('adddog.name')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-name\",\n        name: \"name\",\n        autoComplete: \"name\",\n        placeholder: t('adddog.name'),\n        ...register('name', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this), errors.name && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        role: \"alert\",\n        children: [t('adddog.name'), \" is required\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-breed\",\n        children: t('adddog.breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-breed\",\n        name: \"breed\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.breed'),\n        ...register('breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-color\",\n        children: t('adddog.color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-color\",\n        name: \"color\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.color'),\n        ...register('color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-location\",\n        children: t('adddog.location')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-location\",\n        name: \"location\",\n        autoComplete: \"address-level2\",\n        placeholder: t('adddog.location'),\n        ...register('location', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-age\",\n        children: t('adddog.age')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        children: t('adddogExtra.ageNote')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        id: \"adddog-age\",\n        name: \"age\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.age'),\n        step: \"0.1\",\n        ...register('age', {\n          valueAsNumber: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-description\",\n        children: t('adddog.description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        id: \"adddog-description\",\n        name: \"description\",\n        rows: 3,\n        cols: 30,\n        autoComplete: \"off\",\n        placeholder: t('adddog.description'),\n        ...register('description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-size\",\n        children: t('adddog.size')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        ...register('size'),\n        id: \"adddog-size\",\n        name: \"size\",\n        autoComplete: \"off\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"small\",\n          children: t('size.small')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"medium\",\n          children: t('size.medium')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"large\",\n          children: t('size.large')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"gender\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: t('adddog.gender')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"gender-options\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-male\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-male\",\n              name: \"gender\",\n              value: \"male\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.male')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-female\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-female\",\n              name: \"gender\",\n              value: \"female\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.female')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 344,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"health\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-vaccinated\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.vaccinated')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('vaccinated'),\n            id: \"adddog-vaccinated\",\n            name: \"vaccinated\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-neutered\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.neutered')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('neutered'),\n            id: \"adddog-neutered\",\n            name: \"neutered\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"media-upload\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"media\",\n          children: t('adddog.media')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"media-input-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"image/*,video/*\",\n            id: \"adddog-media\",\n            name: \"media\",\n            onChange: onFileChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 13\n          }, this), smallPreview && /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"thumb-small\",\n            src: smallPreview,\n            alt: \"thumb\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this), mediaError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          role: \"alert\",\n          style: {\n            color: 'red',\n            marginTop: 4\n          },\n          children: mediaError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 26\n        }, this), mediaPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"media-preview\",\n          children: isVideo ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"preview-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              src: mediaPreview,\n              controls: true,\n              width: 150,\n              poster: smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"view-full\",\n              onClick: () => window.open(mediaPreview, '_blank'),\n              children: \"View full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"preview-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: smallPreview || mediaPreview,\n              alt: \"preview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"view-full\",\n              onClick: () => window.open(mediaPreview, '_blank'),\n              children: \"View full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: submitting,\n          children: submitting ? t('adddog.saving') : t('button.addDog')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this), submitError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          role: \"alert\",\n          children: submitError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 27\n        }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification success\",\n          role: \"status\",\n          children: successMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 30\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 300,\n    columnNumber: 5\n  }, this);\n};\n_s(AdddogForm, \"JU9tlzIhLSxLtv10suN+vRwOPaM=\", false, function () {\n  return [useTranslation, useAuth, useForm, useNavigate];\n});\n_c = AdddogForm;\nexport default AdddogForm;\nvar _c;\n$RefreshReg$(_c, \"AdddogForm\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","useTranslation","useNavigate","useAuth","jsxDEV","_jsxDEV","API_URL","process","env","REACT_APP_API_URL","AdddogForm","_s","t","token","isAuthenticated","register","handleSubmit","formState","errors","defaultValues","vaccinated","neutered","navigate","isMountedRef","console","log","hasToken","tokenLength","length","warn","current","mediaFile","setMediaFile","mediaPreview","setMediaPreview","smallPreview","setSmallPreview","isVideo","setIsVideo","posterBlob","setPosterBlob","mediaError","setMediaError","createVideoPoster","file","Promise","resolve","reject","url","URL","createObjectURL","video","document","createElement","preload","muted","src","currentTime","cleanup","revokeObjectURL","onloadeddata","canvas","width","videoWidth","height","videoHeight","ctx","getContext","Error","drawImage","toBlob","blob","onerror","e","createImageThumbnail","size","img","Image","onload","ratio","Math","round","dataUrl","toDataURL","onFileChange","f","target","files","startsWith","err","type","poster","thumb","submitting","setSubmitting","submitError","setSubmitError","successMessage","setSuccessMessage","abortControllerRef","abort","onSubmit","fields","_fields$name","_fields$location","name","trim","location","window","hostname","href","formData","FormData","append","breed","color","age","undefined","String","description","posterFile","File","Object","fromEntries","entries","substring","AbortController","headers","error","resp","fetch","method","body","signal","ok","errMsg","status","statusText","json","message","JSON","stringify","txt","text","setTimeout","errorMessage","children","fileName","_jsxFileName","lineNumber","columnNumber","style","background","padding","margin","fontSize","borderRadius","id","htmlFor","autoComplete","placeholder","required","className","role","step","valueAsNumber","rows","cols","value","accept","onChange","alt","marginTop","controls","onClick","open","disabled","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface AddDogFormData {\n  name: string;\n  breed: string;\n  color?: string;\n  location: string;\n  age: number;\n  description: string;\n  size: 'small' | 'medium' | 'large';\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n}\n\n// Use API URL from environment, fallback to localhost:3002\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:3002';\n\nconst AdddogForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { token, isAuthenticated } = useAuth();\n  const { register, handleSubmit, formState: { errors } } = useForm<AddDogFormData>({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false,\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', { isAuthenticated, hasToken: !!token, tokenLength: token?.length });\n    \n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  const [mediaFile, setMediaFile] = useState<File | null>(null);\n  const [mediaPreview, setMediaPreview] = useState<string | null>(null);\n  const [smallPreview, setSmallPreview] = useState<string | null>(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState<Blob | null>(null);\n  const [mediaError, setMediaError] = useState<string | null>(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = (file: File): Promise<Blob> => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob((blob) => {\n          cleanup();\n          if (blob) resolve(blob);\n          else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = (e) => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file: File, size = 64): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = (e) => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  const onFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try { URL.revokeObjectURL(mediaPreview); } catch (err) { /* ignore */ }\n    }\n\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n\n  const onSubmit: SubmitHandler<AddDogFormData> = async (fields) => {\n    console.log('Form submit triggered with fields:', fields);\n    \n    // Basic validation\n    if (!fields.name?.trim()) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!fields.location?.trim()) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    if (!mediaFile) {\n      setMediaError(t('adddog.mediaRequired') || 'Image is required');\n      return;\n    } else {\n      setMediaError(null);\n    }\n    \n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', { type: 'image/jpeg' });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      \n      abortControllerRef.current = new AbortController();\n      \n      const headers: any = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      \n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      });\n\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => { \n          if (isMountedRef.current) navigate('/psi'); \n        }, 1400);\n      }\n    } catch (err: any) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      \n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      \n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      \n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n\n  return (\n    <main>\n      <h2>{t('adddog.title')}</h2>\n      {/* Temporary debug info */}\n      <div style={{background: '#f0f0f0', padding: '8px', margin: '8px 0', fontSize: '11px', borderRadius: '4px'}}>\n        <strong>Debug:</strong> API_URL = {API_URL} | hostname = {window.location.hostname}\n      </div>\n      \n      <form id=\"adddog-form\" onSubmit={handleSubmit(onSubmit)}>\n        <label htmlFor=\"adddog-name\">{t('adddog.name')}</label>\n        <input type=\"text\" id=\"adddog-name\" name=\"name\" autoComplete=\"name\" placeholder={t('adddog.name')} {...register('name', { required: true })} />\n        {errors.name && <div className=\"error\" role=\"alert\">{t('adddog.name')} is required</div> }\n\n        <label htmlFor=\"adddog-breed\">{t('adddog.breed')}</label>\n        <input type=\"text\" id=\"adddog-breed\" name=\"breed\" autoComplete=\"off\" placeholder={t('adddog.breed')} {...register('breed')} />\n\n        <label htmlFor=\"adddog-color\">{t('adddog.color')}</label>\n        <input type=\"text\" id=\"adddog-color\" name=\"color\" autoComplete=\"off\" placeholder={t('adddog.color')} {...register('color')} />\n\n        <label htmlFor=\"adddog-location\">{t('adddog.location')}</label>\n        <input type=\"text\" id=\"adddog-location\" name=\"location\" autoComplete=\"address-level2\" placeholder={t('adddog.location')} {...register('location', { required: true })} />\n\n        <label htmlFor=\"adddog-age\">{t('adddog.age')}</label>\n        <small>{t('adddogExtra.ageNote')}</small>\n        <input type=\"number\" id=\"adddog-age\" name=\"age\" autoComplete=\"off\" placeholder={t('adddog.age')} step=\"0.1\" {...register('age', { valueAsNumber: true })} />\n\n        <label htmlFor=\"adddog-description\">{t('adddog.description')}</label>\n        <textarea id=\"adddog-description\" name=\"description\" rows={3} cols={30} autoComplete=\"off\" placeholder={t('adddog.description')} {...register('description')} />\n\n        <label htmlFor=\"adddog-size\">{t('adddog.size')}</label>\n        <select {...register('size')} id=\"adddog-size\" name=\"size\" autoComplete=\"off\">\n          <option value=\"small\">{t('size.small')}</option>\n          <option value=\"medium\">{t('size.medium')}</option>\n          <option value=\"large\">{t('size.large')}</option>\n        </select>\n\n        <div id=\"gender\">\n          <label>{t('adddog.gender')}</label>\n          <div className=\"gender-options\">\n            <label htmlFor=\"adddog-gender-male\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-male\" name=\"gender\" value=\"male\" />\n              <span>{t('gender.male')}</span>\n            </label>\n            <label htmlFor=\"adddog-gender-female\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-female\" name=\"gender\" value=\"female\" />\n              <span>{t('gender.female')}</span>\n            </label>\n          </div>\n        </div>\n\n        <div id=\"health\">\n          <label htmlFor=\"adddog-vaccinated\">\n            <span>{t('adddog.vaccinated')}</span>\n            <input type=\"checkbox\" {...register('vaccinated')} id=\"adddog-vaccinated\" name=\"vaccinated\" />\n          </label>\n\n          <label htmlFor=\"adddog-neutered\">\n            <span>{t('adddog.neutered')}</span>\n            <input type=\"checkbox\" {...register('neutered')} id=\"adddog-neutered\" name=\"neutered\" />\n          </label>\n        </div>\n\n        <div id=\"media-upload\">\n          <label htmlFor=\"media\">{t('adddog.media')}</label>\n          <div className=\"media-input-row\">\n            <input type=\"file\" accept=\"image/*,video/*\" id=\"adddog-media\" name=\"media\" onChange={onFileChange} />\n            {smallPreview && <img className=\"thumb-small\" src={smallPreview} alt=\"thumb\" />}\n          </div>\n          {mediaError && <div className=\"error\" role=\"alert\" style={{ color: 'red', marginTop: 4 }}>{mediaError}</div>}\n          {mediaPreview && (\n            <div id=\"media-preview\">\n              {isVideo ? (\n                <div className=\"preview-wrap\">\n                  <video src={mediaPreview} controls width={150} poster={smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)}></video>\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              ) : (\n                <div className=\"preview-wrap\">\n                  <img src={smallPreview || mediaPreview} alt=\"preview\" />\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"form-actions\">\n          <button type=\"submit\" disabled={submitting}>{submitting ? t('adddog.saving') : t('button.addDog')}</button>\n          {submitError && <div className=\"error\" role=\"alert\">{submitError}</div>}\n          {successMessage && <div className=\"notification success\" role=\"status\">{successMessage}</div>}\n        </div>\n      </form>\n    </main>\n  );\n};\n\nexport default AdddogForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}