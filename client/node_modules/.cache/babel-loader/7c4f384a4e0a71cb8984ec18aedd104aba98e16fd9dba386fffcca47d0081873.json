{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/eky/client/src/components/UserProfileModal.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../contexts/AuthContext';\nimport '../css/modal.css';\n\n// Portal container for modal\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst modalRoot = document.getElementById('modal-root') || (() => {\n  const root = document.createElement('div');\n  root.id = 'modal-root';\n  // Portal root should NOT block clicks - only modal overlay should\n  root.style.position = 'absolute';\n  root.style.top = '0';\n  root.style.left = '0';\n  root.style.zIndex = '0';\n  root.style.pointerEvents = 'none';\n  document.body.appendChild(root);\n  return root;\n})();\nconst UserProfileModal = ({\n  isOpen,\n  onClose\n}) => {\n  _s();\n  const {\n    user,\n    token,\n    logout,\n    updateUser,\n    getWishlist,\n    removeFromWishlist\n  } = useAuth();\n  const typedUser = user;\n  const {\n    t\n  } = useTranslation();\n  const [isEditing, setIsEditing] = useState(false);\n  const [activeTab, setActiveTab] = useState('profile');\n  const [wishlist, setWishlist] = useState([]);\n  const [loadingWishlist, setLoadingWishlist] = useState(false);\n  const [profilePicture, setProfilePicture] = useState(null);\n  const [profilePicturePreview, setProfilePicturePreview] = useState('');\n\n  // Helper to get full image URL (robust)\n  const getProfileImageUrl = profilePicture => {\n    if (!profilePicture) return \"../img/androcolored-80x80.jpg\";\n    let url = profilePicture.startsWith('/') ? profilePicture : '/' + profilePicture;\n    // Use /u/ for compatibility if needed\n    url = url.replace('/uploads', '/u');\n    // Always use API base for /uploads/ and /u/ paths\n    if (url.startsWith('/uploads/') || url.startsWith('/u/')) {\n      const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:3001';\n      return apiBase + url;\n    }\n    // If already absolute URL, return as is\n    if (/^https?:\\/\\//.test(url)) return url;\n    // Fallback to placeholder\n    return '../img/androcolored-80x80.jpg';\n  };\n  const [formData, setFormData] = useState({\n    name: (typedUser === null || typedUser === void 0 ? void 0 : typedUser.name) || '',\n    email: (typedUser === null || typedUser === void 0 ? void 0 : typedUser.email) || '',\n    username: (typedUser === null || typedUser === void 0 ? void 0 : typedUser.username) || '',\n    phone: (typedUser === null || typedUser === void 0 ? void 0 : typedUser.phone) || ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Used to force re-render after profile update\n  const [profilePicKey, setProfilePicKey] = useState(0);\n  const [success, setSuccess] = useState(null);\n  const loadWishlist = React.useCallback(async () => {\n    setLoadingWishlist(true);\n    const wishlistData = await getWishlist();\n    setWishlist(wishlistData);\n    setLoadingWishlist(false);\n  }, [getWishlist]);\n\n  // Load wishlist when modal opens and wishlist tab is active\n  React.useEffect(() => {\n    if (isOpen) {\n      loadWishlist();\n    }\n    // Reset form data when modal opens\n    if (isOpen && user) {\n      setFormData({\n        name: typedUser.name || '',\n        email: typedUser.email || '',\n        username: typedUser.username || '',\n        phone: typedUser.phone || ''\n      });\n      setProfilePicture(null);\n      setProfilePicturePreview('');\n      setError(null);\n      setSuccess(null);\n    } else if (isOpen && !user) {\n      setFormData({\n        name: '',\n        email: '',\n        username: '',\n        phone: ''\n      });\n      setProfilePicture(null);\n      setProfilePicturePreview('');\n      setError(null);\n      setSuccess(null);\n    }\n    // Listen for wishlist-updated events (from DogList add)\n    const handler = e => {\n      if (e.detail && Array.isArray(e.detail.wishlist)) {\n        setWishlist(e.detail.wishlist);\n      }\n    };\n    window.addEventListener('wishlist-updated', handler);\n    return () => window.removeEventListener('wishlist-updated', handler);\n    // Only re-run when modal opens/closes or user ID changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen, typedUser === null || typedUser === void 0 ? void 0 : typedUser._id]);\n  const handleModalClose = React.useCallback(() => {\n    console.log('handleModalClose called');\n    setIsEditing(false);\n    setError(null);\n    setSuccess(null);\n    onClose();\n  }, [onClose]);\n\n  // Handle escape key to close modal\n  React.useEffect(() => {\n    const handleEscapeKey = event => {\n      if (event.key === 'Escape' && isOpen) {\n        console.log('Escape key pressed, closing modal');\n        handleModalClose();\n      }\n    };\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscapeKey);\n      return () => {\n        document.removeEventListener('keydown', handleEscapeKey);\n      };\n    }\n  }, [isOpen, handleModalClose]);\n\n  // Reset state when modal closes\n  React.useEffect(() => {\n    if (!isOpen) {\n      setIsEditing(false);\n      setActiveTab('profile');\n      setError(null);\n      setSuccess(null);\n      setLoading(false);\n    }\n  }, [isOpen]);\n\n  // Prevent body scrolling when modal is open\n  React.useEffect(() => {\n    if (isOpen) {\n      // Prevent body scroll\n      document.body.style.overflow = 'hidden';\n      document.body.style.position = 'fixed';\n      document.body.style.width = '100%';\n      document.body.style.height = '100%';\n\n      // Store scroll position\n      const scrollY = window.scrollY;\n      document.body.dataset.scrollY = scrollY.toString();\n\n      // Prevent touch scrolling on mobile\n      document.body.style.touchAction = 'none';\n    } else {\n      // Restore body scroll\n      const scrollY = document.body.dataset.scrollY || '0';\n      document.body.style.overflow = '';\n      document.body.style.position = '';\n      document.body.style.width = '';\n      document.body.style.height = '';\n      document.body.style.touchAction = '';\n\n      // Restore scroll position\n      window.scrollTo(0, parseInt(scrollY, 10));\n\n      // Clear stored scroll position\n      delete document.body.dataset.scrollY;\n    }\n    return () => {\n      // Cleanup when modal unmounts\n      document.body.style.overflow = '';\n      document.body.style.position = '';\n      document.body.style.width = '';\n      document.body.style.height = '';\n      document.body.style.touchAction = '';\n      delete document.body.dataset.scrollY;\n    };\n  }, [isOpen]);\n\n  // Don't render if modal is not open - MOVED AFTER ALL HOOKS\n  if (!isOpen) {\n    return null;\n  }\n  const handleAdopt = async dogId => {\n    try {\n      const API_URL = getApiUrl();\n      const resp = await fetch(`${API_URL}/api/dogs/${dogId}/adopt-request`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': token ? `Bearer ${token}` : ''\n        }\n      });\n      const data = await resp.json();\n      if (!resp.ok) throw new Error(data.message || 'Error');\n      await loadWishlist();\n    } catch (e) {\n      alert(e.message || 'Error');\n    }\n  };\n  const handleProfilePictureChange = e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (file) {\n      setProfilePicture(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setProfilePicturePreview(reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  const handlePasswordReset = async () => {\n    if (!(user !== null && user !== void 0 && user.email)) return;\n    try {\n      const API_URL = getApiUrl();\n      const response = await fetch(`${API_URL}/api/users/password-reset`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: user.email\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        setSuccess('Password reset link sent to your email!');\n        setError(null);\n      } else {\n        setError(data.message || 'Failed to send password reset email');\n        setSuccess(null);\n      }\n    } catch (error) {\n      console.error('Password reset error:', error);\n      setError('Network error. Please try again.');\n      setSuccess(null);\n    }\n  };\n\n  // Get API URL based on environment\n  const getApiUrl = () => {\n    if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n      return `http://${window.location.hostname}:3001`;\n    }\n    return `http://172.20.10.2:3001`;\n  };\n  const handleInputChange = e => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n  const handleUpdateProfile = async e => {\n    console.log('[PROFILE UPDATE DEBUG] handleUpdateProfile called');\n    if (profilePicture) {\n      console.log('[PROFILE UPDATE DEBUG] Uploading file:', profilePicture.name, 'type:', profilePicture.type);\n    }\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n    setSuccess(null);\n    try {\n      const API_URL = getApiUrl();\n\n      // Create FormData for file upload\n      const uploadFormData = new FormData();\n      uploadFormData.append('name', formData.name);\n      uploadFormData.append('username', formData.username);\n      uploadFormData.append('email', formData.email);\n      uploadFormData.append('phone', formData.phone);\n\n      // Add profile picture if selected\n      if (profilePicture) {\n        uploadFormData.append('profilePicture', profilePicture);\n        console.log('Profile picture selected:', profilePicture.name, profilePicture.size, profilePicture.type);\n      }\n      console.log('Updating profile with form data:', {\n        name: formData.name,\n        username: formData.username,\n        email: formData.email,\n        hasProfilePicture: !!profilePicture\n      });\n      let response, data;\n      try {\n        response = await fetch(`${API_URL}/api/users/profile`, {\n          method: 'PUT',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: uploadFormData\n        });\n        console.log('Response status:', response.status);\n        data = await response.json();\n        console.log('[PROFILE UPDATE DEBUG] Full server response:', data);\n        if (data && data.user) {\n          console.log('[PROFILE UPDATE DEBUG] Returned user.profilePicture:', data.user.profilePicture);\n          alert('Backend response profilePicture: ' + data.user.profilePicture);\n        }\n      } catch (err) {\n        console.error('[PROFILE UPDATE DEBUG] Error during fetch:', err);\n        return;\n      }\n      if (response.ok) {\n        setSuccess('Profile updated successfully!');\n\n        // Update both localStorage and AuthContext with new user data\n        const updatedUser = {\n          ...user,\n          name: data.user.name,\n          username: data.user.username,\n          email: data.user.email,\n          phone: data.user.phone,\n          ...(data.user.profilePicture && {\n            profilePicture: data.user.profilePicture\n          })\n        };\n\n        // Extract timestamp from filename for cache busting\n        let cacheBuster = '';\n        if (data.user.profilePicture) {\n          const match = data.user.profilePicture.match(/profile-(\\d+)/);\n          if (match && match[1]) {\n            cacheBuster = match[1];\n          }\n        }\n        console.log('[PROFILE UPDATE DEBUG] Using cacheBuster:', cacheBuster);\n        updateUser({\n          ...updatedUser,\n          _profilePicCacheBuster: cacheBuster\n        });\n        setProfilePicKey(prev => prev + 1); // Force re-render\n\n        // Reset profile picture state but keep the new image visible\n        setProfilePicture(null);\n        setProfilePicturePreview('');\n\n        // Update form data to reflect changes\n        setFormData({\n          name: data.user.name,\n          email: data.user.email,\n          username: data.user.username,\n          phone: data.user.phone || ''\n        });\n\n        // Close editing mode after successful update\n        setTimeout(() => {\n          setIsEditing(false);\n        }, 100);\n      } else {\n        console.error('Profile update failed:', data);\n        setError(data.message || 'Failed to update profile');\n      }\n    } catch (error) {\n      console.error('Profile update error:', error);\n      setError('Network error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleDeleteAccount = async () => {\n    if (!window.confirm('Are you sure you want to delete your account? This action cannot be undone.')) {\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const API_URL = getApiUrl();\n      const response = await fetch(`${API_URL}/api/users/profile`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        logout();\n        onClose();\n        alert('Account deleted successfully');\n      } else {\n        const data = await response.json();\n        setError(data.message || 'Failed to delete account');\n      }\n    } catch (error) {\n      setError('Network error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Render modal using portal to escape #Wrap container\n  return /*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal-overlay\",\n    onClick: e => {\n      // Close modal when clicking on backdrop\n      if (e.target === e.currentTarget) {\n        console.log('Backdrop clicked, closing modal');\n        handleModalClose();\n      }\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal\",\n      onClick: e => {\n        // Prevent modal from closing when clicking inside the modal\n        e.stopPropagation();\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: '20px',\n          flexShrink: 0\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            margin: 0,\n            color: '#333'\n          },\n          children: t('userProfile.title')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: e => {\n            e.preventDefault();\n            e.stopPropagation();\n            handleModalClose();\n          },\n          style: {\n            background: '#e74c3c',\n            border: 'none',\n            width: '22px',\n            height: '22px',\n            borderRadius: '50%',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            padding: 0,\n            cursor: 'pointer',\n            boxShadow: '0 2px 8px rgba(231,76,60,0.10)',\n            zIndex: 10000\n          },\n          \"aria-label\": \"Close\",\n          title: \"Close\",\n          type: \"button\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#fff',\n              fontSize: '2rem',\n              fontWeight: 900,\n              lineHeight: 1,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              width: '100%',\n              height: '100%'\n            },\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          marginBottom: '20px',\n          borderBottom: '1px solid #ddd',\n          flexShrink: 0\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab('profile'),\n          style: {\n            padding: '10px 20px',\n            border: 'none',\n            background: activeTab === 'profile' ? '#2196F3' : 'transparent',\n            color: activeTab === 'profile' ? 'white' : '#666',\n            cursor: 'pointer',\n            borderRadius: '4px 4px 0 0',\n            marginRight: '5px'\n          },\n          children: t('userProfile.profileTab')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab('wishlist'),\n          style: {\n            padding: '10px 20px',\n            border: 'none',\n            background: activeTab === 'wishlist' ? '#2196F3' : 'transparent',\n            color: activeTab === 'wishlist' ? 'white' : '#666',\n            cursor: 'pointer',\n            borderRadius: '4px 4px 0 0'\n          },\n          children: [t('userProfile.wishlistTab'), \" (\", wishlist.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: 'auto',\n          overflowX: 'hidden',\n          minHeight: 0\n        },\n        children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: '#ffebee',\n            color: '#c62828',\n            padding: '12px',\n            borderRadius: '4px',\n            marginBottom: '16px'\n          },\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 13\n        }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: '#e8f5e8',\n            color: '#2e7d32',\n            padding: '12px',\n            borderRadius: '4px',\n            marginBottom: '16px'\n          },\n          children: success\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 13\n        }, this), activeTab === 'profile' && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '20px'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center',\n                gap: '12px',\n                marginBottom: '20px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: profilePicturePreview || getProfileImageUrl(user === null || user === void 0 ? void 0 : user.profilePicture),\n                alt: user && user.username ? `${user.username}'s profile` : 'User profile',\n                style: {\n                  width: '60px',\n                  height: '60px',\n                  borderRadius: '50%',\n                  objectFit: 'cover',\n                  border: '2px solid #ddd'\n                }\n              }, profilePicKey, false, {\n                fileName: _jsxFileName,\n                lineNumber: 544,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  style: {\n                    margin: '0 0 4px 0'\n                  },\n                  children: user ? user.username : ''\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 557,\n                  columnNumber: 19\n                }, this), user && /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    color: '#4CAF50',\n                    fontSize: '14px'\n                  },\n                  children: t('userProfile.online')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 558,\n                  columnNumber: 28\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 556,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 543,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 13\n          }, this), isEditing ? /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleUpdateProfile,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '20px',\n                textAlign: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginBottom: '15px'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: profilePicturePreview || getProfileImageUrl(user === null || user === void 0 ? void 0 : user.profilePicture),\n                  alt: user.username ? `${user.username}'s profile` : 'User profile',\n                  style: {\n                    width: '100px',\n                    height: '100px',\n                    borderRadius: '50%',\n                    objectFit: 'cover',\n                    border: '3px solid #ddd'\n                  }\n                }, profilePicKey, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 568,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 567,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginBottom: '15px'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"profilePictureInput\",\n                  style: {\n                    display: 'inline-block',\n                    padding: '8px 16px',\n                    backgroundColor: '#f0f0f0',\n                    border: '1px solid #ddd',\n                    borderRadius: '20px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    color: '#333',\n                    width: '100%',\n                    textAlign: 'center'\n                  },\n                  tabIndex: 0,\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"file\",\n                    accept: \"image/*\",\n                    onChange: handleProfilePictureChange,\n                    style: {\n                      display: 'none'\n                    },\n                    id: \"profilePictureInput\",\n                    \"aria-label\": \"Profile picture\",\n                    autoComplete: \"photo\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 598,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    role: \"button\",\n                    style: {\n                      fontSize: '18px',\n                      verticalAlign: 'middle'\n                    },\n                    children: [\"\\uD83D\\uDCF7 \", t('userProfile.changePhoto')]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 607,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 582,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 581,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 566,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: '4px',\n                  fontWeight: 'bold'\n                },\n                children: t('userProfile.fullName')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 615,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                id: \"profileNameInput\",\n                name: \"name\",\n                value: formData.name,\n                onChange: handleInputChange,\n                style: {\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '16px',\n                  WebkitUserSelect: 'text',\n                  userSelect: 'text'\n                },\n                required: true,\n                autoComplete: \"name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 618,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 614,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: '4px',\n                  fontWeight: 'bold'\n                },\n                children: t('userProfile.phone')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 639,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                id: \"profileContactNum\",\n                name: \"contactNum\",\n                value: formData.phone,\n                onChange: e => setFormData(prev => ({\n                  ...prev,\n                  phone: e.target.value\n                })),\n                style: {\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '16px',\n                  background: '#fff'\n                },\n                autoComplete: \"off\",\n                \"data-form-type\": \"other\",\n                \"data-lpignore\": \"true\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 642,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 638,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: '4px',\n                  fontWeight: 'bold'\n                },\n                children: t('userProfile.email')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 663,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"email\",\n                id: \"profileEmailInput\",\n                name: \"email\",\n                value: formData.email,\n                onChange: handleInputChange,\n                style: {\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '16px',\n                  WebkitUserSelect: 'text',\n                  userSelect: 'text'\n                },\n                required: true,\n                autoComplete: \"email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 666,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 662,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                style: {\n                  display: 'block',\n                  marginBottom: '4px',\n                  fontWeight: 'bold'\n                },\n                children: t('userProfile.username')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 687,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                id: \"profileUsernameInput\",\n                name: \"username\",\n                value: formData.username,\n                onChange: handleInputChange,\n                style: {\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: '1px solid #ddd',\n                  borderRadius: '4px',\n                  fontSize: '16px',\n                  WebkitUserSelect: 'text',\n                  userSelect: 'text'\n                },\n                required: true,\n                autoComplete: \"username\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 690,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 686,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '20px',\n                padding: '15px',\n                backgroundColor: '#f8f9fa',\n                borderRadius: '8px',\n                border: '1px solid #e9ecef'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                style: {\n                  margin: '0 0 10px 0',\n                  color: '#333',\n                  fontSize: '16px'\n                },\n                children: t('userProfile.password')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 718,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                style: {\n                  margin: '0 0 15px 0',\n                  fontSize: '14px',\n                  color: '#666'\n                },\n                children: t('userProfile.passwordInfo')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 719,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: handlePasswordReset,\n                style: {\n                  padding: '8px 16px',\n                  backgroundColor: '#6c757d',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '20px',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  fontWeight: '500'\n                },\n                children: [\"\\uD83D\\uDD11 \", t('userProfile.sendPasswordReset')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 722,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 711,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                gap: '12px',\n                marginTop: '20px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                disabled: loading,\n                style: {\n                  padding: '10px 20px',\n                  backgroundColor: '#4CAF50',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: loading ? 'not-allowed' : 'pointer',\n                  opacity: loading ? 0.6 : 1\n                },\n                children: loading ? t('userProfile.saving') : t('userProfile.saveChanges')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 741,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: () => {\n                  console.log('Cancel button clicked');\n                  setIsEditing(false);\n                },\n                style: {\n                  padding: '10px 20px',\n                  backgroundColor: '#757575',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: 'pointer'\n                },\n                children: t('userProfile.cancel')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 756,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 740,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontWeight: 'bold',\n                  fontSize: '1.1em'\n                },\n                children: [t('userProfile.fullName'), \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 778,\n                columnNumber: 19\n              }, this), \" \", user ? user.name : '']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 777,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontWeight: 'bold',\n                  fontSize: '1.1em'\n                },\n                children: [t('userProfile.email'), \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 781,\n                columnNumber: 19\n              }, this), \" \", user ? user.email : '']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 780,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '20px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontWeight: 'bold',\n                  fontSize: '1.1em'\n                },\n                children: [t('userProfile.username'), \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 784,\n                columnNumber: 19\n              }, this), \" \", user ? user.username : '']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 783,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontWeight: 'bold',\n                  fontSize: '1.1em'\n                },\n                children: [t('userProfile.phone'), \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 787,\n                columnNumber: 19\n              }, this), \" \", typedUser ? typedUser.phone : '']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 786,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                gap: '12px',\n                flexWrap: 'wrap'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setIsEditing(true),\n                style: {\n                  padding: '10px 20px',\n                  backgroundColor: '#2196F3',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: 'pointer'\n                },\n                children: t('userProfile.editProfile')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 790,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: handleDeleteAccount,\n                disabled: loading,\n                style: {\n                  padding: '10px 20px',\n                  backgroundColor: '#f44336',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '4px',\n                  cursor: loading ? 'not-allowed' : 'pointer',\n                  opacity: loading ? 0.6 : 1\n                },\n                children: loading ? t('userProfile.deleting') : t('userProfile.deleteAccount')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 803,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 789,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 776,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true), activeTab === 'wishlist' && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              marginBottom: '20px',\n              fontSize: '1.2em'\n            },\n            children: [t('userProfile.myWishlist'), \" (\", wishlist.length, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 827,\n            columnNumber: 13\n          }, this), loadingWishlist ? /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center',\n              padding: '40px',\n              fontSize: '1.1em'\n            },\n            children: t('userProfile.loadingWishlist')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 830,\n            columnNumber: 15\n          }, this) : wishlist.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center',\n              padding: '40px',\n              color: '#666',\n              fontSize: '1.1em'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: t('userProfile.emptyWishlist')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 833,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: t('userProfile.emptyWishlistHint')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 834,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 832,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              maxHeight: '400px',\n              overflowY: 'auto'\n            },\n            children: wishlist.map(dog => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                border: '1px solid #ddd',\n                borderRadius: '8px',\n                padding: '15px',\n                marginBottom: '15px',\n                display: 'flex',\n                gap: '15px',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: ((_dog$thumbnail, _dog$images, _dog$images$) => {\n                  const url = ((_dog$thumbnail = dog.thumbnail) === null || _dog$thumbnail === void 0 ? void 0 : _dog$thumbnail.url) || ((_dog$images = dog.images) === null || _dog$images === void 0 ? void 0 : (_dog$images$ = _dog$images[0]) === null || _dog$images$ === void 0 ? void 0 : _dog$images$.url);\n                  if (!url) return '../img/placeholder-dog.jpg';\n                  if (/^https?:\\/\\//.test(url)) return url;\n                  if (url.startsWith('/uploads/') || url.startsWith('/u/dogs/')) {\n                    const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:3001';\n                    return apiBase + url;\n                  }\n                  // Fallback to placeholder if not a valid path\n                  return '../img/placeholder-dog.jpg';\n                })(),\n                alt: dog.name,\n                style: {\n                  width: '60px',\n                  height: '60px',\n                  borderRadius: '8px',\n                  objectFit: 'cover'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 851,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  flex: 1\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  style: {\n                    margin: '0 0 5px 0',\n                    color: '#333'\n                  },\n                  children: dog.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 872,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    margin: '0 0 5px 0',\n                    fontSize: '14px',\n                    color: '#666'\n                  },\n                  children: [dog.breed, \" \\u2022 \", dog.age, \" years \\u2022 \", dog.size, \" \\u2022 \", dog.location || dog.place]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 873,\n                  columnNumber: 23\n                }, this), dog.description && /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    margin: '0',\n                    fontSize: '13px',\n                    color: '#888',\n                    maxWidth: '300px'\n                  },\n                  children: dog.description.length > 100 ? dog.description.substring(0, 100) + '...' : dog.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 877,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 871,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  flexDirection: 'column',\n                  gap: '8px'\n                },\n                children: [dog.adoptionStatus === 'pending' && dog.adoptionQueue && user && dog.adoptionQueue.adopter === user._id ? /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: async () => {\n                    // Odustani (cancel adoption)\n                    try {\n                      const API_URL = getApiUrl();\n                      const resp = await fetch(`${API_URL}/api/dogs/${dog._id}/adopt-cancel`, {\n                        method: 'POST',\n                        headers: {\n                          'Content-Type': 'application/json',\n                          'Authorization': token ? `Bearer ${token}` : ''\n                        },\n                        body: JSON.stringify({\n                          reason: ''\n                        })\n                      });\n                      const data = await resp.json();\n                      if (!resp.ok) throw new Error(data.message || 'Error');\n                      await loadWishlist();\n                    } catch (e) {\n                      alert(e.message || 'Error');\n                    }\n                  },\n                  style: {\n                    padding: '8px 16px',\n                    backgroundColor: '#e74c3c',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    whiteSpace: 'nowrap'\n                  },\n                  children: t('button.cancelAdoption') || 'Odustani od posvajanja'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 884,\n                  columnNumber: 25\n                }, this) : dog.adoptionStatus === 'pending' ? /*#__PURE__*/_jsxDEV(\"button\", {\n                  disabled: true,\n                  style: {\n                    padding: '8px 16px',\n                    backgroundColor: '#aaa',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'not-allowed',\n                    fontSize: '14px',\n                    whiteSpace: 'nowrap'\n                  },\n                  children: t('button.requested') || 'Zahtjev poslan'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 918,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => {\n                    handleAdopt(dog._id);\n                  },\n                  style: {\n                    padding: '8px 16px',\n                    backgroundColor: '#4CAF50',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    whiteSpace: 'nowrap'\n                  },\n                  children: [\"\\uD83C\\uDFE0 \", t('button.adopt')]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 934,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: async () => {\n                    // const removeKey = t('userProfile.remove');\n                    // const fallbackRemove = t('button.removeFromList');\n                    setWishlist(prev => prev.filter(d => d._id !== dog._id));\n                    await removeFromWishlist(dog._id);\n                    if (user) {\n                      updateUser({\n                        ...user,\n                        wishlist: (user.wishlist || []).filter(id => id !== dog._id)\n                      });\n                    }\n                  },\n                  style: {\n                    padding: '6px 12px',\n                    backgroundColor: '#ff4444',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '20px',\n                    cursor: 'pointer',\n                    fontSize: '14px',\n                    fontWeight: 600,\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 4,\n                    boxShadow: '0 0 0 2px #ff4444',\n                    transition: 'background 0.2s, box-shadow 0.2s'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontSize: 18\n                    },\n                    children: \"\\uD83D\\uDC94\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 981,\n                    columnNumber: 25\n                  }, this), \" \", t('button.removeFromList', 'Entfernen')]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 952,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 882,\n                columnNumber: 21\n              }, this)]\n            }, dog._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 839,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 837,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 826,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 427,\n    columnNumber: 5\n  }, this), modalRoot);\n};\n_s(UserProfileModal, \"j4IkVnSrRbtjZhQcUdu95T/nq9U=\", false, function () {\n  return [useAuth, useTranslation];\n});\n_c = UserProfileModal;\nexport default UserProfileModal;\nvar _c;\n$RefreshReg$(_c, \"UserProfileModal\");","map":{"version":3,"names":["React","useState","ReactDOM","useTranslation","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","modalRoot","document","getElementById","root","createElement","id","style","position","top","left","zIndex","pointerEvents","body","appendChild","UserProfileModal","isOpen","onClose","_s","user","token","logout","updateUser","getWishlist","removeFromWishlist","typedUser","t","isEditing","setIsEditing","activeTab","setActiveTab","wishlist","setWishlist","loadingWishlist","setLoadingWishlist","profilePicture","setProfilePicture","profilePicturePreview","setProfilePicturePreview","getProfileImageUrl","url","startsWith","replace","apiBase","process","env","REACT_APP_API_URL","test","formData","setFormData","name","email","username","phone","loading","setLoading","error","setError","profilePicKey","setProfilePicKey","success","setSuccess","loadWishlist","useCallback","wishlistData","useEffect","handler","e","detail","Array","isArray","window","addEventListener","removeEventListener","_id","handleModalClose","console","log","handleEscapeKey","event","key","overflow","width","height","scrollY","dataset","toString","touchAction","scrollTo","parseInt","handleAdopt","dogId","API_URL","getApiUrl","resp","fetch","method","headers","data","json","ok","Error","message","alert","handleProfilePictureChange","_e$target$files","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","handlePasswordReset","response","JSON","stringify","location","hostname","handleInputChange","value","handleUpdateProfile","type","preventDefault","uploadFormData","FormData","append","size","hasProfilePicture","status","err","updatedUser","cacheBuster","match","_profilePicCacheBuster","prev","setTimeout","handleDeleteAccount","confirm","createPortal","className","onClick","currentTarget","children","stopPropagation","display","justifyContent","alignItems","marginBottom","flexShrink","margin","color","fileName","_jsxFileName","lineNumber","columnNumber","background","border","borderRadius","padding","cursor","boxShadow","title","fontSize","fontWeight","lineHeight","borderBottom","marginRight","length","flex","overflowY","overflowX","minHeight","backgroundColor","gap","src","alt","objectFit","onSubmit","textAlign","htmlFor","tabIndex","accept","onChange","autoComplete","role","verticalAlign","WebkitUserSelect","userSelect","required","marginTop","disabled","opacity","flexWrap","maxHeight","map","dog","_dog$thumbnail","_dog$images","_dog$images$","thumbnail","images","breed","age","place","description","maxWidth","substring","flexDirection","adoptionStatus","adoptionQueue","adopter","reason","whiteSpace","filter","d","transition","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/UserProfileModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../contexts/AuthContext';\nimport '../css/modal.css';\n\n// Portal container for modal\nconst modalRoot = document.getElementById('modal-root') || (() => {\n  const root = document.createElement('div');\n  root.id = 'modal-root';\n  // Portal root should NOT block clicks - only modal overlay should\n  root.style.position = 'absolute';\n  root.style.top = '0';\n  root.style.left = '0';\n  root.style.zIndex = '0';\n  root.style.pointerEvents = 'none';\n  document.body.appendChild(root);\n  return root;\n})();\n\ninterface User {\n  id?: string;\n  _id?: string;\n  email?: string;\n  username?: string;\n  name?: string;\n  phone?: string;\n}\n\ninterface UserProfileModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst UserProfileModal: React.FC<UserProfileModalProps> = ({ isOpen, onClose }) => {\n  const { user, token, logout, updateUser, getWishlist, removeFromWishlist } = useAuth();\n    const typedUser = user as User;\n  const { t } = useTranslation();\n  const [isEditing, setIsEditing] = useState(false);\n  const [activeTab, setActiveTab] = useState<'profile' | 'wishlist'>('profile');\n  const [wishlist, setWishlist] = useState<any[]>([]);\n  const [loadingWishlist, setLoadingWishlist] = useState(false);\n  const [profilePicture, setProfilePicture] = useState<File | null>(null);\n  const [profilePicturePreview, setProfilePicturePreview] = useState<string>('');\n  \n  // Helper to get full image URL (robust)\n  const getProfileImageUrl = (profilePicture: string | undefined) => {\n    if (!profilePicture) return \"../img/androcolored-80x80.jpg\";\n    let url = profilePicture.startsWith('/') ? profilePicture : '/' + profilePicture;\n    // Use /u/ for compatibility if needed\n    url = url.replace('/uploads', '/u');\n    // Always use API base for /uploads/ and /u/ paths\n    if (url.startsWith('/uploads/') || url.startsWith('/u/')) {\n      const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:3001';\n      return apiBase + url;\n    }\n    // If already absolute URL, return as is\n    if (/^https?:\\/\\//.test(url)) return url;\n    // Fallback to placeholder\n    return '../img/androcolored-80x80.jpg';\n  };\n  const [formData, setFormData] = useState({\n     name: typedUser?.name || '',\n     email: typedUser?.email || '',\n     username: typedUser?.username || '',\n     phone: typedUser?.phone || '',\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Used to force re-render after profile update\n  const [profilePicKey, setProfilePicKey] = useState(0);\n  const [success, setSuccess] = useState<string | null>(null);\n\n\n\n\n\n\n\n\n  const loadWishlist = React.useCallback(async () => {\n    setLoadingWishlist(true);\n    const wishlistData = await getWishlist();\n    setWishlist(wishlistData);\n    setLoadingWishlist(false);\n  }, [getWishlist]);\n\n  // Load wishlist when modal opens and wishlist tab is active\n  React.useEffect(() => {\n    if (isOpen) {\n      loadWishlist();\n    }\n    // Reset form data when modal opens\n    if (isOpen && user) {\n      setFormData({\n          name: typedUser.name || '',\n          email: typedUser.email || '',\n          username: typedUser.username || '',\n          phone: typedUser.phone || '',\n      });\n      setProfilePicture(null);\n      setProfilePicturePreview('');\n      setError(null);\n      setSuccess(null);\n    } else if (isOpen && !user) {\n      setFormData({ name: '', email: '', username: '', phone: '' });\n      setProfilePicture(null);\n      setProfilePicturePreview('');\n      setError(null);\n      setSuccess(null);\n    }\n    // Listen for wishlist-updated events (from DogList add)\n    const handler = (e: any) => {\n      if (e.detail && Array.isArray(e.detail.wishlist)) {\n        setWishlist(e.detail.wishlist);\n      }\n    };\n    window.addEventListener('wishlist-updated', handler);\n    return () => window.removeEventListener('wishlist-updated', handler);\n    // Only re-run when modal opens/closes or user ID changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen, typedUser?._id]);\n\n  const handleModalClose = React.useCallback(() => {\n    console.log('handleModalClose called');\n    setIsEditing(false);\n    setError(null);\n    setSuccess(null);\n    onClose();\n  }, [onClose]);\n\n  // Handle escape key to close modal\n  React.useEffect(() => {\n    const handleEscapeKey = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isOpen) {\n        console.log('Escape key pressed, closing modal');\n        handleModalClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscapeKey);\n      return () => {\n        document.removeEventListener('keydown', handleEscapeKey);\n      };\n    }\n  }, [isOpen, handleModalClose]);\n\n  // Reset state when modal closes\n  React.useEffect(() => {\n    if (!isOpen) {\n      setIsEditing(false);\n      setActiveTab('profile');\n      setError(null);\n      setSuccess(null);\n      setLoading(false);\n    }\n  }, [isOpen]);\n\n  // Prevent body scrolling when modal is open\n  React.useEffect(() => {\n    if (isOpen) {\n      // Prevent body scroll\n      document.body.style.overflow = 'hidden';\n      document.body.style.position = 'fixed';\n      document.body.style.width = '100%';\n      document.body.style.height = '100%';\n      \n      // Store scroll position\n      const scrollY = window.scrollY;\n      document.body.dataset.scrollY = scrollY.toString();\n      \n      // Prevent touch scrolling on mobile\n      document.body.style.touchAction = 'none';\n    } else {\n      // Restore body scroll\n      const scrollY = document.body.dataset.scrollY || '0';\n      document.body.style.overflow = '';\n      document.body.style.position = '';\n      document.body.style.width = '';\n      document.body.style.height = '';\n      document.body.style.touchAction = '';\n      \n      // Restore scroll position\n      window.scrollTo(0, parseInt(scrollY, 10));\n      \n      // Clear stored scroll position\n      delete document.body.dataset.scrollY;\n    }\n    \n    return () => {\n      // Cleanup when modal unmounts\n      document.body.style.overflow = '';\n      document.body.style.position = '';\n      document.body.style.width = '';\n      document.body.style.height = '';\n      document.body.style.touchAction = '';\n      delete document.body.dataset.scrollY;\n    };\n  }, [isOpen]);\n\n\n  // Don't render if modal is not open - MOVED AFTER ALL HOOKS\n  if (!isOpen) {\n    return null;\n  }\n\n  const handleAdopt = async (dogId: string) => {\n    try {\n      const API_URL = getApiUrl();\n      const resp = await fetch(`${API_URL}/api/dogs/${dogId}/adopt-request`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': token ? `Bearer ${token}` : ''\n        }\n      });\n      const data = await resp.json();\n      if (!resp.ok) throw new Error(data.message || 'Error');\n      await loadWishlist();\n    } catch (e: any) {\n      alert(e.message || 'Error');\n    }\n  };\n\n  const handleProfilePictureChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setProfilePicture(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setProfilePicturePreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handlePasswordReset = async () => {\n    if (!user?.email) return;\n    \n    try {\n      const API_URL = getApiUrl();\n      const response = await fetch(`${API_URL}/api/users/password-reset`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email: user.email }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setSuccess('Password reset link sent to your email!');\n        setError(null);\n      } else {\n        setError(data.message || 'Failed to send password reset email');\n        setSuccess(null);\n      }\n    } catch (error) {\n      console.error('Password reset error:', error);\n      setError('Network error. Please try again.');\n      setSuccess(null);\n    }\n  };\n\n  // Get API URL based on environment\n  const getApiUrl = () => {\n    if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n      return `http://${window.location.hostname}:3001`;\n    }\n    return `http://172.20.10.2:3001`;\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleUpdateProfile = async (e: React.FormEvent) => {\n    console.log('[PROFILE UPDATE DEBUG] handleUpdateProfile called');\n    if (profilePicture) {\n      console.log('[PROFILE UPDATE DEBUG] Uploading file:', profilePicture.name, 'type:', profilePicture.type);\n    }\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n    setSuccess(null);\n\n    try {\n      const API_URL = getApiUrl();\n      \n      // Create FormData for file upload\n      const uploadFormData = new FormData();\n      uploadFormData.append('name', formData.name);\n      uploadFormData.append('username', formData.username);\n      uploadFormData.append('email', formData.email);\n      uploadFormData.append('phone', formData.phone);\n      \n      // Add profile picture if selected\n      if (profilePicture) {\n        uploadFormData.append('profilePicture', profilePicture);\n        console.log('Profile picture selected:', profilePicture.name, profilePicture.size, profilePicture.type);\n      }\n      \n      console.log('Updating profile with form data:', {\n        name: formData.name,\n        username: formData.username,\n        email: formData.email,\n        hasProfilePicture: !!profilePicture\n      });\n      \n      let response, data;\n      try {\n        response = await fetch(`${API_URL}/api/users/profile`, {\n          method: 'PUT',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: uploadFormData,\n        });\n        console.log('Response status:', response.status);\n        data = await response.json();\n        console.log('[PROFILE UPDATE DEBUG] Full server response:', data);\n        if (data && data.user) {\n          console.log('[PROFILE UPDATE DEBUG] Returned user.profilePicture:', data.user.profilePicture);\n          alert('Backend response profilePicture: ' + data.user.profilePicture);\n        }\n      } catch (err) {\n        console.error('[PROFILE UPDATE DEBUG] Error during fetch:', err);\n        return;\n      }\n\n      if (response.ok) {\n        setSuccess('Profile updated successfully!');\n        \n        // Update both localStorage and AuthContext with new user data\n        const updatedUser = { \n          ...user, \n          name: data.user.name,\n          username: data.user.username,\n          email: data.user.email,\n          phone: data.user.phone,\n          ...(data.user.profilePicture && { profilePicture: data.user.profilePicture })\n        } as any;\n        \n\n        // Extract timestamp from filename for cache busting\n        let cacheBuster = '';\n        if (data.user.profilePicture) {\n          const match = data.user.profilePicture.match(/profile-(\\d+)/);\n          if (match && match[1]) {\n            cacheBuster = match[1];\n          }\n        }\n        console.log('[PROFILE UPDATE DEBUG] Using cacheBuster:', cacheBuster);\n\n        updateUser({ ...updatedUser, _profilePicCacheBuster: cacheBuster });\n        setProfilePicKey(prev => prev + 1); // Force re-render\n\n        // Reset profile picture state but keep the new image visible\n        setProfilePicture(null);\n        setProfilePicturePreview('');\n        \n        // Update form data to reflect changes\n        setFormData({\n          name: data.user.name,\n          email: data.user.email,\n          username: data.user.username,\n          phone: data.user.phone || ''\n        });\n        \n        // Close editing mode after successful update\n        setTimeout(() => {\n          setIsEditing(false);\n        }, 100);\n      } else {\n        console.error('Profile update failed:', data);\n        setError(data.message || 'Failed to update profile');\n      }\n    } catch (error) {\n      console.error('Profile update error:', error);\n      setError('Network error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteAccount = async () => {\n    if (!window.confirm('Are you sure you want to delete your account? This action cannot be undone.')) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const API_URL = getApiUrl();\n      const response = await fetch(`${API_URL}/api/users/profile`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n      });\n\n      if (response.ok) {\n        logout();\n        onClose();\n        alert('Account deleted successfully');\n      } else {\n        const data = await response.json();\n        setError(data.message || 'Failed to delete account');\n      }\n    } catch (error) {\n      setError('Network error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Render modal using portal to escape #Wrap container\n  return ReactDOM.createPortal(\n    <div \n      className=\"modal-overlay\"\n      onClick={(e) => {\n        // Close modal when clicking on backdrop\n        if (e.target === e.currentTarget) {\n          console.log('Backdrop clicked, closing modal');\n          handleModalClose();\n        }\n      }}\n    >\n      <div \n        className=\"modal\"\n        onClick={(e) => {\n          // Prevent modal from closing when clicking inside the modal\n          e.stopPropagation();\n        }}\n      >\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px', flexShrink: 0 }}>\n          <h2 style={{ margin: 0, color: '#333' }}>{t('userProfile.title')}</h2>\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              handleModalClose();\n            }}\n            style={{\n              background: '#e74c3c',\n              border: 'none',\n              width: '22px',\n              height: '22px',\n              borderRadius: '50%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              padding: 0,\n              cursor: 'pointer',\n              boxShadow: '0 2px 8px rgba(231,76,60,0.10)',\n              zIndex: 10000\n            }}\n            aria-label=\"Close\"\n            title=\"Close\"\n            type=\"button\"\n          >\n            <span style={{\n              color: '#fff',\n              fontSize: '2rem',\n              fontWeight: 900,\n              lineHeight: 1,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              width: '100%',\n              height: '100%'\n            }}></span>\n          </button>\n        </div>\n\n        {/* Tab Navigation */}\n        <div style={{ display: 'flex', marginBottom: '20px', borderBottom: '1px solid #ddd', flexShrink: 0 }}>\n          <button\n            onClick={() => setActiveTab('profile')}\n            style={{\n              padding: '10px 20px',\n              border: 'none',\n              background: activeTab === 'profile' ? '#2196F3' : 'transparent',\n              color: activeTab === 'profile' ? 'white' : '#666',\n              cursor: 'pointer',\n              borderRadius: '4px 4px 0 0',\n              marginRight: '5px'\n            }}\n          >\n            {t('userProfile.profileTab')}\n          </button>\n          <button\n            onClick={() => setActiveTab('wishlist')}\n            style={{\n              padding: '10px 20px',\n              border: 'none',\n              background: activeTab === 'wishlist' ? '#2196F3' : 'transparent',\n              color: activeTab === 'wishlist' ? 'white' : '#666',\n              cursor: 'pointer',\n              borderRadius: '4px 4px 0 0'\n            }}\n          >\n            {t('userProfile.wishlistTab')} ({wishlist.length})\n          </button>\n        </div>\n\n        <div style={{ flex: 1, overflowY: 'auto', overflowX: 'hidden', minHeight: 0 }}>\n          {error && (\n            <div style={{\n              backgroundColor: '#ffebee',\n              color: '#c62828',\n              padding: '12px',\n              borderRadius: '4px',\n              marginBottom: '16px'\n            }}>\n              {error}\n            </div>\n          )}\n\n          {success && (\n            <div style={{\n              backgroundColor: '#e8f5e8',\n              color: '#2e7d32',\n              padding: '12px',\n              borderRadius: '4px',\n              marginBottom: '16px'\n            }}>\n              {success}\n            </div>\n          )}\n\n        {activeTab === 'profile' && (\n          <>\n            <div style={{ marginBottom: '20px' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '20px' }}>\n                <img \n                  key={profilePicKey}\n                  src={profilePicturePreview || getProfileImageUrl((user as any)?.profilePicture)}\n                  alt={user && user.username ? `${user.username}'s profile` : 'User profile'} \n                  style={{ \n                    width: '60px', \n                    height: '60px', \n                    borderRadius: '50%',\n                    objectFit: 'cover',\n                    border: '2px solid #ddd'\n                  }}\n                />\n                <div>\n                  <h3 style={{ margin: '0 0 4px 0' }}>{user ? user.username : ''}</h3>\n                  {user && <span style={{ color: '#4CAF50', fontSize: '14px' }}>{t('userProfile.online')}</span>}\n                </div>\n              </div>\n            </div>\n\n            {isEditing ? (\n              <form onSubmit={handleUpdateProfile}>\n                {/* Profile Picture Section */}\n                <div style={{ marginBottom: '20px', textAlign: 'center' }}>\n                  <div style={{ marginBottom: '15px' }}>\n                    <img \n                      key={profilePicKey}\n                      src={profilePicturePreview || getProfileImageUrl((user as any)?.profilePicture)}\n                      alt={user.username ? `${user.username}'s profile` : 'User profile'}\n                      style={{ \n                        width: '100px', \n                        height: '100px', \n                        borderRadius: '50%', \n                        objectFit: 'cover',\n                        border: '3px solid #ddd'\n                      }} \n                    />\n                  </div>\n                  <div style={{ marginBottom: '15px' }}>\n                    <label\n                      htmlFor=\"profilePictureInput\"\n                      style={{\n                        display: 'inline-block',\n                        padding: '8px 16px',\n                        backgroundColor: '#f0f0f0',\n                        border: '1px solid #ddd',\n                        borderRadius: '20px',\n                        cursor: 'pointer',\n                        fontSize: '14px',\n                        color: '#333',\n                        width: '100%',\n                        textAlign: 'center'\n                      }}\n                      tabIndex={0}\n                    >\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={handleProfilePictureChange}\n                        style={{ display: 'none' }}\n                        id=\"profilePictureInput\"\n                        aria-label=\"Profile picture\"\n                        autoComplete=\"photo\"\n                      />\n                      <span role=\"button\" style={{fontSize: '18px', verticalAlign: 'middle'}}>\n                         {t('userProfile.changePhoto')}\n                      </span>\n                    </label>\n                  </div>\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.fullName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"profileNameInput\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleInputChange}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      WebkitUserSelect: 'text',\n                      userSelect: 'text'\n                    }}\n                    required\n                    autoComplete=\"name\"\n                  />\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.phone')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"profileContactNum\"\n                    name=\"contactNum\"\n                    value={formData.phone}\n                    onChange={(e) => setFormData(prev => ({ ...prev, phone: e.target.value }))}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      background: '#fff'\n                    }}\n                    autoComplete=\"off\"\n                    data-form-type=\"other\"\n                    data-lpignore=\"true\"\n                  />\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"profileEmailInput\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleInputChange}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      WebkitUserSelect: 'text',\n                      userSelect: 'text'\n                    }}\n                    required\n                    autoComplete=\"email\"\n                  />\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"profileUsernameInput\"\n                    name=\"username\"\n                    value={formData.username}\n                    onChange={handleInputChange}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      WebkitUserSelect: 'text',\n                      userSelect: 'text'\n                    }}\n                    required\n                    autoComplete=\"username\"\n                  />\n                </div>\n\n                {/* Password Change Section */}\n                <div style={{ \n                  marginBottom: '20px', \n                  padding: '15px', \n                  backgroundColor: '#f8f9fa', \n                  borderRadius: '8px', \n                  border: '1px solid #e9ecef' \n                }}>\n                  <h4 style={{ margin: '0 0 10px 0', color: '#333', fontSize: '16px' }}>{t('userProfile.password')}</h4>\n                  <p style={{ margin: '0 0 15px 0', fontSize: '14px', color: '#666' }}>\n                    {t('userProfile.passwordInfo')}\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={handlePasswordReset}\n                    style={{\n                      padding: '8px 16px',\n                      backgroundColor: '#6c757d',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '20px',\n                      cursor: 'pointer',\n                      fontSize: '14px',\n                      fontWeight: '500'\n                    }}\n                  >\n                     {t('userProfile.sendPasswordReset')}\n                  </button>\n                </div>\n\n                <div style={{ display: 'flex', gap: '12px', marginTop: '20px' }}>\n                  <button\n                    type=\"submit\"\n                    disabled={loading}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#4CAF50',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: loading ? 'not-allowed' : 'pointer',\n                      opacity: loading ? 0.6 : 1\n                    }}\n                  >\n                    {loading ? t('userProfile.saving') : t('userProfile.saveChanges')}\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      console.log('Cancel button clicked');\n                      setIsEditing(false);\n                    }}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#757575',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: 'pointer'\n                    }}\n                  >\n                    {t('userProfile.cancel')}\n                  </button>\n                </div>\n              </form>\n            ) : (\n              <div>\n                <div style={{ marginBottom: '16px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.fullName')}:</span> {user ? user.name : ''}\n                </div>\n                <div style={{ marginBottom: '16px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.email')}:</span> {user ? user.email : ''}\n                </div>\n                <div style={{ marginBottom: '20px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.username')}:</span> {user ? user.username : ''}\n                </div>\n                <div style={{ marginBottom: '16px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.phone')}:</span> {typedUser ? typedUser.phone : ''}\n                </div>\n                <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>\n                  <button\n                    onClick={() => setIsEditing(true)}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#2196F3',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: 'pointer'\n                    }}\n                  >\n                    {t('userProfile.editProfile')}\n                  </button>\n                  <button\n                    onClick={handleDeleteAccount}\n                    disabled={loading}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#f44336',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: loading ? 'not-allowed' : 'pointer',\n                      opacity: loading ? 0.6 : 1\n                    }}\n                  >\n                    {loading ? t('userProfile.deleting') : t('userProfile.deleteAccount')}\n                  </button>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {/* Wishlist Tab Content */}\n        {activeTab === 'wishlist' && (\n          <div>\n            <h3 style={{ marginBottom: '20px', fontSize: '1.2em' }}>{t('userProfile.myWishlist')} ({wishlist.length})</h3>\n            \n            {loadingWishlist ? (\n              <div style={{ textAlign: 'center', padding: '40px', fontSize: '1.1em' }}>{t('userProfile.loadingWishlist')}</div>\n            ) : wishlist.length === 0 ? (\n              <div style={{ textAlign: 'center', padding: '40px', color: '#666', fontSize: '1.1em' }}>\n                <p>{t('userProfile.emptyWishlist')}</p>\n                <p>{t('userProfile.emptyWishlistHint')}</p>\n              </div>\n            ) : (\n              <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\n                {wishlist.map((dog: any) => (\n                  <div \n                    key={dog._id}\n                    style={{\n                      border: '1px solid #ddd',\n                      borderRadius: '8px',\n                      padding: '15px',\n                      marginBottom: '15px',\n                      display: 'flex',\n                      gap: '15px',\n                      alignItems: 'center'\n                    }}\n                  >\n                    <img\n                      src={(() => {\n                        const url = dog.thumbnail?.url || dog.images?.[0]?.url;\n                        if (!url) return '../img/placeholder-dog.jpg';\n                        if (/^https?:\\/\\//.test(url)) return url;\n                        if (url.startsWith('/uploads/') || url.startsWith('/u/dogs/')) {\n                          const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:3001';\n                          return apiBase + url;\n                        }\n                        // Fallback to placeholder if not a valid path\n                        return '../img/placeholder-dog.jpg';\n                      })()}\n                      alt={dog.name}\n                      style={{\n                        width: '60px',\n                        height: '60px',\n                        borderRadius: '8px',\n                        objectFit: 'cover'\n                      }}\n                    />\n                    <div style={{ flex: 1 }}>\n                      <h4 style={{ margin: '0 0 5px 0', color: '#333' }}>{dog.name}</h4>\n                      <p style={{ margin: '0 0 5px 0', fontSize: '14px', color: '#666' }}>\n                        {dog.breed}  {dog.age} years  {dog.size}  {dog.location || dog.place}\n                      </p>\n                      {dog.description && (\n                        <p style={{ margin: '0', fontSize: '13px', color: '#888', maxWidth: '300px' }}>\n                          {dog.description.length > 100 ? dog.description.substring(0, 100) + '...' : dog.description}\n                        </p>\n                      )}\n                    </div>\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                      {(dog.adoptionStatus === 'pending' && dog.adoptionQueue && user && dog.adoptionQueue.adopter === user._id) ? (\n                        <button\n                          onClick={async () => {\n                            // Odustani (cancel adoption)\n                            try {\n                              const API_URL = getApiUrl();\n                              const resp = await fetch(`${API_URL}/api/dogs/${dog._id}/adopt-cancel`, {\n                                method: 'POST',\n                                headers: {\n                                  'Content-Type': 'application/json',\n                                  'Authorization': token ? `Bearer ${token}` : ''\n                                },\n                                body: JSON.stringify({ reason: '' })\n                              });\n                              const data = await resp.json();\n                              if (!resp.ok) throw new Error(data.message || 'Error');\n                              await loadWishlist();\n                            } catch (e) {\n                              alert(e.message || 'Error');\n                            }\n                          }}\n                          style={{\n                            padding: '8px 16px',\n                            backgroundColor: '#e74c3c',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            fontSize: '14px',\n                            whiteSpace: 'nowrap'\n                          }}\n                        >\n                          {t('button.cancelAdoption') || 'Odustani od posvajanja'}\n                        </button>\n                      ) : dog.adoptionStatus === 'pending' ? (\n                        <button\n                          disabled\n                          style={{\n                            padding: '8px 16px',\n                            backgroundColor: '#aaa',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'not-allowed',\n                            fontSize: '14px',\n                            whiteSpace: 'nowrap'\n                          }}\n                        >\n                          {t('button.requested') || 'Zahtjev poslan'}\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => {\n                            handleAdopt(dog._id);\n                          }}\n                          style={{\n                            padding: '8px 16px',\n                            backgroundColor: '#4CAF50',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            fontSize: '14px',\n                            whiteSpace: 'nowrap'\n                          }}\n                        >\n                           {t('button.adopt')}\n                        </button>\n                      )}\n                      <button\n                        onClick={async () => {\n                          // const removeKey = t('userProfile.remove');\n                          // const fallbackRemove = t('button.removeFromList');\n                          setWishlist(prev => prev.filter((d: any) => d._id !== dog._id));\n                          await removeFromWishlist(dog._id);\n                          if (user) {\n                            updateUser({\n                              ...user,\n                              wishlist: (user.wishlist || []).filter(id => id !== dog._id)\n                            });\n                          }\n                        }}\n                        style={{\n                          padding: '6px 12px',\n                          backgroundColor: '#ff4444',\n                          color: 'white',\n                          border: 'none',\n                          borderRadius: '20px',\n                          cursor: 'pointer',\n                          fontSize: '14px',\n                          fontWeight: 600,\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: 4,\n                          boxShadow: '0 0 0 2px #ff4444',\n                          transition: 'background 0.2s, box-shadow 0.2s',\n                        }}\n                      >\n                        <span style={{fontSize:18}}></span> {t('button.removeFromList', 'Entfernen')}\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n        </div>\n      </div>\n    </div>,\n    modalRoot\n  );\n};\n\nexport default UserProfileModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}