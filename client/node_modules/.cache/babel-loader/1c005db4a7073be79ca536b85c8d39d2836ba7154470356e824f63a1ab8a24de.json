{"ast":null,"code":"import React,{useState}from'react';import MultiPhotoIndicator from'./MultiPhotoIndicator';import'leaflet/dist/leaflet.css';import{useTranslation}from'react-i18next';import{useAuth}from'../contexts/AuthContext';import DogImageSlider from'./DogImageSlider';import{createPortal}from'react-dom';// Geocode location if needed (mirrors DogDetails)\n// (handleShowMap will be defined inside the component, after imports)\n// ...existing imports...\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const toHttps=url=>url&&url.startsWith('http://')?url.replace('http://','https://'):url;const CardSmall=props=>{var _currentUser$wishlist,_currentUser$wishlist2;// Destructure props for easier access\nconst{_id,imgSrc,images,video,thumbnail,name,age,likes,breed,color,place,location,lat,lng,description,size,gender,vaccinated,neutered,onViewDetails,onEdit,onRemove,canEdit,user:owner,adoptionStatus,adoptionQueue,onDogUpdate}=props;const{t}=useTranslation();const{currentUser,isAuthenticated,token,addToWishlist,removeFromWishlist}=useAuth();const[showMap,setShowMap]=useState(false);const[coords,setCoords]=useState(null);const[coordsError,setCoordsError]=useState(null);const[loadingCoords,setLoadingCoords]=useState(false);const isOwner=currentUser&&owner&&currentUser._id===owner._id;const handleShowMap=async()=>{if(!place)return;setLoadingCoords(true);setCoords(null);setCoordsError(null);try{const response=await fetch(\"https://nominatim.openstreetmap.org/search?format=json&q=\".concat(encodeURIComponent(place)),{headers:{'Accept':'application/json','User-Agent':'eky-app/1.0 (your@email.com)'}});const data=await response.json();if(data&&data.length){const result=data[0];setCoords({lat:parseFloat(result.lat),lng:parseFloat(result.lon)});}else{setCoordsError(t('dogDetails.approximateLocation')||'Approximate location');}}catch(e){setCoordsError(t('dogDetails.searchBasedLocation')||'Search-based location');}finally{setLoadingCoords(false);setShowMap(true);}};// Wishlist state\nconst[inWishlist,setInWishlist]=useState(false);React.useEffect(()=>{if(_id&&currentUser&&currentUser.wishlist){const isInList=currentUser.wishlist.includes(_id);setInWishlist(isInList);}else{setInWishlist(false);}},[_id,currentUser===null||currentUser===void 0?void 0:currentUser._id,currentUser===null||currentUser===void 0?void 0:(_currentUser$wishlist=currentUser.wishlist)===null||_currentUser$wishlist===void 0?void 0:_currentUser$wishlist.length,currentUser===null||currentUser===void 0?void 0:(_currentUser$wishlist2=currentUser.wishlist)===null||_currentUser$wishlist2===void 0?void 0:_currentUser$wishlist2.join(',')]);// Likes state\nconst[likesCount,setLikesCount]=useState((likes===null||likes===void 0?void 0:likes.length)||0);const[isLiked,setIsLiked]=useState((likes===null||likes===void 0?void 0:likes.includes((currentUser===null||currentUser===void 0?void 0:currentUser._id)||''))||false);React.useEffect(()=>{if(likes&&currentUser!==null&&currentUser!==void 0&&currentUser._id){setIsLiked(likes.includes(currentUser._id));setLikesCount(likes.length);}else{setIsLiked(false);setLikesCount((likes===null||likes===void 0?void 0:likes.length)||0);}},[likes,currentUser===null||currentUser===void 0?void 0:currentUser._id]);// Adoption state for list view\nconst[adoptionStatusState,setAdoptionStatus]=useState(adoptionStatus);const[adoptionQueueState,setAdoptionQueue]=useState(adoptionQueue);React.useEffect(()=>{setAdoptionStatus(adoptionStatus);setAdoptionQueue(adoptionQueue);},[adoptionStatus,adoptionQueue,_id]);const[adoptLoading,setAdoptLoading]=useState(false);const[adoptError,setAdoptError]=useState(null);// API base\nconst getApiBase=()=>{if(process.env.REACT_APP_API_URL)return process.env.REACT_APP_API_URL;if(window.location.hostname==='localhost'||window.location.hostname==='127.0.0.1'){return\"http://\".concat(window.location.hostname,\":3001\");}return\"http://\".concat(window.location.hostname,\":3001\");};const apiBase=getApiBase();const handleWishlistToggle=async()=>{if(!_id||!isAuthenticated){alert('Please log in to add dogs to your wishlist');return;}const currentlyInWishlist=inWishlist;if(currentlyInWishlist){const result=await removeFromWishlist(_id);if(result.success){setInWishlist(false);alert('Removed from wishlist!');}else{alert('Failed to remove from wishlist: '+(result.error||'Unknown error'));}}else{const result=await addToWishlist(_id);if(result.success){setInWishlist(true);alert('Added to wishlist! â¤ï¸');}else{alert('Failed to add to wishlist: '+(result.error||'Unknown error'));}}};const handleAdopt=async()=>{if(!_id)return;setAdoptLoading(true);setAdoptError(null);try{const resp=await fetch(\"\".concat(apiBase,\"/api/dogs/\").concat(_id,\"/adopt-request\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token')?\"Bearer \".concat(localStorage.getItem('token')):''}});const data=await resp.json();if(!resp.ok)throw new Error(data.message||'Error');setAdoptionStatus(data.dog.adoptionStatus);setAdoptionQueue(data.dog.adoptionQueue);if(onDogUpdate&&data.dog)onDogUpdate(data.dog);}catch(e){setAdoptError(e.message||'Error');}finally{setAdoptLoading(false);}};// Helper to check if a string is a Cloudinary public ID (not a URL)\nconst isCloudinaryId=url=>url&&!url.startsWith('http')&&!url.startsWith('/uploads/');// Image helpers\n// Always use Cloudinary public_id for migrated images\nconst toCloudinaryUrl=(publicId,options)=>{if(!publicId)return undefined;// Replace with your actual cloud name\nconst cloudName='dtqzrm4by';let url=\"https://res.cloudinary.com/\".concat(cloudName,\"/image/upload/\").concat(publicId);if(options!==null&&options!==void 0&&options.width)url+=\"/w_\".concat(options.width);return url;};const cacheBust=\"t=\".concat(Date.now());// Build srcSet with all available sizes, always including the largest/original\nlet imgSrcSet=undefined;let largestImgUrl=undefined;// Filter images to only those with valid URLs\nconst validImages=(images||[]).filter(img=>img&&img.url&&typeof img.url==='string'&&img.url.trim()!=='');let largestImage=undefined;if(validImages.length){// Prefer original (no width param) for Cloudinary, else largest available\nconst sorted=[...validImages].sort((a,b)=>(b.width||0)-(a.width||0));largestImage=sorted[0];imgSrcSet=sorted.filter(i=>isCloudinaryId(i.url)).map(i=>\"\".concat(toCloudinaryUrl(i.url),\" \").concat(i.width||2000,\"w\")).join(', ');if(largestImage&&isCloudinaryId(largestImage.url)){largestImgUrl=toCloudinaryUrl(largestImage.url);// no width param: original\n}else if(largestImage){largestImgUrl=largestImage.url;}if(largestImgUrl&&imgSrcSet&&!imgSrcSet.includes(largestImgUrl)){imgSrcSet+=\", \".concat(largestImgUrl,\" 2000w\");}}const posterUrl=video&&video.poster&&video.poster.length?isCloudinaryId(video.poster[video.poster.length-1].url)?toCloudinaryUrl(video.poster[video.poster.length-1].url):video.poster[video.poster.length-1].url:undefined;const hasVideoUrl=video&&typeof video.url==='string'&&video.url.length>0;const videoUrl=hasVideoUrl?isCloudinaryId(video.url)?toCloudinaryUrl(video.url):video.url:undefined;let thumbUrl=undefined;let isCloudinaryThumb=false;if(thumbnail&&thumbnail.url){if(isCloudinaryId(thumbnail.url)){thumbUrl=toCloudinaryUrl(thumbnail.url);isCloudinaryThumb=true;}else if(thumbnail.url.startsWith('http')||thumbnail.url.startsWith('/uploads/')){thumbUrl=thumbnail.url;isCloudinaryThumb=false;}}const[showSlider,setShowSlider]=useState(false);// Prepare unique images for DogImageSlider (one per uploaded photo, pick only 1024px variant)\nlet uniqueImages=[];if(images&&images.length>0){// Prefer 1024px images, fallback to all valid images\nconst preferred=images.filter(img=>img.width===1024&&img.url);const fallback=images.filter(img=>img.url);const source=preferred.length>0?preferred:fallback;uniqueImages=source.map(img=>{// If Cloudinary public ID, convert to full URL; if full Cloudinary URL, use as is; else use full URL\nif(isCloudinaryId(img.url)){return{url:toCloudinaryUrl(img.url)||'',width:img.width};}const cloudinaryMatch=img.url.match(/res\\.cloudinary\\.com\\/[^/]+\\/image\\/upload\\/([^\\.]+)(\\.[a-zA-Z]+)?$/);if(cloudinaryMatch){return{url:img.url,width:img.width};}// Legacy or external URL\nreturn{url:img.url,width:img.width};});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"img\",style:{position:'relative',cursor:images&&images.length>0?'pointer':'default',width:'100%',aspectRatio:'1/1',overflow:'hidden',display:'flex',alignItems:'center',justifyContent:'center',background:'#f8f8f8',minHeight:0,boxSizing:'border-box',border:'1px solid #eee'// for debug\n},onClick:images&&images.length>0?()=>setShowSlider(true):undefined,children:[hasVideoUrl?/*#__PURE__*/_jsx(\"video\",{controls:true,width:\"100%\",poster:posterUrl,children:/*#__PURE__*/_jsx(\"source\",{src:videoUrl})}):typeof thumbUrl!=='undefined'&&thumbUrl?isCloudinaryThumb?/*#__PURE__*/_jsx(\"img\",{src:toCloudinaryUrl(thumbnail.url,{width:1024}),srcSet:[toCloudinaryUrl(thumbnail.url,{width:320})+' 320w',toCloudinaryUrl(thumbnail.url,{width:640})+' 640w',toCloudinaryUrl(thumbnail.url,{width:1024})+' 1024w',toCloudinaryUrl(thumbnail.url)+' 2000w'].join(', '),sizes:\"(max-width: 480px) 100vw, (max-width: 900px) 50vw, 320px\",alt:name,style:{width:'100%',height:'100%',borderRadius:'1rem',objectFit:'cover',aspectRatio:'1/1',display:'block',imageRendering:'auto'},id:\"dog-thumbnail\",onError:e=>{e.currentTarget.onerror=null;e.currentTarget.src='/img/nany.jpg';}}):/*#__PURE__*/_jsx(\"img\",{src:toHttps(thumbUrl),alt:name,style:{width:'100%',height:'100%',maxWidth:320,maxHeight:320,borderRadius:'1rem',objectFit:'cover',aspectRatio:'1/1',display:'block',imageRendering:'pixelated'},onError:e=>{e.currentTarget.onerror=null;e.currentTarget.src='/img/nany.jpg';}}):largestImgUrl?isCloudinaryId(largestImgUrl)?/*#__PURE__*/_jsx(\"img\",{src:toCloudinaryUrl(largestImgUrl,{width:1024}),srcSet:[toCloudinaryUrl(largestImgUrl,{width:320})+' 320w',toCloudinaryUrl(largestImgUrl,{width:640})+' 640w',toCloudinaryUrl(largestImgUrl,{width:1024})+' 1024w',toCloudinaryUrl(largestImgUrl)+' 2000w'].join(', '),sizes:\"(max-width: 480px) 100vw, (max-width: 900px) 50vw, 320px\",alt:name,style:{width:'100%',height:'100%',borderRadius:'1rem',objectFit:'cover',aspectRatio:'1/1',display:'block',imageRendering:'auto'},onError:e=>{e.currentTarget.onerror=null;e.currentTarget.src='/img/nany.jpg';}}):/*#__PURE__*/_jsx(\"img\",{src:toHttps(largestImgUrl),alt:name,srcSet:imgSrcSet,sizes:\"(max-width: 480px) 100vw, (max-width: 900px) 50vw, 320px\",style:{width:'100%',height:'100%',borderRadius:'1rem',objectFit:'cover',aspectRatio:'1/1',display:'block',imageRendering:'pixelated'},onError:e=>{e.currentTarget.onerror=null;e.currentTarget.src='/img/nany.jpg';}}):/*#__PURE__*/_jsx(\"img\",{src:imgSrc||'/img/nany.jpg',alt:name,style:{width:'100%',height:'100%',borderRadius:'1rem',objectFit:'cover',aspectRatio:'1/1',display:'block',imageRendering:'auto'},onError:e=>{e.currentTarget.onerror=null;e.currentTarget.src='/img/nany.jpg';}}),images&&images.length>1&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:8,right:8,zIndex:2},children:/*#__PURE__*/_jsx(MultiPhotoIndicator,{count:images.length})})]}),uniqueImages.length>0&&showSlider&&/*#__PURE__*/createPortal(/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,width:'100vw',height:'100vh',background:'rgba(0,0,0,0.85)',zIndex:9999,display:'flex',alignItems:'center',justifyContent:'center'},onClick:()=>setShowSlider(false),children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:600,width:'90vw',height:'90vw',background:'transparent',borderRadius:16,overflow:'hidden',position:'relative',display:'flex',alignItems:'center',justifyContent:'center'},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(DogImageSlider,{images:uniqueImages,alt:name}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSlider(false),style:{position:'absolute',top:8,right:8,zIndex:10,background:'#fff',border:'none',borderRadius:'50%',width:32,height:32,fontSize:20,cursor:'pointer',boxShadow:'0 2px 8px rgba(0,0,0,0.15)'},children:\"\\xD7\"})]})}),document.body),/*#__PURE__*/_jsxs(\"div\",{className:\"description\",children:[/*#__PURE__*/_jsxs(\"h3\",{style:{color:'#751719',marginBottom:4},children:[/*#__PURE__*/_jsx(\"strong\",{children:t('fields.name')}),\" \",name]}),breed&&/*#__PURE__*/_jsxs(\"p\",{className:\"meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"eky-icon eky-tag\"}),/*#__PURE__*/_jsx(\"strong\",{children:t('fields.breed')}),\" \",breed]}),gender&&(gender==='male'||gender==='female')&&/*#__PURE__*/_jsxs(\"p\",{className:\"meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"eky-icon eky-user\"}),/*#__PURE__*/_jsx(\"strong\",{children:t('fields.gender')}),\" \",t(\"gender.\".concat(gender))]}),place&&/*#__PURE__*/_jsxs(\"p\",{className:\"meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"eky-icon eky-map\"}),/*#__PURE__*/_jsx(\"strong\",{children:t('fields.location')}),/*#__PURE__*/_jsx(\"span\",{style:{cursor:place?'pointer':'default',textDecoration:place?'underline':'none'},onClick:place?handleShowMap:undefined,children:place})]}),showMap&&place&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-map\",style:{position:'fixed',top:0,left:0,width:'100vw',height:'100vh',background:'rgba(0,0,0,0.5)',zIndex:9999,display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',padding:20,borderRadius:12,maxWidth:600,width:'90vw',position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowMap(false),style:{position:'absolute',top:10,right:10,width:56,height:56,backgroundColor:'#e74c3c',color:'#fff',border:'none',borderRadius:'50%',display:'flex',alignItems:'center',justifyContent:'center',boxShadow:'0 4px 12px rgba(0,0,0,0.3)',cursor:'pointer',zIndex:2147483647,padding:0},title:t('common.close'),\"aria-label\":t('common.close'),children:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:40,fontWeight:900,lineHeight:'56px',width:'100%',textAlign:'center',display:'block',userSelect:'none',letterSpacing:2},children:\"\\xD7\"})}),/*#__PURE__*/_jsx(\"h3\",{style:{marginBottom:10},children:place}),loadingCoords?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:40},children:/*#__PURE__*/_jsx(\"span\",{children:t('dogDetails.loadingMap')||'Loading map...'})}):coords?/*#__PURE__*/_jsx(\"iframe\",{title:\"Map Preview\",width:\"100%\",height:\"400\",style:{border:0,borderRadius:8},src:\"https://www.openstreetmap.org/export/embed.html?bbox=\".concat(coords.lng-0.005,\",\").concat(coords.lat-0.005,\",\").concat(coords.lng+0.005,\",\").concat(coords.lat+0.005,\"&layer=mapnik&marker=\").concat(coords.lat,\",\").concat(coords.lng),allowFullScreen:true}):coordsError?/*#__PURE__*/_jsx(\"div\",{style:{color:'red',textAlign:'center',padding:40},children:coordsError}):null]})}),owner&&!isOwner&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'1rem',paddingTop:'1rem',borderTop:'1px solid #ddd'},children:[/*#__PURE__*/_jsxs(\"p\",{className:\"meta\",style:{marginBottom:'0.5rem'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('fields.postedBy')||'Posted by',\":\"]}),\" \",owner.name]}),owner.person&&/*#__PURE__*/_jsxs(\"p\",{className:\"meta\",style:{marginBottom:'0.5rem'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[t('fields.userType')||'Type',\":\"]}),\" \",t(\"registerOptions.\".concat(owner.person))||owner.person]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-actions\",style:{display:'flex',flexWrap:'wrap',gap:'4px',marginTop:'6px',alignItems:'center',justifyContent:'flex-start',width:'100%',rowGap:'4px',columnGap:'4px',minHeight:'24px',boxSizing:'border-box',overflow:'hidden'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"details\",onClick:onViewDetails,style:{padding:'2px 7px',border:'none',borderRadius:'10px',background:'#2196F3',// app main color\ncolor:'white',fontSize:'10px',fontWeight:500,whiteSpace:'nowrap',minWidth:'fit-content',boxShadow:'0 1px 4px rgba(33,150,243,0.08)'},children:t('button.viewDetails')}),isAuthenticated&&_id&&!isOwner&&/*#__PURE__*/_jsxs(_Fragment,{children:[adoptionStatusState==='pending'&&adoptionQueueState&&currentUser&&adoptionQueueState.adopter===currentUser._id?/*#__PURE__*/_jsx(\"button\",{id:\"cancel-adopt\",className:\"details\",onClick:async()=>{setAdoptLoading(true);setAdoptError(null);try{var _data$dog,_data$dog2;const resp=await fetch(\"\".concat(apiBase,\"/api/dogs/\").concat(_id,\"/adopt-cancel\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token')?\"Bearer \".concat(localStorage.getItem('token')):''},body:JSON.stringify({reason:''})});const data=await resp.json();if(!resp.ok)throw new Error(data.message||'Error');setAdoptionStatus(((_data$dog=data.dog)===null||_data$dog===void 0?void 0:_data$dog.adoptionStatus)||'available');setAdoptionQueue((_data$dog2=data.dog)===null||_data$dog2===void 0?void 0:_data$dog2.adoptionQueue);if(onDogUpdate&&data.dog)onDogUpdate(data.dog);}catch(e){setAdoptError(e.message||'Error');}finally{setAdoptLoading(false);}},disabled:adoptLoading,style:{background:'#e74c3c',border:'none',borderRadius:'10px',color:'white',fontSize:'10px',fontWeight:500},children:adoptLoading?t('button.cancelling')||'Odustajanje...':t('button.cancelAdoption')||'Odustani od posvajanja'}):adoptionStatusState==='pending'?/*#__PURE__*/_jsx(\"button\",{id:\"adopt\",className:\"details adopt-btn\",disabled:true,children:t('button.requested')||'Zahtjev poslan'}):/*#__PURE__*/_jsx(\"button\",{id:\"adopt\",className:\"details\",onClick:handleAdopt,disabled:adoptLoading||adoptionStatusState==='adopted',style:{background:'#267822',border:'none',borderRadius:'10px',color:'white',fontSize:'10px',fontWeight:500},children:adoptLoading?t('button.sending')||'Slanje...':t('button.adopt')}),adoptError&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red',marginTop:4,fontSize:'10px'},children:adoptError}),/*#__PURE__*/_jsxs(\"button\",{className:\"like \".concat(isLiked?'liked':''),onClick:async()=>{if(!isAuthenticated||!_id)return;if(isLiked){try{const response=await fetch(\"\".concat(apiBase,\"/api/dogs/\").concat(_id,\"/unlike\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const data=await response.json();setLikesCount(data.likesCount);setIsLiked(false);}}catch(error){console.error('Unlike error:',error);}}else{try{const response=await fetch(\"\".concat(apiBase,\"/api/dogs/\").concat(_id,\"/like\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const data=await response.json();setLikesCount(data.likesCount);setIsLiked(true);}}catch(error){console.error('Like error:',error);}}},style:{backgroundColor:isLiked?'#ff6b6b':'#f0f0f0',color:isLiked?'white':'#333',border:'1px solid #ddd',padding:'8px 12px',borderRadius:'4px',cursor:'pointer',fontSize:'12px',display:'flex',alignItems:'center',gap:'4px'},title:isLiked?'Unlike':'Like',children:[\"\\uD83D\\uDC4D \",likesCount]}),/*#__PURE__*/_jsx(\"button\",{className:\"wishlist \".concat(inWishlist?'in-wishlist':''),onClick:()=>{// eslint-disable-next-line no-console\nconsole.log('[CardSmall] addToList:',t('button.addToList'),'| removeFromList:',t('button.removeFromList'));handleWishlistToggle();},title:inWishlist?t('button.removeFromList'):t('button.addToList'),children:(()=>{const addToList=t('button.addToList');const removeFromList=t('button.removeFromList');// eslint-disable-next-line no-console\nreturn inWishlist?'ðŸ’” '+removeFromList:'â¤ï¸ '+addToList;})()})]}),!isAuthenticated&&_id&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#666',display:'flex',alignItems:'center',gap:'4px'},children:[\"\\uD83D\\uDC4D \",likesCount]}),canEdit&&onEdit&&/*#__PURE__*/_jsx(\"button\",{className:\"edit\",onClick:onEdit,title:t('button.edit')||'Edit',children:t('button.edit')||'Edit'}),canEdit&&onRemove&&/*#__PURE__*/_jsx(\"button\",{className:\"remove\",onClick:onRemove,title:t('button.remove')||'Remove',children:t('button.remove')||'Remove'})]})]})]})});};export default CardSmall;","map":{"version":3,"names":["React","useState","MultiPhotoIndicator","useTranslation","useAuth","DogImageSlider","createPortal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","toHttps","url","startsWith","replace","CardSmall","props","_currentUser$wishlist","_currentUser$wishlist2","_id","imgSrc","images","video","thumbnail","name","age","likes","breed","color","place","location","lat","lng","description","size","gender","vaccinated","neutered","onViewDetails","onEdit","onRemove","canEdit","user","owner","adoptionStatus","adoptionQueue","onDogUpdate","t","currentUser","isAuthenticated","token","addToWishlist","removeFromWishlist","showMap","setShowMap","coords","setCoords","coordsError","setCoordsError","loadingCoords","setLoadingCoords","isOwner","handleShowMap","response","fetch","concat","encodeURIComponent","headers","data","json","length","result","parseFloat","lon","e","inWishlist","setInWishlist","useEffect","wishlist","isInList","includes","join","likesCount","setLikesCount","isLiked","setIsLiked","adoptionStatusState","setAdoptionStatus","adoptionQueueState","setAdoptionQueue","adoptLoading","setAdoptLoading","adoptError","setAdoptError","getApiBase","process","env","REACT_APP_API_URL","window","hostname","apiBase","handleWishlistToggle","alert","currentlyInWishlist","success","error","handleAdopt","resp","method","localStorage","getItem","ok","Error","message","dog","isCloudinaryId","toCloudinaryUrl","publicId","options","undefined","cloudName","width","cacheBust","Date","now","imgSrcSet","largestImgUrl","validImages","filter","img","trim","largestImage","sorted","sort","a","b","i","map","posterUrl","poster","hasVideoUrl","videoUrl","thumbUrl","isCloudinaryThumb","showSlider","setShowSlider","uniqueImages","preferred","fallback","source","cloudinaryMatch","match","children","className","style","position","cursor","aspectRatio","overflow","display","alignItems","justifyContent","background","minHeight","boxSizing","border","onClick","controls","src","srcSet","sizes","alt","height","borderRadius","objectFit","imageRendering","id","onError","currentTarget","onerror","maxWidth","maxHeight","top","right","zIndex","count","left","stopPropagation","fontSize","boxShadow","document","body","marginBottom","textDecoration","padding","backgroundColor","title","fontWeight","lineHeight","textAlign","userSelect","letterSpacing","allowFullScreen","marginTop","paddingTop","borderTop","person","flexWrap","gap","rowGap","columnGap","whiteSpace","minWidth","adopter","_data$dog","_data$dog2","JSON","stringify","reason","disabled","console","log","addToList","removeFromList"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/CardSmall.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport MultiPhotoIndicator from './MultiPhotoIndicator';\nimport { AdvancedImage } from '@cloudinary/react';\nimport { Cloudinary } from '@cloudinary/url-gen';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { useNavigate } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../contexts/AuthContext';\nimport DogImageSlider from './DogImageSlider';\nimport { createPortal } from 'react-dom';\n\n// Geocode location if needed (mirrors DogDetails)\n// (handleShowMap will be defined inside the component, after imports)\n// ...existing imports...\nconst toHttps = (url?: string) =>\n  url && url.startsWith('http://') ? url.replace('http://', 'https://') : url;\ninterface MediaVariant { url: string; width?: number; size?: string }\ninterface CardSmallProps {\n  _id?: string;\n  imgSrc?: string;\n  images?: MediaVariant[];\n  video?: { url: string; poster?: MediaVariant[] };\n  thumbnail?: MediaVariant;\n  name: string;\n  age?: number;\n  likes?: string[];\n  breed?: string;\n  color?: string;\n  place?: string;\n  location?: string;\n  lat?: number;\n  lng?: number;\n  description?: string;\n  size?: string;\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n  onViewDetails?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  onEdit?: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  onRemove?: () => void;\n  canEdit?: boolean;\n  user?: {\n    _id: string;\n    name: string;\n    username: string;\n    email?: string;\n    phone?: string;\n    person?: 'private' | 'organization';\n  };\n  adoptionStatus?: string;\n  adoptionQueue?: any;\n  onDogUpdate?: (dog: any) => void;\n}\n\n\n\nconst CardSmall: React.FC<CardSmallProps> = (props) => {\n  // Destructure props for easier access\n  const {\n    _id,\n    imgSrc,\n    images,\n    video,\n    thumbnail,\n    name,\n    age,\n    likes,\n    breed,\n    color,\n    place,\n    location,\n    lat,\n    lng,\n    description,\n    size,\n    gender,\n    vaccinated,\n    neutered,\n    onViewDetails,\n    onEdit,\n    onRemove,\n    canEdit,\n    user: owner,\n    adoptionStatus,\n    adoptionQueue,\n    onDogUpdate,\n  } = props;\n\n  const { t } = useTranslation();\n  const { currentUser, isAuthenticated, token, addToWishlist, removeFromWishlist } = useAuth();\n  const [showMap, setShowMap] = useState(false);\n  const [coords, setCoords] = useState<{ lat: number; lng: number } | null>(null);\n  const [coordsError, setCoordsError] = useState<string | null>(null);\n  const [loadingCoords, setLoadingCoords] = useState(false);\n\n  const isOwner = currentUser && owner && currentUser._id === owner._id;\n\n  const handleShowMap = async () => {\n    if (!place) return;\n    setLoadingCoords(true);\n    setCoords(null);\n    setCoordsError(null);\n    try {\n      const response = await fetch(\n        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(place)}`,\n        {\n          headers: {\n            'Accept': 'application/json',\n            'User-Agent': 'eky-app/1.0 (your@email.com)'\n          }\n        }\n      );\n      const data = await response.json();\n      if (data && data.length) {\n        const result = data[0];\n        setCoords({ lat: parseFloat(result.lat), lng: parseFloat(result.lon) });\n      } else {\n        setCoordsError(t('dogDetails.approximateLocation') || 'Approximate location');\n      }\n    } catch (e) {\n      setCoordsError(t('dogDetails.searchBasedLocation') || 'Search-based location');\n    } finally {\n      setLoadingCoords(false);\n      setShowMap(true);\n    }\n  };\n  // Wishlist state\n  const [inWishlist, setInWishlist] = useState(false);\n  React.useEffect(() => {\n    if (_id && currentUser && currentUser.wishlist) {\n      const isInList = currentUser.wishlist.includes(_id);\n      setInWishlist(isInList);\n    } else {\n      setInWishlist(false);\n    }\n  }, [_id, currentUser?._id, currentUser?.wishlist?.length, currentUser?.wishlist?.join(',')]);\n\n  // Likes state\n  const [likesCount, setLikesCount] = useState(likes?.length || 0);\n  const [isLiked, setIsLiked] = useState(likes?.includes(currentUser?._id || '') || false);\n  React.useEffect(() => {\n    if (likes && currentUser?._id) {\n      setIsLiked(likes.includes(currentUser._id));\n      setLikesCount(likes.length);\n    } else {\n      setIsLiked(false);\n      setLikesCount(likes?.length || 0);\n    }\n  }, [likes, currentUser?._id]);\n\n  // Adoption state for list view\n  const [adoptionStatusState, setAdoptionStatus] = useState<string | undefined>(adoptionStatus);\n  const [adoptionQueueState, setAdoptionQueue] = useState<any>(adoptionQueue);\n  React.useEffect(() => {\n    setAdoptionStatus(adoptionStatus);\n    setAdoptionQueue(adoptionQueue);\n  }, [adoptionStatus, adoptionQueue, _id]);\n  const [adoptLoading, setAdoptLoading] = useState(false);\n  const [adoptError, setAdoptError] = useState<string | null>(null);\n\n  // API base\n  const getApiBase = () => {\n    if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n      return `http://${window.location.hostname}:3001`;\n    }\n    return `http://${window.location.hostname}:3001`;\n  };\n  const apiBase = getApiBase();\n\n  const handleWishlistToggle = async () => {\n    if (!_id || !isAuthenticated) {\n      alert('Please log in to add dogs to your wishlist');\n      return;\n    }\n    const currentlyInWishlist = inWishlist;\n    if (currentlyInWishlist) {\n      const result = await removeFromWishlist(_id);\n      if (result.success) {\n        setInWishlist(false);\n        alert('Removed from wishlist!');\n      } else {\n        alert('Failed to remove from wishlist: ' + (result.error || 'Unknown error'));\n      }\n    } else {\n      const result = await addToWishlist(_id);\n      if (result.success) {\n        setInWishlist(true);\n        alert('Added to wishlist! â¤ï¸');\n      } else {\n        alert('Failed to add to wishlist: ' + (result.error || 'Unknown error'));\n      }\n    }\n  };\n\n  const handleAdopt = async () => {\n    if (!_id) return;\n    setAdoptLoading(true);\n    setAdoptError(null);\n    try {\n      const resp = await fetch(`${apiBase}/api/dogs/${_id}/adopt-request`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': localStorage.getItem('token') ? `Bearer ${localStorage.getItem('token')}` : ''\n        }\n      });\n      const data = await resp.json();\n      if (!resp.ok) throw new Error(data.message || 'Error');\n      setAdoptionStatus(data.dog.adoptionStatus);\n      setAdoptionQueue(data.dog.adoptionQueue);\n      if (onDogUpdate && data.dog) onDogUpdate(data.dog);\n    } catch (e: any) {\n      setAdoptError(e.message || 'Error');\n    } finally {\n      setAdoptLoading(false);\n    }\n  };\n\n  // Helper to check if a string is a Cloudinary public ID (not a URL)\n  const isCloudinaryId = (url?: string) => url && !url.startsWith('http') && !url.startsWith('/uploads/');\n  // Image helpers\n  // Always use Cloudinary public_id for migrated images\n  const toCloudinaryUrl = (publicId?: string, options?: { width?: number }) => {\n    if (!publicId) return undefined;\n    // Replace with your actual cloud name\n    const cloudName = 'dtqzrm4by';\n    let url = `https://res.cloudinary.com/${cloudName}/image/upload/${publicId}`;\n    if (options?.width) url += `/w_${options.width}`;\n    return url;\n  };\n  const cacheBust = `t=${Date.now()}`;\n  // Build srcSet with all available sizes, always including the largest/original\n  let imgSrcSet: string | undefined = undefined;\n  let largestImgUrl: string | undefined = undefined;\n  // Filter images to only those with valid URLs\n  const validImages = (images || []).filter(img => img && img.url && typeof img.url === 'string' && img.url.trim() !== '');\n  let largestImage = undefined;\n  if (validImages.length) {\n    // Prefer original (no width param) for Cloudinary, else largest available\n    const sorted = [...validImages].sort((a, b) => (b.width || 0) - (a.width || 0));\n    largestImage = sorted[0];\n    imgSrcSet = sorted\n      .filter(i => isCloudinaryId(i.url))\n      .map(i => `${toCloudinaryUrl(i.url)} ${i.width || 2000}w`)\n      .join(', ');\n    if (largestImage && isCloudinaryId(largestImage.url)) {\n      largestImgUrl = toCloudinaryUrl(largestImage.url); // no width param: original\n    } else if (largestImage) {\n      largestImgUrl = largestImage.url;\n    }\n    if (largestImgUrl && imgSrcSet && !imgSrcSet.includes(largestImgUrl)) {\n      imgSrcSet += `, ${largestImgUrl} 2000w`;\n    }\n  }\n\n  const posterUrl = video && video.poster && video.poster.length\n    ? (isCloudinaryId(video.poster[video.poster.length - 1].url)\n        ? toCloudinaryUrl(video.poster[video.poster.length - 1].url)\n        : video.poster[video.poster.length - 1].url)\n    : undefined;\n  const hasVideoUrl = video && typeof video.url === 'string' && video.url.length > 0;\n  const videoUrl = hasVideoUrl\n    ? (isCloudinaryId(video.url)\n        ? toCloudinaryUrl(video.url)\n        : video.url)\n    : undefined;\n  let thumbUrl: string | undefined = undefined;\n  let isCloudinaryThumb = false;\n  if (thumbnail && thumbnail.url) {\n    if (isCloudinaryId(thumbnail.url)) {\n      thumbUrl = toCloudinaryUrl(thumbnail.url);\n      isCloudinaryThumb = true;\n    } else if (thumbnail.url.startsWith('http') || thumbnail.url.startsWith('/uploads/')) {\n      thumbUrl = thumbnail.url;\n      isCloudinaryThumb = false;\n    }\n  }\n\n  const [showSlider, setShowSlider] = useState(false);\n\n  // Prepare unique images for DogImageSlider (one per uploaded photo, pick only 1024px variant)\n  let uniqueImages: { url: string; width?: number }[] = [];\n  if (images && images.length > 0) {\n    // Prefer 1024px images, fallback to all valid images\n    const preferred = images.filter(img => img.width === 1024 && img.url);\n    const fallback = images.filter(img => img.url);\n    const source = preferred.length > 0 ? preferred : fallback;\n    uniqueImages = source.map(img => {\n      // If Cloudinary public ID, convert to full URL; if full Cloudinary URL, use as is; else use full URL\n      if (isCloudinaryId(img.url)) {\n        return { url: toCloudinaryUrl(img.url) || '', width: img.width };\n      }\n      const cloudinaryMatch = img.url.match(/res\\.cloudinary\\.com\\/[^/]+\\/image\\/upload\\/([^\\.]+)(\\.[a-zA-Z]+)?$/);\n      if (cloudinaryMatch) {\n        return { url: img.url, width: img.width };\n      }\n      // Legacy or external URL\n      return { url: img.url, width: img.width };\n    });\n  }\n\n  return (\n    <>\n      <div className=\"card\">\n        <div\n          className=\"img\"\n          style={{\n            position: 'relative',\n            cursor: images && images.length > 0 ? 'pointer' : 'default',\n            width: '100%',\n            aspectRatio: '1/1',\n            overflow: 'hidden',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            background: '#f8f8f8',\n            minHeight: 0,\n            boxSizing: 'border-box',\n            border: '1px solid #eee', // for debug\n          }}\n          onClick={images && images.length > 0 ? () => setShowSlider(true) : undefined}\n        >\n          {hasVideoUrl ? (\n            <video controls width=\"100%\" poster={posterUrl}>\n              <source src={videoUrl} />\n            </video>\n          ) : (typeof (thumbUrl) !== 'undefined' && thumbUrl) ? (\n              isCloudinaryThumb\n                ? (\n                  <img\n                    src={toCloudinaryUrl(thumbnail.url, { width: 1024 })}\n                    srcSet={[\n                      toCloudinaryUrl(thumbnail.url, { width: 320 }) + ' 320w',\n                      toCloudinaryUrl(thumbnail.url, { width: 640 }) + ' 640w',\n                      toCloudinaryUrl(thumbnail.url, { width: 1024 }) + ' 1024w',\n                      toCloudinaryUrl(thumbnail.url) + ' 2000w'\n                    ].join(', ')}\n                    sizes=\"(max-width: 480px) 100vw, (max-width: 900px) 50vw, 320px\"\n                    alt={name}\n                    style={{\n                      width: '100%',\n                      height: '100%',\n                      borderRadius: '1rem',\n                      objectFit: 'cover',\n                      aspectRatio: '1/1',\n                      display: 'block',\n                      imageRendering: 'auto',\n                    }}\n                    id=\"dog-thumbnail\"\n                    onError={e => { e.currentTarget.onerror = null; e.currentTarget.src = '/img/nany.jpg'; }}\n                  />\n                )\n                : <img src={toHttps(thumbUrl)} alt={name} style={{ width: '100%', height: '100%', maxWidth: 320, maxHeight: 320, borderRadius: '1rem', objectFit: 'cover', aspectRatio: '1/1', display: 'block', imageRendering: 'pixelated' }} onError={e => { e.currentTarget.onerror = null; e.currentTarget.src = '/img/nany.jpg'; }} />\n          ) : (largestImgUrl) ? (\n              isCloudinaryId(largestImgUrl)\n                ? (\n                  <img\n                    src={toCloudinaryUrl(largestImgUrl, { width: 1024 })}\n                    srcSet={[\n                      toCloudinaryUrl(largestImgUrl, { width: 320 }) + ' 320w',\n                      toCloudinaryUrl(largestImgUrl, { width: 640 }) + ' 640w',\n                      toCloudinaryUrl(largestImgUrl, { width: 1024 }) + ' 1024w',\n                      toCloudinaryUrl(largestImgUrl) + ' 2000w'\n                    ].join(', ')}\n                    sizes=\"(max-width: 480px) 100vw, (max-width: 900px) 50vw, 320px\"\n                    alt={name}\n                    style={{\n                      width: '100%',\n                      height: '100%',\n                      borderRadius: '1rem',\n                      objectFit: 'cover',\n                      aspectRatio: '1/1',\n                      display: 'block',\n                      imageRendering: 'auto',\n                    }}\n                    onError={e => { e.currentTarget.onerror = null; e.currentTarget.src = '/img/nany.jpg'; }}\n                  />\n                )\n                : <img src={toHttps(largestImgUrl)} alt={name} srcSet={imgSrcSet} sizes=\"(max-width: 480px) 100vw, (max-width: 900px) 50vw, 320px\" style={{ width: '100%', height: '100%', borderRadius: '1rem', objectFit: 'cover', aspectRatio: '1/1', display: 'block', imageRendering: 'pixelated' }} onError={e => { e.currentTarget.onerror = null; e.currentTarget.src = '/img/nany.jpg'; }} />\n          ) : (\n              <img src={imgSrc || '/img/nany.jpg'}\n                alt={name}\n                style={{ width: '100%', height: '100%', borderRadius: '1rem', objectFit: 'cover', aspectRatio: '1/1', display: 'block', imageRendering: 'auto' }}\n                onError={e => { e.currentTarget.onerror = null; e.currentTarget.src = '/img/nany.jpg'; }} />\n          )}\n          {images && images.length > 1 && (\n            <div style={{ position: 'absolute', top: 8, right: 8, zIndex: 2 }}>\n              <MultiPhotoIndicator count={images.length} />\n            </div>\n          )}\n        </div>\n\n        {/* Modal DogImageSlider */}\n        {uniqueImages.length > 0 && showSlider && createPortal(\n          <div\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              width: '100vw',\n              height: '100vh',\n              background: 'rgba(0,0,0,0.85)',\n              zIndex: 9999,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n            }}\n            onClick={() => setShowSlider(false)}\n          >\n            <div\n              style={{\n                maxWidth: 600,\n                width: '90vw',\n                height: '90vw',\n                background: 'transparent',\n                borderRadius: 16,\n                overflow: 'hidden',\n                position: 'relative',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center'\n              }}\n              onClick={e => e.stopPropagation()}\n            >\n              <DogImageSlider images={uniqueImages} alt={name} />\n              <button onClick={() => setShowSlider(false)} style={{ position: 'absolute', top: 8, right: 8, zIndex: 10, background: '#fff', border: 'none', borderRadius: '50%', width: 32, height: 32, fontSize: 20, cursor: 'pointer', boxShadow: '0 2px 8px rgba(0,0,0,0.15)' }}>Ã—</button>\n            </div>\n          </div>,\n          document.body\n        )}\n\n        <div className=\"description\">\n          <h3 style={{ color: '#751719', marginBottom: 4 }}>\n            <strong>{t('fields.name')}</strong> {name}\n          </h3>\n          {breed && (\n            <p className=\"meta\">\n              <span className=\"eky-icon eky-tag\"></span>\n              <strong>{t('fields.breed')}</strong> {breed}\n            </p>\n          )}\n          {gender && (gender === 'male' || gender === 'female') && (\n            <p className=\"meta\">\n              <span className=\"eky-icon eky-user\"></span>\n              <strong>{t('fields.gender')}</strong> {t(`gender.${gender}`)}\n            </p>\n          )}\n          {place && (\n            <p className=\"meta\">\n              <span className=\"eky-icon eky-map\"></span>\n              <strong>{t('fields.location')}</strong> \n              <span\n                style={{ cursor: place ? 'pointer' : 'default', textDecoration: place ? 'underline' : 'none' }}\n                onClick={place ? handleShowMap : undefined}\n              >\n                {place}\n              </span>\n            </p>\n          )}\n          {showMap && place && (\n            <div className=\"modal-map\" style={{ position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh', background: 'rgba(0,0,0,0.5)', zIndex: 9999, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n              <div style={{ background: '#fff', padding: 20, borderRadius: 12, maxWidth: 600, width: '90vw', position: 'relative' }}>\n                <button\n                  onClick={() => setShowMap(false)}\n                  style={{\n                    position: 'absolute',\n                    top: 10,\n                    right: 10,\n                    width: 56,\n                    height: 56,\n                    backgroundColor: '#e74c3c',\n                    color: '#fff',\n                    border: 'none',\n                    borderRadius: '50%',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    boxShadow: '0 4px 12px rgba(0,0,0,0.3)',\n                    cursor: 'pointer',\n                    zIndex: 2147483647,\n                    padding: 0\n                  }}\n                  title={t('common.close')}\n                  aria-label={t('common.close')}\n                >\n                  <span style={{\n                    fontSize: 40,\n                    fontWeight: 900,\n                    lineHeight: '56px',\n                    width: '100%',\n                    textAlign: 'center',\n                    display: 'block',\n                    userSelect: 'none',\n                    letterSpacing: 2\n                  }}>Ã—</span>\n                </button>\n                <h3 style={{ marginBottom: 10 }}>{place}</h3>\n                {loadingCoords ? (\n                  <div style={{ textAlign: 'center', padding: 40 }}>\n                    <span>{t('dogDetails.loadingMap') || 'Loading map...'}</span>\n                  </div>\n                ) : coords ? (\n                  <iframe\n                    title=\"Map Preview\"\n                    width=\"100%\"\n                    height=\"400\"\n                    style={{ border: 0, borderRadius: 8 }}\n                    src={`https://www.openstreetmap.org/export/embed.html?bbox=${coords.lng-0.005},${coords.lat-0.005},${coords.lng+0.005},${coords.lat+0.005}&layer=mapnik&marker=${coords.lat},${coords.lng}`}\n                    allowFullScreen\n                  />\n                ) : coordsError ? (\n                  <div style={{ color: 'red', textAlign: 'center', padding: 40 }}>{coordsError}</div>\n                ) : null}\n              </div>\n            </div>\n          )}\n        {/* ...existing code... */}\n          \n          {owner && !isOwner && (\n            <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #ddd' }}>\n              <p className=\"meta\" style={{ marginBottom: '0.5rem' }}>\n                <strong>{t('fields.postedBy') || 'Posted by'}:</strong> {owner.name}\n              </p>\n              {owner.person && (\n                <p className=\"meta\" style={{ marginBottom: '0.5rem' }}>\n                  <strong>{t('fields.userType') || 'Type'}:</strong> {t(`registerOptions.${owner.person}`) || owner.person}\n                </p>\n              )}\n              {/* Phone and email hidden in dog list */}\n            </div>\n          )}\n          \n          <div className=\"card-actions\" style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '4px',\n            marginTop: '6px',\n            alignItems: 'center',\n            justifyContent: 'flex-start',\n            width: '100%',\n            rowGap: '4px',\n            columnGap: '4px',\n            minHeight: '24px',\n            boxSizing: 'border-box',\n            overflow: 'hidden'\n          }}>\n            <button \n              className=\"details\"\n              onClick={onViewDetails}\n              style={{\n                padding: '2px 7px',\n                border: 'none',\n                borderRadius: '10px',\n                background: '#2196F3', // app main color\n                color: 'white',\n                fontSize: '10px',\n                fontWeight: 500,\n                whiteSpace: 'nowrap',\n                minWidth: 'fit-content',\n                boxShadow: '0 1px 4px rgba(33,150,243,0.08)'\n              }}\n            >\n              {t('button.viewDetails')}\n            </button>\n            {isAuthenticated && _id && !isOwner && (\n              <>\n                {/* ADOPT/ODUSTANI LOGIKA (simplified for list) */}\n                {adoptionStatusState === 'pending' && adoptionQueueState && currentUser && adoptionQueueState.adopter === currentUser._id ? (\n                  <button\n                    id=\"cancel-adopt\"\n                    className=\"details\"\n                    onClick={async () => {\n                      setAdoptLoading(true);\n                      setAdoptError(null);\n                      try {\n                        const resp = await fetch(`${apiBase}/api/dogs/${_id}/adopt-cancel`, {\n                          method: 'POST',\n                          headers: {\n                            'Content-Type': 'application/json',\n                            'Authorization': localStorage.getItem('token') ? `Bearer ${localStorage.getItem('token')}` : ''\n                          },\n                          body: JSON.stringify({ reason: '' })\n                        });\n                        const data = await resp.json();\n                        if (!resp.ok) throw new Error(data.message || 'Error');\n                        setAdoptionStatus(data.dog?.adoptionStatus || 'available');\n                        setAdoptionQueue(data.dog?.adoptionQueue);\n                        if (onDogUpdate && data.dog) onDogUpdate(data.dog);\n                      } catch (e: any) {\n                        setAdoptError(e.message || 'Error');\n                      } finally {\n                        setAdoptLoading(false);\n                      }\n                    }}\n                    disabled={adoptLoading}\n                    style={{\n                      background: '#e74c3c',\n                      border: 'none',\n                      borderRadius: '10px',\n                      color: 'white',\n                      fontSize: '10px',\n                      fontWeight: 500\n                    }}\n                  >\n                    {adoptLoading ? (t('button.cancelling') || 'Odustajanje...') : (t('button.cancelAdoption') || 'Odustani od posvajanja')}\n                  </button>\n                ) : adoptionStatusState === 'pending' ? (\n                  <button\n                    id=\"adopt\"\n                    className=\"details adopt-btn\"\n                    disabled\n                  >\n                    {t('button.requested') || 'Zahtjev poslan'}\n                  </button>\n                ) : (\n                  <button\n                    id=\"adopt\"\n                    className=\"details\"\n                    onClick={handleAdopt}\n                    disabled={adoptLoading || adoptionStatusState === 'adopted'}\n                    style={{\n                      background: '#267822',\n                      border: 'none',\n                      borderRadius: '10px',\n                      color: 'white',\n                      fontSize: '10px',\n                      fontWeight: 500\n                    }}\n                  >\n                    {adoptLoading\n                      ? t('button.sending') || 'Slanje...'\n                      : t('button.adopt')}\n                  </button>\n                )}\n                {adoptError && <div style={{ color: 'red', marginTop: 4, fontSize: '10px' }}>{adoptError}</div>}\n                <button \n                  className={`like ${isLiked ? 'liked' : ''}`}\n                  onClick={async () => {\n                    if (!isAuthenticated || !_id) return;\n                    if (isLiked) {\n                      try {\n                        const response = await fetch(`${apiBase}/api/dogs/${_id}/unlike`, {\n                          method: 'POST',\n                          headers: {\n                            'Authorization': `Bearer ${token}`\n                          }\n                        });\n                        if (response.ok) {\n                          const data = await response.json();\n                          setLikesCount(data.likesCount);\n                          setIsLiked(false);\n                        }\n                      } catch (error) {\n                        console.error('Unlike error:', error);\n                      }\n                    } else {\n                      try {\n                        const response = await fetch(`${apiBase}/api/dogs/${_id}/like`, {\n                          method: 'POST',\n                          headers: {\n                            'Authorization': `Bearer ${token}`\n                          }\n                        });\n                        if (response.ok) {\n                          const data = await response.json();\n                          setLikesCount(data.likesCount);\n                          setIsLiked(true);\n                        }\n                      } catch (error) {\n                        console.error('Like error:', error);\n                      }\n                    }\n                  }}\n                  style={{\n                    backgroundColor: isLiked ? '#ff6b6b' : '#f0f0f0',\n                    color: isLiked ? 'white' : '#333',\n                    border: '1px solid #ddd',\n                    padding: '8px 12px',\n                    borderRadius: '4px',\n                    cursor: 'pointer',\n                    fontSize: '12px',\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: '4px'\n                  }}\n                  title={isLiked ? 'Unlike' : 'Like'}\n                >\n                  ðŸ‘ {likesCount}\n                </button>\n                <button \n                  className={`wishlist ${inWishlist ? 'in-wishlist' : ''}`}\n                  onClick={() => {\n                    // eslint-disable-next-line no-console\n                    console.log('[CardSmall] addToList:', t('button.addToList'), '| removeFromList:', t('button.removeFromList'));\n                    handleWishlistToggle();\n                  }}\n\n                  title={inWishlist ? t('button.removeFromList') : t('button.addToList')}\n                >\n                  {(() => {\n                    const addToList = t('button.addToList');\n                    const removeFromList = t('button.removeFromList');\n                    // eslint-disable-next-line no-console\n                    return inWishlist ? 'ðŸ’” ' + removeFromList : 'â¤ï¸ ' + addToList;\n                  })()}\n                </button>\n              </>\n            )}\n            {!isAuthenticated && _id && (\n              <div style={{ fontSize: '12px', color: '#666', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                ðŸ‘ {likesCount}\n              </div>\n            )}\n            {canEdit && onEdit && (\n              <button\n                className=\"edit\"\n                onClick={onEdit}\n                title={t('button.edit') || 'Edit'}\n\n              >\n                {t('button.edit') || 'Edit'}\n              </button>\n            )}\n            {canEdit && onRemove && (\n              <button\n                className=\"remove\"\n                onClick={onRemove}\n                title={t('button.remove') || 'Remove'}\n\n              >\n                {t('button.remove') || 'Remove'}\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CardSmall;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}