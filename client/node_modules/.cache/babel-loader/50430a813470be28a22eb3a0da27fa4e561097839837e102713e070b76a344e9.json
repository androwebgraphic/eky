{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// Simple, reliable API URL for mobile\nconst API_URL = process.env.REACT_APP_API_URL || (window.location.protocol === 'https:' ? `https://${window.location.hostname}` : window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' ? 'http://localhost:3001' : 'http://172.20.10.2:3001');\nconst AdddogForm = () => {\n  _s();\n  const {\n    t\n  } = useTranslation();\n  const {\n    token,\n    isAuthenticated\n  } = useAuth();\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', {\n      isAuthenticated,\n      hasToken: !!token,\n      tokenLength: token === null || token === void 0 ? void 0 : token.length\n    });\n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n  const [mediaFiles, setMediaFiles] = useState([]);\n  const [mediaPreviews, setMediaPreviews] = useState([]);\n  const [smallPreviews, setSmallPreviews] = useState([]);\n  const [isVideo, setIsVideo] = useState(false); // Only for single video, not for images\n  const [posterBlob, setPosterBlob] = useState(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = file => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob(blob => {\n          cleanup();\n          if (blob) resolve(blob);else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = e => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file, size = 64) => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = e => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  const onFileChange = async e => {\n    const files = e.target.files ? Array.from(e.target.files) : [];\n    if (!files.length) return;\n    setMediaFiles(files);\n\n    // Clean up previous previews\n    mediaPreviews.forEach(url => {\n      if (url.startsWith('blob:')) URL.revokeObjectURL(url);\n    });\n    setMediaPreviews([]);\n    setSmallPreviews([]);\n    const previews = [];\n    const thumbs = [];\n    for (const f of files) {\n      const url = URL.createObjectURL(f);\n      previews.push(url);\n      if (f.type.startsWith('image/')) {\n        try {\n          const thumb = await createImageThumbnail(f, 64);\n          thumbs.push(thumb);\n        } catch (err) {\n          thumbs.push('');\n        }\n      } else {\n        thumbs.push('');\n      }\n    }\n    setMediaPreviews(previews);\n    setSmallPreviews(thumbs);\n    setIsVideo(files.length === 1 && files[0].type.startsWith('video/'));\n    // Poster logic for video can be added if needed\n  };\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState(null);\n  const [successMessage, setSuccessMessage] = useState(null);\n  const abortControllerRef = useRef(null);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n  const onSubmit = async fields => {\n    var _fields$name, _fields$location;\n    console.log('Form submit triggered with fields:', fields);\n\n    // Basic validation\n    if (!((_fields$name = fields.name) !== null && _fields$name !== void 0 && _fields$name.trim())) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!((_fields$location = fields.location) !== null && _fields$location !== void 0 && _fields$location.trim())) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n      if (mediaFiles.length) {\n        mediaFiles.forEach((file, idx) => {\n          formData.append('media', file, file.name);\n        });\n        // Poster logic for video can be added here if needed\n      }\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media files present:', mediaFiles.length);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      abortControllerRef.current = new AbortController();\n      const headers = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      }).catch(async firstError => {\n        // If initial fetch fails on mobile, try fallback URLs\n        console.warn('First fetch failed, trying fallback:', firstError.message);\n        const fallbackUrls = ['http://172.20.10.2:3001/api/dogs',\n        // Direct IP\n        'http://localhost:3001/api/dogs' // Localhost fallback\n        ];\n        for (const fallbackUrl of fallbackUrls) {\n          try {\n            console.log('Trying fallback URL:', fallbackUrl);\n            const fallbackResp = await fetch(fallbackUrl, {\n              method: 'POST',\n              body: formData,\n              signal: abortControllerRef.current.signal,\n              headers\n            });\n            console.log('Fallback succeeded:', fallbackUrl);\n            return fallbackResp;\n          } catch (fallbackError) {\n            console.warn('Fallback failed:', fallbackUrl, fallbackError.message);\n          }\n        }\n\n        // If all fallbacks fail, throw the original error\n        throw firstError;\n      });\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => {\n          if (isMountedRef.current) navigate('/psi');\n        }, 1400);\n      }\n    } catch (err) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: t('adddog.title')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"adddog-form\",\n      onSubmit: handleSubmit(onSubmit),\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-name\",\n        children: t('adddog.name')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-name\",\n        name: \"name\",\n        autoComplete: \"name\",\n        placeholder: t('adddog.name'),\n        ...register('name', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this), errors.name && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        role: \"alert\",\n        children: [t('adddog.name'), \" is required\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-breed\",\n        children: t('adddog.breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-breed\",\n        name: \"breed\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.breed'),\n        ...register('breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-color\",\n        children: t('adddog.color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-color\",\n        name: \"color\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.color'),\n        ...register('color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-location\",\n        children: t('adddog.location')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-location\",\n        name: \"location\",\n        autoComplete: \"address-level2\",\n        placeholder: t('adddog.location'),\n        ...register('location', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-age\",\n        children: t('adddog.age')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        children: t('adddogExtra.ageNote')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        id: \"adddog-age\",\n        name: \"age\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.age'),\n        step: \"0.1\",\n        ...register('age', {\n          valueAsNumber: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-media\",\n        children: t('adddog.photos')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        id: \"adddog-media\",\n        name: \"media\",\n        accept: \"image/*,video/*\",\n        multiple: true,\n        onChange: onFileChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 8,\n          margin: '8px 0'\n        },\n        children: mediaPreviews.map((url, idx) => /*#__PURE__*/_jsxDEV(\"img\", {\n          src: url,\n          alt: `preview-${idx}`,\n          style: {\n            width: 64,\n            height: 64,\n            objectFit: 'cover',\n            borderRadius: 8,\n            border: '1px solid #ccc'\n          }\n        }, url, false, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-description\",\n        children: t('adddog.description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        id: \"adddog-description\",\n        name: \"description\",\n        rows: 3,\n        cols: 30,\n        autoComplete: \"off\",\n        placeholder: t('adddog.description'),\n        ...register('description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-size\",\n        children: t('adddog.size')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        ...register('size'),\n        id: \"adddog-size\",\n        name: \"size\",\n        autoComplete: \"off\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"small\",\n          children: t('size.small')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"medium\",\n          children: t('size.medium')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"large\",\n          children: t('size.large')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"gender\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: t('adddog.gender')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"gender-options\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-male\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-male\",\n              name: \"gender\",\n              value: \"male\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.male')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-female\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-female\",\n              name: \"gender\",\n              value: \"female\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.female')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"health\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-vaccinated\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.vaccinated')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('vaccinated'),\n            id: \"adddog-vaccinated\",\n            name: \"vaccinated\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-neutered\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.neutered')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('neutered'),\n            id: \"adddog-neutered\",\n            name: \"neutered\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"media-upload\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-media\",\n          children: t('adddog.photos')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          id: \"adddog-media\",\n          name: \"media\",\n          accept: \"image/*,video/*\",\n          multiple: true,\n          onChange: onFileChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: 8,\n            margin: '8px 0'\n          },\n          children: mediaPreviews.map((url, idx) => /*#__PURE__*/_jsxDEV(\"img\", {\n            src: smallPreviews[idx] || url,\n            alt: `preview-${idx}`,\n            style: {\n              width: 64,\n              height: 64,\n              objectFit: 'cover',\n              borderRadius: 8,\n              border: '1px solid #ccc'\n            }\n          }, url, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: submitting,\n          children: submitting ? t('adddog.saving') : t('button.addDog')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this), submitError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          role: \"alert\",\n          children: submitError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 27\n        }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification success\",\n          role: \"status\",\n          children: successMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 30\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 322,\n    columnNumber: 5\n  }, this);\n};\n_s(AdddogForm, \"zfuxZQiYz8bqRL+NzUVq0zdqu9E=\", false, function () {\n  return [useTranslation, useAuth, useForm, useNavigate];\n});\n_c = AdddogForm;\nexport default AdddogForm;\nvar _c;\n$RefreshReg$(_c, \"AdddogForm\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","useTranslation","useNavigate","useAuth","jsxDEV","_jsxDEV","API_URL","process","env","REACT_APP_API_URL","window","location","protocol","hostname","AdddogForm","_s","t","token","isAuthenticated","register","handleSubmit","formState","errors","defaultValues","vaccinated","neutered","navigate","isMountedRef","console","log","hasToken","tokenLength","length","warn","current","mediaFiles","setMediaFiles","mediaPreviews","setMediaPreviews","smallPreviews","setSmallPreviews","isVideo","setIsVideo","posterBlob","setPosterBlob","createVideoPoster","file","Promise","resolve","reject","url","URL","createObjectURL","video","document","createElement","preload","muted","src","currentTime","cleanup","revokeObjectURL","onloadeddata","canvas","width","videoWidth","height","videoHeight","ctx","getContext","Error","drawImage","toBlob","blob","onerror","e","createImageThumbnail","size","img","Image","onload","ratio","Math","round","dataUrl","toDataURL","onFileChange","files","target","Array","from","forEach","startsWith","previews","thumbs","f","push","type","thumb","err","submitting","setSubmitting","submitError","setSubmitError","successMessage","setSuccessMessage","abortControllerRef","abort","onSubmit","fields","_fields$name","_fields$location","name","trim","href","formData","FormData","append","breed","color","age","undefined","String","description","idx","Object","fromEntries","entries","substring","AbortController","headers","error","resp","fetch","method","body","signal","catch","firstError","message","fallbackUrls","fallbackUrl","fallbackResp","fallbackError","ok","errMsg","status","statusText","json","JSON","stringify","txt","text","setTimeout","errorMessage","children","fileName","_jsxFileName","lineNumber","columnNumber","id","htmlFor","autoComplete","placeholder","required","className","role","step","valueAsNumber","accept","multiple","onChange","style","display","flexWrap","gap","margin","map","alt","objectFit","borderRadius","border","rows","cols","value","disabled","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface AddDogFormData {\n  name: string;\n  breed: string;\n  color?: string;\n  location: string;\n  age: number;\n  description: string;\n  size: 'small' | 'medium' | 'large';\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n}\n\n// Simple, reliable API URL for mobile\nconst API_URL = process.env.REACT_APP_API_URL ||\n  (window.location.protocol === 'https:'\n    ? `https://${window.location.hostname}`\n    : (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'\n      ? 'http://localhost:3001'\n      : 'http://172.20.10.2:3001'));\n\nconst AdddogForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { token, isAuthenticated } = useAuth();\n  const { register, handleSubmit, formState: { errors } } = useForm<AddDogFormData>({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false,\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', { isAuthenticated, hasToken: !!token, tokenLength: token?.length });\n    \n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  const [mediaFiles, setMediaFiles] = useState<File[]>([]);\n  const [mediaPreviews, setMediaPreviews] = useState<string[]>([]);\n  const [smallPreviews, setSmallPreviews] = useState<string[]>([]);\n  const [isVideo, setIsVideo] = useState(false); // Only for single video, not for images\n  const [posterBlob, setPosterBlob] = useState<Blob | null>(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = (file: File): Promise<Blob> => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob((blob) => {\n          cleanup();\n          if (blob) resolve(blob);\n          else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = (e) => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file: File, size = 64): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = (e) => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  const onFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files ? Array.from(e.target.files) : [];\n    if (!files.length) return;\n    setMediaFiles(files);\n\n    // Clean up previous previews\n    mediaPreviews.forEach(url => { if (url.startsWith('blob:')) URL.revokeObjectURL(url); });\n    setMediaPreviews([]);\n    setSmallPreviews([]);\n\n    const previews: string[] = [];\n    const thumbs: string[] = [];\n    for (const f of files) {\n      const url = URL.createObjectURL(f);\n      previews.push(url);\n      if (f.type.startsWith('image/')) {\n        try {\n          const thumb = await createImageThumbnail(f, 64);\n          thumbs.push(thumb);\n        } catch (err) {\n          thumbs.push('');\n        }\n      } else {\n        thumbs.push('');\n      }\n    }\n    setMediaPreviews(previews);\n    setSmallPreviews(thumbs);\n    setIsVideo(files.length === 1 && files[0].type.startsWith('video/'));\n    // Poster logic for video can be added if needed\n  };\n\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n\n  const onSubmit: SubmitHandler<AddDogFormData> = async (fields) => {\n    console.log('Form submit triggered with fields:', fields);\n    \n    // Basic validation\n    if (!fields.name?.trim()) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!fields.location?.trim()) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    \n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n\n      if (mediaFiles.length) {\n        mediaFiles.forEach((file, idx) => {\n          formData.append('media', file, file.name);\n        });\n        // Poster logic for video can be added here if needed\n      }\n\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media files present:', mediaFiles.length);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      \n      abortControllerRef.current = new AbortController();\n      \n      const headers: any = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      \n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      }).catch(async (firstError) => {\n        // If initial fetch fails on mobile, try fallback URLs\n        console.warn('First fetch failed, trying fallback:', firstError.message);\n        \n        const fallbackUrls = [\n          'http://172.20.10.2:3001/api/dogs',  // Direct IP\n          'http://localhost:3001/api/dogs'      // Localhost fallback\n        ];\n        \n        for (const fallbackUrl of fallbackUrls) {\n          try {\n            console.log('Trying fallback URL:', fallbackUrl);\n            const fallbackResp = await fetch(fallbackUrl, {\n              method: 'POST',\n              body: formData,\n              signal: abortControllerRef.current.signal,\n              headers\n            });\n            console.log('Fallback succeeded:', fallbackUrl);\n            return fallbackResp;\n          } catch (fallbackError) {\n            console.warn('Fallback failed:', fallbackUrl, fallbackError.message);\n          }\n        }\n        \n        // If all fallbacks fail, throw the original error\n        throw firstError;\n      });\n\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => { \n          if (isMountedRef.current) navigate('/psi'); \n        }, 1400);\n      }\n    } catch (err: any) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      \n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      \n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      \n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n\n  return (\n    <main>\n      <h2>{t('adddog.title')}</h2>\n      <form id=\"adddog-form\" onSubmit={handleSubmit(onSubmit)}>\n        <label htmlFor=\"adddog-name\">{t('adddog.name')}</label>\n        <input type=\"text\" id=\"adddog-name\" name=\"name\" autoComplete=\"name\" placeholder={t('adddog.name')} {...register('name', { required: true })} />\n        {errors.name && <div className=\"error\" role=\"alert\">{t('adddog.name')} is required</div> }\n\n        <label htmlFor=\"adddog-breed\">{t('adddog.breed')}</label>\n        <input type=\"text\" id=\"adddog-breed\" name=\"breed\" autoComplete=\"off\" placeholder={t('adddog.breed')} {...register('breed')} />\n\n        <label htmlFor=\"adddog-color\">{t('adddog.color')}</label>\n        <input type=\"text\" id=\"adddog-color\" name=\"color\" autoComplete=\"off\" placeholder={t('adddog.color')} {...register('color')} />\n\n        <label htmlFor=\"adddog-location\">{t('adddog.location')}</label>\n        <input type=\"text\" id=\"adddog-location\" name=\"location\" autoComplete=\"address-level2\" placeholder={t('adddog.location')} {...register('location', { required: true })} />\n\n        <label htmlFor=\"adddog-age\">{t('adddog.age')}</label>\n        <small>{t('adddogExtra.ageNote')}</small>\n        <input type=\"number\" id=\"adddog-age\" name=\"age\" autoComplete=\"off\" placeholder={t('adddog.age')} step=\"0.1\" {...register('age', { valueAsNumber: true })} />\n\n        <label htmlFor=\"adddog-media\">{t('adddog.photos')}</label>\n        <input type=\"file\" id=\"adddog-media\" name=\"media\" accept=\"image/*,video/*\" multiple onChange={onFileChange} />\n        <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, margin: '8px 0' }}>\n          {mediaPreviews.map((url, idx) => (\n            <img key={url} src={url} alt={`preview-${idx}`} style={{ width: 64, height: 64, objectFit: 'cover', borderRadius: 8, border: '1px solid #ccc' }} />\n          ))}\n        </div>\n\n        <label htmlFor=\"adddog-description\">{t('adddog.description')}</label>\n        <textarea id=\"adddog-description\" name=\"description\" rows={3} cols={30} autoComplete=\"off\" placeholder={t('adddog.description')} {...register('description')} />\n\n        <label htmlFor=\"adddog-size\">{t('adddog.size')}</label>\n        <select {...register('size')} id=\"adddog-size\" name=\"size\" autoComplete=\"off\">\n          <option value=\"small\">{t('size.small')}</option>\n          <option value=\"medium\">{t('size.medium')}</option>\n          <option value=\"large\">{t('size.large')}</option>\n        </select>\n\n        <div id=\"gender\">\n          <label>{t('adddog.gender')}</label>\n          <div className=\"gender-options\">\n            <label htmlFor=\"adddog-gender-male\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-male\" name=\"gender\" value=\"male\" />\n              <span>{t('gender.male')}</span>\n            </label>\n            <label htmlFor=\"adddog-gender-female\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-female\" name=\"gender\" value=\"female\" />\n              <span>{t('gender.female')}</span>\n            </label>\n          </div>\n        </div>\n\n        <div id=\"health\">\n          <label htmlFor=\"adddog-vaccinated\">\n            <span>{t('adddog.vaccinated')}</span>\n            <input type=\"checkbox\" {...register('vaccinated')} id=\"adddog-vaccinated\" name=\"vaccinated\" />\n          </label>\n\n          <label htmlFor=\"adddog-neutered\">\n            <span>{t('adddog.neutered')}</span>\n            <input type=\"checkbox\" {...register('neutered')} id=\"adddog-neutered\" name=\"neutered\" />\n          </label>\n        </div>\n\n        <div id=\"media-upload\">\n          <label htmlFor=\"adddog-media\">{t('adddog.photos')}</label>\n          <input type=\"file\" id=\"adddog-media\" name=\"media\" accept=\"image/*,video/*\" multiple onChange={onFileChange} />\n          <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, margin: '8px 0' }}>\n            {mediaPreviews.map((url, idx) => (\n              <img key={url} src={smallPreviews[idx] || url} alt={`preview-${idx}`} style={{ width: 64, height: 64, objectFit: 'cover', borderRadius: 8, border: '1px solid #ccc' }} />\n            ))}\n          </div>\n        </div>\n\n        <div className=\"form-actions\">\n          <button type=\"submit\" disabled={submitting}>{submitting ? t('adddog.saving') : t('button.addDog')}</button>\n          {submitError && <div className=\"error\" role=\"alert\">{submitError}</div>}\n          {successMessage && <div className=\"notification success\" role=\"status\">{successMessage}</div>}\n        </div>\n      </form>\n    </main>\n  );\n};\n\nexport default AdddogForm;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,OAAO,QAAuB,iBAAiB;AACxD,SAASC,cAAc,QAAQ,eAAe;AAC9C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,OAAO,QAAQ,4BAA4B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAerD;AACA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,KAC1CC,MAAM,CAACC,QAAQ,CAACC,QAAQ,KAAK,QAAQ,GAClC,WAAWF,MAAM,CAACC,QAAQ,CAACE,QAAQ,EAAE,GACpCH,MAAM,CAACC,QAAQ,CAACE,QAAQ,KAAK,WAAW,IAAIH,MAAM,CAACC,QAAQ,CAACE,QAAQ,KAAK,WAAW,GACnF,uBAAuB,GACvB,yBAA0B,CAAC;AAEnC,MAAMC,UAAoB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACjC,MAAM;IAAEC;EAAE,CAAC,GAAGf,cAAc,CAAC,CAAC;EAC9B,MAAM;IAAEgB,KAAK;IAAEC;EAAgB,CAAC,GAAGf,OAAO,CAAC,CAAC;EAC5C,MAAM;IAAEgB,QAAQ;IAAEC,YAAY;IAAEC,SAAS,EAAE;MAAEC;IAAO;EAAE,CAAC,GAAGtB,OAAO,CAAiB;IAChFuB,aAAa,EAAE;MACbC,UAAU,EAAE,KAAK;MACjBC,QAAQ,EAAE;IACZ;EACF,CAAC,CAAC;EACF,MAAMC,QAAQ,GAAGxB,WAAW,CAAC,CAAC;EAC9B,MAAMyB,YAAY,GAAG5B,MAAM,CAAC,IAAI,CAAC;EAEjCD,SAAS,CAAC,MAAM;IACd8B,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAE;MAAEX,eAAe;MAAEY,QAAQ,EAAE,CAAC,CAACb,KAAK;MAAEc,WAAW,EAAEd,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEe;IAAO,CAAC,CAAC;IAE5G,IAAI,CAACd,eAAe,IAAI,CAACD,KAAK,EAAE;MAC9BW,OAAO,CAACK,IAAI,CAAC,iDAAiD,CAAC;MAC/DP,QAAQ,CAAC,YAAY,CAAC;IACxB;EACF,CAAC,EAAE,CAACR,eAAe,EAAED,KAAK,EAAES,QAAQ,CAAC,CAAC;EAEtC5B,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACX6B,YAAY,CAACO,OAAO,GAAG,KAAK;IAC9B,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGvC,QAAQ,CAAS,EAAE,CAAC;EACxD,MAAM,CAACwC,aAAa,EAAEC,gBAAgB,CAAC,GAAGzC,QAAQ,CAAW,EAAE,CAAC;EAChE,MAAM,CAAC0C,aAAa,EAAEC,gBAAgB,CAAC,GAAG3C,QAAQ,CAAW,EAAE,CAAC;EAChE,MAAM,CAAC4C,OAAO,EAAEC,UAAU,CAAC,GAAG7C,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;EAC/C,MAAM,CAAC8C,UAAU,EAAEC,aAAa,CAAC,GAAG/C,QAAQ,CAAc,IAAI,CAAC;;EAE/D;EACA,MAAMgD,iBAAiB,GAAIC,IAAU,IAAoB;IACvD,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,MAAMC,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC;MACrC,MAAMO,KAAK,GAAGC,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC;MAC7CF,KAAK,CAACG,OAAO,GAAG,UAAU;MAC1BH,KAAK,CAACI,KAAK,GAAG,IAAI;MAClBJ,KAAK,CAACK,GAAG,GAAGR,GAAG;MACf;MACAG,KAAK,CAACM,WAAW,GAAG,CAAC;MACrB,MAAMC,OAAO,GAAGA,CAAA,KAAMT,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC;MAE9CG,KAAK,CAACS,YAAY,GAAG,YAAY;QAC/B,MAAMC,MAAM,GAAGT,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;QAC/CQ,MAAM,CAACC,KAAK,GAAGX,KAAK,CAACY,UAAU,IAAI,GAAG;QACtCF,MAAM,CAACG,MAAM,GAAGb,KAAK,CAACc,WAAW,IAAI,GAAG;QACxC,MAAMC,GAAG,GAAGL,MAAM,CAACM,UAAU,CAAC,IAAI,CAAC;QACnC,IAAI,CAACD,GAAG,EAAE,OAAOnB,MAAM,CAAC,IAAIqB,KAAK,CAAC,sBAAsB,CAAC,CAAC;QAC1DF,GAAG,CAACG,SAAS,CAAClB,KAAK,EAAE,CAAC,EAAE,CAAC,EAAEU,MAAM,CAACC,KAAK,EAAED,MAAM,CAACG,MAAM,CAAC;QACvDH,MAAM,CAACS,MAAM,CAAEC,IAAI,IAAK;UACtBb,OAAO,CAAC,CAAC;UACT,IAAIa,IAAI,EAAEzB,OAAO,CAACyB,IAAI,CAAC,CAAC,KACnBxB,MAAM,CAAC,IAAIqB,KAAK,CAAC,yBAAyB,CAAC,CAAC;QACnD,CAAC,EAAE,YAAY,EAAE,GAAG,CAAC;MACvB,CAAC;MACDjB,KAAK,CAACqB,OAAO,GAAIC,CAAC,IAAK;QACrBf,OAAO,CAAC,CAAC;QACTX,MAAM,CAAC0B,CAAC,CAAC;MACX,CAAC;IACH,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMC,oBAAoB,GAAGA,CAAC9B,IAAU,EAAE+B,IAAI,GAAG,EAAE,KAAsB;IACvE,OAAO,IAAI9B,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,MAAM6B,GAAG,GAAG,IAAIC,KAAK,CAAC,CAAC;MACvB,MAAM7B,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC;MACrCgC,GAAG,CAACE,MAAM,GAAG,MAAM;QACjB,MAAMC,KAAK,GAAGH,GAAG,CAACd,KAAK,GAAGc,GAAG,CAACZ,MAAM,IAAI,CAAC;QACzC,IAAIF,KAAK,GAAGa,IAAI;QAChB,IAAIX,MAAM,GAAGgB,IAAI,CAACC,KAAK,CAACN,IAAI,GAAGI,KAAK,CAAC;QACrC,IAAIA,KAAK,GAAG,CAAC,EAAE;UACb;UACAf,MAAM,GAAGW,IAAI;UACbb,KAAK,GAAGkB,IAAI,CAACC,KAAK,CAACN,IAAI,GAAGI,KAAK,CAAC;QAClC;QACA,MAAMlB,MAAM,GAAGT,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;QAC/CQ,MAAM,CAACC,KAAK,GAAGA,KAAK;QACpBD,MAAM,CAACG,MAAM,GAAGA,MAAM;QACtB,MAAME,GAAG,GAAGL,MAAM,CAACM,UAAU,CAAC,IAAI,CAAC;QACnC,IAAI,CAACD,GAAG,EAAE;UACRjB,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC;UACxB,OAAOD,MAAM,CAAC,IAAIqB,KAAK,CAAC,sBAAsB,CAAC,CAAC;QAClD;QACAF,GAAG,CAACG,SAAS,CAACO,GAAG,EAAE,CAAC,EAAE,CAAC,EAAEd,KAAK,EAAEE,MAAM,CAAC;QACvC,MAAMkB,OAAO,GAAGrB,MAAM,CAACsB,SAAS,CAAC,YAAY,EAAE,GAAG,CAAC;QACnDlC,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC;QACxBF,OAAO,CAACoC,OAAO,CAAC;MAClB,CAAC;MACDN,GAAG,CAACJ,OAAO,GAAIC,CAAC,IAAK;QACnBxB,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC;QACxBD,MAAM,CAAC0B,CAAC,CAAC;MACX,CAAC;MACDG,GAAG,CAACpB,GAAG,GAAGR,GAAG;IACf,CAAC,CAAC;EACJ,CAAC;EAED,MAAMoC,YAAY,GAAG,MAAOX,CAAsC,IAAK;IACrE,MAAMY,KAAK,GAAGZ,CAAC,CAACa,MAAM,CAACD,KAAK,GAAGE,KAAK,CAACC,IAAI,CAACf,CAAC,CAACa,MAAM,CAACD,KAAK,CAAC,GAAG,EAAE;IAC9D,IAAI,CAACA,KAAK,CAACvD,MAAM,EAAE;IACnBI,aAAa,CAACmD,KAAK,CAAC;;IAEpB;IACAlD,aAAa,CAACsD,OAAO,CAACzC,GAAG,IAAI;MAAE,IAAIA,GAAG,CAAC0C,UAAU,CAAC,OAAO,CAAC,EAAEzC,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC;IAAE,CAAC,CAAC;IACxFZ,gBAAgB,CAAC,EAAE,CAAC;IACpBE,gBAAgB,CAAC,EAAE,CAAC;IAEpB,MAAMqD,QAAkB,GAAG,EAAE;IAC7B,MAAMC,MAAgB,GAAG,EAAE;IAC3B,KAAK,MAAMC,CAAC,IAAIR,KAAK,EAAE;MACrB,MAAMrC,GAAG,GAAGC,GAAG,CAACC,eAAe,CAAC2C,CAAC,CAAC;MAClCF,QAAQ,CAACG,IAAI,CAAC9C,GAAG,CAAC;MAClB,IAAI6C,CAAC,CAACE,IAAI,CAACL,UAAU,CAAC,QAAQ,CAAC,EAAE;QAC/B,IAAI;UACF,MAAMM,KAAK,GAAG,MAAMtB,oBAAoB,CAACmB,CAAC,EAAE,EAAE,CAAC;UAC/CD,MAAM,CAACE,IAAI,CAACE,KAAK,CAAC;QACpB,CAAC,CAAC,OAAOC,GAAG,EAAE;UACZL,MAAM,CAACE,IAAI,CAAC,EAAE,CAAC;QACjB;MACF,CAAC,MAAM;QACLF,MAAM,CAACE,IAAI,CAAC,EAAE,CAAC;MACjB;IACF;IACA1D,gBAAgB,CAACuD,QAAQ,CAAC;IAC1BrD,gBAAgB,CAACsD,MAAM,CAAC;IACxBpD,UAAU,CAAC6C,KAAK,CAACvD,MAAM,KAAK,CAAC,IAAIuD,KAAK,CAAC,CAAC,CAAC,CAACU,IAAI,CAACL,UAAU,CAAC,QAAQ,CAAC,CAAC;IACpE;EACF,CAAC;EAED,MAAM,CAACQ,UAAU,EAAEC,aAAa,CAAC,GAAGxG,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAACyG,WAAW,EAAEC,cAAc,CAAC,GAAG1G,QAAQ,CAAgB,IAAI,CAAC;EACnE,MAAM,CAAC2G,cAAc,EAAEC,iBAAiB,CAAC,GAAG5G,QAAQ,CAAgB,IAAI,CAAC;EACzE,MAAM6G,kBAAkB,GAAG3G,MAAM,CAAyB,IAAI,CAAC;EAE/DD,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACX6B,YAAY,CAACO,OAAO,GAAG,KAAK;MAC5B;MACA,IAAIwE,kBAAkB,CAACxE,OAAO,EAAE;QAC9BwE,kBAAkB,CAACxE,OAAO,CAACyE,KAAK,CAAC,CAAC;MACpC;IACF,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,QAAuC,GAAG,MAAOC,MAAM,IAAK;IAAA,IAAAC,YAAA,EAAAC,gBAAA;IAChEnF,OAAO,CAACC,GAAG,CAAC,oCAAoC,EAAEgF,MAAM,CAAC;;IAEzD;IACA,IAAI,GAAAC,YAAA,GAACD,MAAM,CAACG,IAAI,cAAAF,YAAA,eAAXA,YAAA,CAAaG,IAAI,CAAC,CAAC,GAAE;MACxBV,cAAc,CAACvF,CAAC,CAAC,qBAAqB,CAAC,CAAC;MACxC;IACF;IACA,IAAI,GAAA+F,gBAAA,GAACF,MAAM,CAAClG,QAAQ,cAAAoG,gBAAA,eAAfA,gBAAA,CAAiBE,IAAI,CAAC,CAAC,GAAE;MAC5BV,cAAc,CAACvF,CAAC,CAAC,yBAAyB,CAAC,CAAC;MAC5C;IACF;IAEA,IAAI;MACFqF,aAAa,CAAC,IAAI,CAAC;MACnBE,cAAc,CAAC,IAAI,CAAC;MAEpB3E,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEvB,OAAO,CAAC;MAClDsB,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEnB,MAAM,CAACC,QAAQ,CAACE,QAAQ,CAAC;MAC1De,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEnB,MAAM,CAACC,QAAQ,CAACuG,IAAI,CAAC;MAErD,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAER,MAAM,CAACG,IAAI,CAAC;MACpC,IAAIH,MAAM,CAACS,KAAK,EAAEH,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAER,MAAM,CAACS,KAAK,CAAC;MACxD,IAAIT,MAAM,CAACU,KAAK,EAAEJ,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAER,MAAM,CAACU,KAAK,CAAC;MACxD,IAAIV,MAAM,CAACW,GAAG,KAAKC,SAAS,EAAEN,QAAQ,CAACE,MAAM,CAAC,KAAK,EAAEK,MAAM,CAACb,MAAM,CAACW,GAAG,CAAC,CAAC;MACxE,IAAIX,MAAM,CAACc,WAAW,EAAER,QAAQ,CAACE,MAAM,CAAC,aAAa,EAAER,MAAM,CAACc,WAAW,CAAC;MAC1E,IAAId,MAAM,CAAChC,IAAI,EAAEsC,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAER,MAAM,CAAChC,IAAI,CAAC;MACrD,IAAIgC,MAAM,CAAClG,QAAQ,EAAEwG,QAAQ,CAACE,MAAM,CAAC,UAAU,EAAER,MAAM,CAAClG,QAAQ,CAAC;;MAEjE;MACAwG,QAAQ,CAACE,MAAM,CAAC,YAAY,EAAER,MAAM,CAACrF,UAAU,GAAG,MAAM,GAAG,OAAO,CAAC;MACnE2F,QAAQ,CAACE,MAAM,CAAC,UAAU,EAAER,MAAM,CAACpF,QAAQ,GAAG,MAAM,GAAG,OAAO,CAAC;MAE/D,IAAIU,UAAU,CAACH,MAAM,EAAE;QACrBG,UAAU,CAACwD,OAAO,CAAC,CAAC7C,IAAI,EAAE8E,GAAG,KAAK;UAChCT,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEvE,IAAI,EAAEA,IAAI,CAACkE,IAAI,CAAC;QAC3C,CAAC,CAAC;QACF;MACF;MAEApF,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAE,GAAGvB,OAAO,WAAW,CAAC;MACpDsB,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEgG,MAAM,CAACC,WAAW,CAACX,QAAQ,CAACY,OAAO,CAAC,CAAC,CAAC,CAAC;MACxEnG,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEM,UAAU,CAACH,MAAM,CAAC;MACtDJ,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAE,CAAC,CAACZ,KAAK,CAAC;MACzCW,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEZ,KAAK,GAAG,GAAGA,KAAK,CAAC+G,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,KAAK,GAAG,UAAU,CAAC;MAEnFtB,kBAAkB,CAACxE,OAAO,GAAG,IAAI+F,eAAe,CAAC,CAAC;MAElD,MAAMC,OAAY,GAAG;QACnB;MAAA,CACD;MAED,IAAIjH,KAAK,EAAE;QACTiH,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUjH,KAAK,EAAE;QAC5CW,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;MAC3C,CAAC,MAAM;QACLD,OAAO,CAACuG,KAAK,CAAC,2CAA2C,CAAC;MAC5D;MAEA,MAAMC,IAAI,GAAG,MAAMC,KAAK,CAAC,GAAG/H,OAAO,WAAW,EAAE;QAC9CgI,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEpB,QAAQ;QACdqB,MAAM,EAAE9B,kBAAkB,CAACxE,OAAO,CAACsG,MAAM;QACzCN;MACF,CAAC,CAAC,CAACO,KAAK,CAAC,MAAOC,UAAU,IAAK;QAC7B;QACA9G,OAAO,CAACK,IAAI,CAAC,sCAAsC,EAAEyG,UAAU,CAACC,OAAO,CAAC;QAExE,MAAMC,YAAY,GAAG,CACnB,kCAAkC;QAAG;QACrC,gCAAgC,CAAM;QAAA,CACvC;QAED,KAAK,MAAMC,WAAW,IAAID,YAAY,EAAE;UACtC,IAAI;YACFhH,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEgH,WAAW,CAAC;YAChD,MAAMC,YAAY,GAAG,MAAMT,KAAK,CAACQ,WAAW,EAAE;cAC5CP,MAAM,EAAE,MAAM;cACdC,IAAI,EAAEpB,QAAQ;cACdqB,MAAM,EAAE9B,kBAAkB,CAACxE,OAAO,CAACsG,MAAM;cACzCN;YACF,CAAC,CAAC;YACFtG,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEgH,WAAW,CAAC;YAC/C,OAAOC,YAAY;UACrB,CAAC,CAAC,OAAOC,aAAa,EAAE;YACtBnH,OAAO,CAACK,IAAI,CAAC,kBAAkB,EAAE4G,WAAW,EAAEE,aAAa,CAACJ,OAAO,CAAC;UACtE;QACF;;QAEA;QACA,MAAMD,UAAU;MAClB,CAAC,CAAC;MAEF,IAAI,CAACN,IAAI,CAACY,EAAE,EAAE;QACZ;QACA,IAAIC,MAAM,GAAG,6BAA6Bb,IAAI,CAACc,MAAM,KAAKd,IAAI,CAACe,UAAU,GAAG;QAC5EvH,OAAO,CAACuG,KAAK,CAAC,kBAAkB,EAAEC,IAAI,CAACc,MAAM,EAAEd,IAAI,CAACe,UAAU,CAAC;QAC/D,IAAI;UACF,MAAMZ,IAAI,GAAG,MAAMH,IAAI,CAACgB,IAAI,CAAC,CAAC;UAC9BxH,OAAO,CAACuG,KAAK,CAAC,aAAa,EAAEI,IAAI,CAAC;UAClCU,MAAM,GAAGV,IAAI,CAACI,OAAO,IAAIU,IAAI,CAACC,SAAS,CAACf,IAAI,CAAC;QAC/C,CAAC,CAAC,OAAO5D,CAAC,EAAE;UACV/C,OAAO,CAACuG,KAAK,CAAC,gCAAgC,EAAExD,CAAC,CAAC;UAClD,MAAM4E,GAAG,GAAG,MAAMnB,IAAI,CAACoB,IAAI,CAAC,CAAC;UAC7B5H,OAAO,CAACuG,KAAK,CAAC,aAAa,EAAEoB,GAAG,CAAC;UACjC,IAAIA,GAAG,EAAEN,MAAM,GAAGM,GAAG,CAACvB,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;QAC3C;QACApG,OAAO,CAACuG,KAAK,CAAC,YAAY,EAAEc,MAAM,CAAC;QACnC1C,cAAc,CAAC0C,MAAM,CAAC;QACtB,MAAM,IAAI3E,KAAK,CAAC2E,MAAM,CAAC;MACzB;;MAEA;MACA,IAAItH,YAAY,CAACO,OAAO,EAAE;QACxBuE,iBAAiB,CAACzF,CAAC,CAAC,cAAc,CAAC,CAAC;QACpC;QACAyI,UAAU,CAAC,MAAM;UACf,IAAI9H,YAAY,CAACO,OAAO,EAAER,QAAQ,CAAC,MAAM,CAAC;QAC5C,CAAC,EAAE,IAAI,CAAC;MACV;IACF,CAAC,CAAC,OAAOyE,GAAQ,EAAE;MACjB;MACA,IAAIA,GAAG,CAACa,IAAI,KAAK,YAAY,EAAE;QAC7BpF,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC;QACxD;MACF;MAEAD,OAAO,CAACuG,KAAK,CAAC,iBAAiB,EAAEhC,GAAG,CAAC;MACrCvE,OAAO,CAACuG,KAAK,CAAC,aAAa,EAAEhC,GAAG,CAACa,IAAI,CAAC;MACtCpF,OAAO,CAACuG,KAAK,CAAC,gBAAgB,EAAEhC,GAAG,CAACwC,OAAO,CAAC;MAC5C/G,OAAO,CAACuG,KAAK,CAAC,aAAa,EAAEhC,GAAG,CAAC;MAEjC,IAAIuD,YAAY,GAAG1I,CAAC,CAAC,eAAe,CAAC;MACrC,IAAImF,GAAG,CAACwC,OAAO,EAAE;QACfe,YAAY,IAAI,KAAKvD,GAAG,CAACwC,OAAO,EAAE;MACpC;MAEA,IAAIhH,YAAY,CAACO,OAAO,IAAI,CAACoE,WAAW,EAAE;QACxCC,cAAc,CAACmD,YAAY,CAAC;MAC9B;IACF,CAAC,SAAS;MACR,IAAI/H,YAAY,CAACO,OAAO,EAAEmE,aAAa,CAAC,KAAK,CAAC;IAChD;EACF,CAAC;EAED,oBACEhG,OAAA;IAAAsJ,QAAA,gBACEtJ,OAAA;MAAAsJ,QAAA,EAAK3I,CAAC,CAAC,cAAc;IAAC;MAAA4I,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,eAC5B1J,OAAA;MAAM2J,EAAE,EAAC,aAAa;MAACpD,QAAQ,EAAExF,YAAY,CAACwF,QAAQ,CAAE;MAAA+C,QAAA,gBACtDtJ,OAAA;QAAO4J,OAAO,EAAC,aAAa;QAAAN,QAAA,EAAE3I,CAAC,CAAC,aAAa;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACvD1J,OAAA;QAAO4F,IAAI,EAAC,MAAM;QAAC+D,EAAE,EAAC,aAAa;QAAChD,IAAI,EAAC,MAAM;QAACkD,YAAY,EAAC,MAAM;QAACC,WAAW,EAAEnJ,CAAC,CAAC,aAAa,CAAE;QAAA,GAAKG,QAAQ,CAAC,MAAM,EAAE;UAAEiJ,QAAQ,EAAE;QAAK,CAAC;MAAC;QAAAR,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,EAC9IzI,MAAM,CAAC0F,IAAI,iBAAI3G,OAAA;QAAKgK,SAAS,EAAC,OAAO;QAACC,IAAI,EAAC,OAAO;QAAAX,QAAA,GAAE3I,CAAC,CAAC,aAAa,CAAC,EAAC,cAAY;MAAA;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAExF1J,OAAA;QAAO4J,OAAO,EAAC,cAAc;QAAAN,QAAA,EAAE3I,CAAC,CAAC,cAAc;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACzD1J,OAAA;QAAO4F,IAAI,EAAC,MAAM;QAAC+D,EAAE,EAAC,cAAc;QAAChD,IAAI,EAAC,OAAO;QAACkD,YAAY,EAAC,KAAK;QAACC,WAAW,EAAEnJ,CAAC,CAAC,cAAc,CAAE;QAAA,GAAKG,QAAQ,CAAC,OAAO;MAAC;QAAAyI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAE9H1J,OAAA;QAAO4J,OAAO,EAAC,cAAc;QAAAN,QAAA,EAAE3I,CAAC,CAAC,cAAc;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACzD1J,OAAA;QAAO4F,IAAI,EAAC,MAAM;QAAC+D,EAAE,EAAC,cAAc;QAAChD,IAAI,EAAC,OAAO;QAACkD,YAAY,EAAC,KAAK;QAACC,WAAW,EAAEnJ,CAAC,CAAC,cAAc,CAAE;QAAA,GAAKG,QAAQ,CAAC,OAAO;MAAC;QAAAyI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAE9H1J,OAAA;QAAO4J,OAAO,EAAC,iBAAiB;QAAAN,QAAA,EAAE3I,CAAC,CAAC,iBAAiB;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eAC/D1J,OAAA;QAAO4F,IAAI,EAAC,MAAM;QAAC+D,EAAE,EAAC,iBAAiB;QAAChD,IAAI,EAAC,UAAU;QAACkD,YAAY,EAAC,gBAAgB;QAACC,WAAW,EAAEnJ,CAAC,CAAC,iBAAiB,CAAE;QAAA,GAAKG,QAAQ,CAAC,UAAU,EAAE;UAAEiJ,QAAQ,EAAE;QAAK,CAAC;MAAC;QAAAR,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAEzK1J,OAAA;QAAO4J,OAAO,EAAC,YAAY;QAAAN,QAAA,EAAE3I,CAAC,CAAC,YAAY;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACrD1J,OAAA;QAAAsJ,QAAA,EAAQ3I,CAAC,CAAC,qBAAqB;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACzC1J,OAAA;QAAO4F,IAAI,EAAC,QAAQ;QAAC+D,EAAE,EAAC,YAAY;QAAChD,IAAI,EAAC,KAAK;QAACkD,YAAY,EAAC,KAAK;QAACC,WAAW,EAAEnJ,CAAC,CAAC,YAAY,CAAE;QAACuJ,IAAI,EAAC,KAAK;QAAA,GAAKpJ,QAAQ,CAAC,KAAK,EAAE;UAAEqJ,aAAa,EAAE;QAAK,CAAC;MAAC;QAAAZ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAE5J1J,OAAA;QAAO4J,OAAO,EAAC,cAAc;QAAAN,QAAA,EAAE3I,CAAC,CAAC,eAAe;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eAC1D1J,OAAA;QAAO4F,IAAI,EAAC,MAAM;QAAC+D,EAAE,EAAC,cAAc;QAAChD,IAAI,EAAC,OAAO;QAACyD,MAAM,EAAC,iBAAiB;QAACC,QAAQ;QAACC,QAAQ,EAAErF;MAAa;QAAAsE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC9G1J,OAAA;QAAKuK,KAAK,EAAE;UAAEC,OAAO,EAAE,MAAM;UAAEC,QAAQ,EAAE,MAAM;UAAEC,GAAG,EAAE,CAAC;UAAEC,MAAM,EAAE;QAAQ,CAAE;QAAArB,QAAA,EACxEtH,aAAa,CAAC4I,GAAG,CAAC,CAAC/H,GAAG,EAAE0E,GAAG,kBAC1BvH,OAAA;UAAeqD,GAAG,EAAER,GAAI;UAACgI,GAAG,EAAE,WAAWtD,GAAG,EAAG;UAACgD,KAAK,EAAE;YAAE5G,KAAK,EAAE,EAAE;YAAEE,MAAM,EAAE,EAAE;YAAEiH,SAAS,EAAE,OAAO;YAAEC,YAAY,EAAE,CAAC;YAAEC,MAAM,EAAE;UAAiB;QAAE,GAAtInI,GAAG;UAAA0G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAqI,CACnJ;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eAEN1J,OAAA;QAAO4J,OAAO,EAAC,oBAAoB;QAAAN,QAAA,EAAE3I,CAAC,CAAC,oBAAoB;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACrE1J,OAAA;QAAU2J,EAAE,EAAC,oBAAoB;QAAChD,IAAI,EAAC,aAAa;QAACsE,IAAI,EAAE,CAAE;QAACC,IAAI,EAAE,EAAG;QAACrB,YAAY,EAAC,KAAK;QAACC,WAAW,EAAEnJ,CAAC,CAAC,oBAAoB,CAAE;QAAA,GAAKG,QAAQ,CAAC,aAAa;MAAC;QAAAyI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eAEhK1J,OAAA;QAAO4J,OAAO,EAAC,aAAa;QAAAN,QAAA,EAAE3I,CAAC,CAAC,aAAa;MAAC;QAAA4I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACvD1J,OAAA;QAAA,GAAYc,QAAQ,CAAC,MAAM,CAAC;QAAE6I,EAAE,EAAC,aAAa;QAAChD,IAAI,EAAC,MAAM;QAACkD,YAAY,EAAC,KAAK;QAAAP,QAAA,gBAC3EtJ,OAAA;UAAQmL,KAAK,EAAC,OAAO;UAAA7B,QAAA,EAAE3I,CAAC,CAAC,YAAY;QAAC;UAAA4I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAS,CAAC,eAChD1J,OAAA;UAAQmL,KAAK,EAAC,QAAQ;UAAA7B,QAAA,EAAE3I,CAAC,CAAC,aAAa;QAAC;UAAA4I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAS,CAAC,eAClD1J,OAAA;UAAQmL,KAAK,EAAC,OAAO;UAAA7B,QAAA,EAAE3I,CAAC,CAAC,YAAY;QAAC;UAAA4I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAS,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC1C,CAAC,eAET1J,OAAA;QAAK2J,EAAE,EAAC,QAAQ;QAAAL,QAAA,gBACdtJ,OAAA;UAAAsJ,QAAA,EAAQ3I,CAAC,CAAC,eAAe;QAAC;UAAA4I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACnC1J,OAAA;UAAKgK,SAAS,EAAC,gBAAgB;UAAAV,QAAA,gBAC7BtJ,OAAA;YAAO4J,OAAO,EAAC,oBAAoB;YAAAN,QAAA,gBACjCtJ,OAAA;cAAO4F,IAAI,EAAC,OAAO;cAAA,GAAK9E,QAAQ,CAAC,QAAQ,CAAC;cAAE6I,EAAE,EAAC,oBAAoB;cAAChD,IAAI,EAAC,QAAQ;cAACwE,KAAK,EAAC;YAAM;cAAA5B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACjG1J,OAAA;cAAAsJ,QAAA,EAAO3I,CAAC,CAAC,aAAa;YAAC;cAAA4I,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1B,CAAC,eACR1J,OAAA;YAAO4J,OAAO,EAAC,sBAAsB;YAAAN,QAAA,gBACnCtJ,OAAA;cAAO4F,IAAI,EAAC,OAAO;cAAA,GAAK9E,QAAQ,CAAC,QAAQ,CAAC;cAAE6I,EAAE,EAAC,sBAAsB;cAAChD,IAAI,EAAC,QAAQ;cAACwE,KAAK,EAAC;YAAQ;cAAA5B,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eACrG1J,OAAA;cAAAsJ,QAAA,EAAO3I,CAAC,CAAC,eAAe;YAAC;cAAA4I,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5B,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAEN1J,OAAA;QAAK2J,EAAE,EAAC,QAAQ;QAAAL,QAAA,gBACdtJ,OAAA;UAAO4J,OAAO,EAAC,mBAAmB;UAAAN,QAAA,gBAChCtJ,OAAA;YAAAsJ,QAAA,EAAO3I,CAAC,CAAC,mBAAmB;UAAC;YAAA4I,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACrC1J,OAAA;YAAO4F,IAAI,EAAC,UAAU;YAAA,GAAK9E,QAAQ,CAAC,YAAY,CAAC;YAAE6I,EAAE,EAAC,mBAAmB;YAAChD,IAAI,EAAC;UAAY;YAAA4C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzF,CAAC,eAER1J,OAAA;UAAO4J,OAAO,EAAC,iBAAiB;UAAAN,QAAA,gBAC9BtJ,OAAA;YAAAsJ,QAAA,EAAO3I,CAAC,CAAC,iBAAiB;UAAC;YAAA4I,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACnC1J,OAAA;YAAO4F,IAAI,EAAC,UAAU;YAAA,GAAK9E,QAAQ,CAAC,UAAU,CAAC;YAAE6I,EAAE,EAAC,iBAAiB;YAAChD,IAAI,EAAC;UAAU;YAAA4C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnF,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL,CAAC,eAEN1J,OAAA;QAAK2J,EAAE,EAAC,cAAc;QAAAL,QAAA,gBACpBtJ,OAAA;UAAO4J,OAAO,EAAC,cAAc;UAAAN,QAAA,EAAE3I,CAAC,CAAC,eAAe;QAAC;UAAA4I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC1D1J,OAAA;UAAO4F,IAAI,EAAC,MAAM;UAAC+D,EAAE,EAAC,cAAc;UAAChD,IAAI,EAAC,OAAO;UAACyD,MAAM,EAAC,iBAAiB;UAACC,QAAQ;UAACC,QAAQ,EAAErF;QAAa;UAAAsE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eAC9G1J,OAAA;UAAKuK,KAAK,EAAE;YAAEC,OAAO,EAAE,MAAM;YAAEC,QAAQ,EAAE,MAAM;YAAEC,GAAG,EAAE,CAAC;YAAEC,MAAM,EAAE;UAAQ,CAAE;UAAArB,QAAA,EACxEtH,aAAa,CAAC4I,GAAG,CAAC,CAAC/H,GAAG,EAAE0E,GAAG,kBAC1BvH,OAAA;YAAeqD,GAAG,EAAEnB,aAAa,CAACqF,GAAG,CAAC,IAAI1E,GAAI;YAACgI,GAAG,EAAE,WAAWtD,GAAG,EAAG;YAACgD,KAAK,EAAE;cAAE5G,KAAK,EAAE,EAAE;cAAEE,MAAM,EAAE,EAAE;cAAEiH,SAAS,EAAE,OAAO;cAAEC,YAAY,EAAE,CAAC;cAAEC,MAAM,EAAE;YAAiB;UAAE,GAA5JnI,GAAG;YAAA0G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAA2J,CACzK;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAEN1J,OAAA;QAAKgK,SAAS,EAAC,cAAc;QAAAV,QAAA,gBAC3BtJ,OAAA;UAAQ4F,IAAI,EAAC,QAAQ;UAACwF,QAAQ,EAAErF,UAAW;UAAAuD,QAAA,EAAEvD,UAAU,GAAGpF,CAAC,CAAC,eAAe,CAAC,GAAGA,CAAC,CAAC,eAAe;QAAC;UAAA4I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAS,CAAC,EAC1GzD,WAAW,iBAAIjG,OAAA;UAAKgK,SAAS,EAAC,OAAO;UAACC,IAAI,EAAC,OAAO;UAAAX,QAAA,EAAErD;QAAW;UAAAsD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,EACtEvD,cAAc,iBAAInG,OAAA;UAAKgK,SAAS,EAAC,sBAAsB;UAACC,IAAI,EAAC,QAAQ;UAAAX,QAAA,EAAEnD;QAAc;UAAAoD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC1F,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEX,CAAC;AAAChJ,EAAA,CAxXID,UAAoB;EAAA,QACVb,cAAc,EACOE,OAAO,EACgBH,OAAO,EAMhDE,WAAW;AAAA;AAAAwL,EAAA,GATxB5K,UAAoB;AA0X1B,eAAeA,UAAU;AAAC,IAAA4K,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}