{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// Simple, reliable API URL for mobile\nconst API_URL = process.env.REACT_APP_API_URL || (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' ? 'http://localhost:3001' : `http://${window.location.hostname}:3001`);\nconst AdddogForm = () => {\n  _s();\n  const {\n    t\n  } = useTranslation();\n  const {\n    token,\n    isAuthenticated\n  } = useAuth();\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', {\n      isAuthenticated,\n      hasToken: !!token,\n      tokenLength: token === null || token === void 0 ? void 0 : token.length\n    });\n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n  const [mediaFile, setMediaFile] = useState(null);\n  const [mediaPreview, setMediaPreview] = useState(null);\n  const [smallPreview, setSmallPreview] = useState(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = file => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob(blob => {\n          cleanup();\n          if (blob) resolve(blob);else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = e => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = function (file) {\n    let size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 64;\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = e => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  const onFileChange = async e => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try {\n        URL.revokeObjectURL(mediaPreview);\n      } catch (err) {/* ignore */}\n    }\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState(null);\n  const [successMessage, setSuccessMessage] = useState(null);\n  const abortControllerRef = useRef(null);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n  const onSubmit = async fields => {\n    var _fields$name, _fields$location;\n    console.log('Form submit triggered with fields:', fields);\n\n    // Basic validation\n    if (!((_fields$name = fields.name) !== null && _fields$name !== void 0 && _fields$name.trim())) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!((_fields$location = fields.location) !== null && _fields$location !== void 0 && _fields$location.trim())) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', {\n            type: 'image/jpeg'\n          });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      abortControllerRef.current = new AbortController();\n      const headers = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      }).catch(async firstError => {\n        // If initial fetch fails on mobile, try fallback URLs\n        console.warn('First fetch failed, trying fallback:', firstError.message);\n        const fallbackUrls = ['http://172.20.10.2:3001/api/dogs',\n        // Direct IP\n        'http://localhost:3001/api/dogs' // Localhost fallback\n        ];\n\n        for (const fallbackUrl of fallbackUrls) {\n          try {\n            console.log('Trying fallback URL:', fallbackUrl);\n            const fallbackResp = await fetch(fallbackUrl, {\n              method: 'POST',\n              body: formData,\n              signal: abortControllerRef.current.signal,\n              headers\n            });\n            console.log('Fallback succeeded:', fallbackUrl);\n            return fallbackResp;\n          } catch (fallbackError) {\n            console.warn('Fallback failed:', fallbackUrl, fallbackError.message);\n          }\n        }\n\n        // If all fallbacks fail, throw the original error\n        throw firstError;\n      });\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => {\n          if (isMountedRef.current) navigate('/psi');\n        }, 1400);\n      }\n    } catch (err) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: t('adddog.title')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: '#f0f0f0',\n        padding: '8px',\n        margin: '8px 0',\n        fontSize: '11px',\n        borderRadius: '4px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Debug:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this), \" API_URL = \", API_URL, \" | hostname = \", window.location.hostname]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"adddog-form\",\n      onSubmit: handleSubmit(onSubmit),\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-name\",\n        children: t('adddog.name')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-name\",\n        name: \"name\",\n        autoComplete: \"name\",\n        placeholder: t('adddog.name'),\n        ...register('name', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this), errors.name && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        role: \"alert\",\n        children: [t('adddog.name'), \" is required\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-breed\",\n        children: t('adddog.breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-breed\",\n        name: \"breed\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.breed'),\n        ...register('breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-color\",\n        children: t('adddog.color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-color\",\n        name: \"color\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.color'),\n        ...register('color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-location\",\n        children: t('adddog.location')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-location\",\n        name: \"location\",\n        autoComplete: \"address-level2\",\n        placeholder: t('adddog.location'),\n        ...register('location', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-age\",\n        children: t('adddog.age')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        children: t('adddogExtra.ageNote')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        id: \"adddog-age\",\n        name: \"age\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.age'),\n        step: \"0.1\",\n        ...register('age', {\n          valueAsNumber: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-description\",\n        children: t('adddog.description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        id: \"adddog-description\",\n        name: \"description\",\n        rows: 3,\n        cols: 30,\n        autoComplete: \"off\",\n        placeholder: t('adddog.description'),\n        ...register('description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-size\",\n        children: t('adddog.size')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        ...register('size'),\n        id: \"adddog-size\",\n        name: \"size\",\n        autoComplete: \"off\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"small\",\n          children: t('size.small')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"medium\",\n          children: t('size.medium')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"large\",\n          children: t('size.large')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"gender\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: t('adddog.gender')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"gender-options\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-male\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-male\",\n              name: \"gender\",\n              value: \"male\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.male')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-female\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-female\",\n              name: \"gender\",\n              value: \"female\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.female')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"health\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-vaccinated\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.vaccinated')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('vaccinated'),\n            id: \"adddog-vaccinated\",\n            name: \"vaccinated\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-neutered\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.neutered')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('neutered'),\n            id: \"adddog-neutered\",\n            name: \"neutered\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"media-upload\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"media\",\n          children: t('adddog.media')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"media-input-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"image/*,video/*\",\n            id: \"adddog-media\",\n            name: \"media\",\n            onChange: onFileChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 13\n          }, this), smallPreview && /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"thumb-small\",\n            src: smallPreview,\n            alt: \"thumb\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this), mediaPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"media-preview\",\n          children: isVideo ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"preview-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              src: mediaPreview,\n              controls: true,\n              width: 150,\n              poster: smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"view-full\",\n              onClick: () => window.open(mediaPreview, '_blank'),\n              children: \"View full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 395,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"preview-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: smallPreview || mediaPreview,\n              alt: \"preview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 399,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"view-full\",\n              onClick: () => window.open(mediaPreview, '_blank'),\n              children: \"View full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: submitting,\n          children: submitting ? t('adddog.saving') : t('button.addDog')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this), submitError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          role: \"alert\",\n          children: submitError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 27\n        }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification success\",\n          role: \"status\",\n          children: successMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 30\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 323,\n    columnNumber: 5\n  }, this);\n};\n_s(AdddogForm, \"SkNTYFF5NUJdUc/D6GovgRNZZ7w=\", false, function () {\n  return [useTranslation, useAuth, useForm, useNavigate];\n});\n_c = AdddogForm;\nexport default AdddogForm;\nvar _c;\n$RefreshReg$(_c, \"AdddogForm\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","useTranslation","useNavigate","useAuth","API_URL","process","env","REACT_APP_API_URL","window","location","hostname","AdddogForm","t","token","isAuthenticated","register","handleSubmit","formState","errors","defaultValues","vaccinated","neutered","navigate","isMountedRef","console","log","hasToken","tokenLength","length","warn","current","mediaFile","setMediaFile","mediaPreview","setMediaPreview","smallPreview","setSmallPreview","isVideo","setIsVideo","posterBlob","setPosterBlob","createVideoPoster","file","Promise","resolve","reject","url","URL","createObjectURL","video","document","createElement","preload","muted","src","currentTime","cleanup","revokeObjectURL","onloadeddata","canvas","width","videoWidth","height","videoHeight","ctx","getContext","Error","drawImage","toBlob","blob","onerror","e","createImageThumbnail","size","img","Image","onload","ratio","Math","round","dataUrl","toDataURL","onFileChange","f","target","files","startsWith","err","type","poster","thumb","submitting","setSubmitting","submitError","setSubmitError","successMessage","setSuccessMessage","abortControllerRef","abort","onSubmit","fields","name","trim","href","formData","FormData","append","breed","color","age","undefined","String","description","posterFile","File","Object","fromEntries","entries","substring","AbortController","headers","error","resp","fetch","method","body","signal","catch","firstError","message","fallbackUrls","fallbackUrl","fallbackResp","fallbackError","ok","errMsg","status","statusText","json","JSON","stringify","txt","text","setTimeout","errorMessage","background","padding","margin","fontSize","borderRadius","required","valueAsNumber","open"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface AddDogFormData {\n  name: string;\n  breed: string;\n  color?: string;\n  location: string;\n  age: number;\n  description: string;\n  size: 'small' | 'medium' | 'large';\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n}\n\n// Simple, reliable API URL for mobile\nconst API_URL = process.env.REACT_APP_API_URL || \n  (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' \n    ? 'http://localhost:3001' \n    : `http://${window.location.hostname}:3001`);\n\nconst AdddogForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { token, isAuthenticated } = useAuth();\n  const { register, handleSubmit, formState: { errors } } = useForm<AddDogFormData>({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false,\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', { isAuthenticated, hasToken: !!token, tokenLength: token?.length });\n    \n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  const [mediaFile, setMediaFile] = useState<File | null>(null);\n  const [mediaPreview, setMediaPreview] = useState<string | null>(null);\n  const [smallPreview, setSmallPreview] = useState<string | null>(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState<Blob | null>(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = (file: File): Promise<Blob> => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob((blob) => {\n          cleanup();\n          if (blob) resolve(blob);\n          else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = (e) => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file: File, size = 64): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = (e) => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  const onFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try { URL.revokeObjectURL(mediaPreview); } catch (err) { /* ignore */ }\n    }\n\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n\n  const onSubmit: SubmitHandler<AddDogFormData> = async (fields) => {\n    console.log('Form submit triggered with fields:', fields);\n    \n    // Basic validation\n    if (!fields.name?.trim()) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!fields.location?.trim()) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    \n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', { type: 'image/jpeg' });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      \n      abortControllerRef.current = new AbortController();\n      \n      const headers: any = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      \n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      }).catch(async (firstError) => {\n        // If initial fetch fails on mobile, try fallback URLs\n        console.warn('First fetch failed, trying fallback:', firstError.message);\n        \n        const fallbackUrls = [\n          'http://172.20.10.2:3001/api/dogs',  // Direct IP\n          'http://localhost:3001/api/dogs'      // Localhost fallback\n        ];\n        \n        for (const fallbackUrl of fallbackUrls) {\n          try {\n            console.log('Trying fallback URL:', fallbackUrl);\n            const fallbackResp = await fetch(fallbackUrl, {\n              method: 'POST',\n              body: formData,\n              signal: abortControllerRef.current.signal,\n              headers\n            });\n            console.log('Fallback succeeded:', fallbackUrl);\n            return fallbackResp;\n          } catch (fallbackError) {\n            console.warn('Fallback failed:', fallbackUrl, fallbackError.message);\n          }\n        }\n        \n        // If all fallbacks fail, throw the original error\n        throw firstError;\n      });\n\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => { \n          if (isMountedRef.current) navigate('/psi'); \n        }, 1400);\n      }\n    } catch (err: any) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      \n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      \n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      \n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n\n  return (\n    <main>\n      <h2>{t('adddog.title')}</h2>\n      {/* Temporary debug info */}\n      <div style={{background: '#f0f0f0', padding: '8px', margin: '8px 0', fontSize: '11px', borderRadius: '4px'}}>\n        <strong>Debug:</strong> API_URL = {API_URL} | hostname = {window.location.hostname}\n      </div>\n      \n      <form id=\"adddog-form\" onSubmit={handleSubmit(onSubmit)}>\n        <label htmlFor=\"adddog-name\">{t('adddog.name')}</label>\n        <input type=\"text\" id=\"adddog-name\" name=\"name\" autoComplete=\"name\" placeholder={t('adddog.name')} {...register('name', { required: true })} />\n        {errors.name && <div className=\"error\" role=\"alert\">{t('adddog.name')} is required</div> }\n\n        <label htmlFor=\"adddog-breed\">{t('adddog.breed')}</label>\n        <input type=\"text\" id=\"adddog-breed\" name=\"breed\" autoComplete=\"off\" placeholder={t('adddog.breed')} {...register('breed')} />\n\n        <label htmlFor=\"adddog-color\">{t('adddog.color')}</label>\n        <input type=\"text\" id=\"adddog-color\" name=\"color\" autoComplete=\"off\" placeholder={t('adddog.color')} {...register('color')} />\n\n        <label htmlFor=\"adddog-location\">{t('adddog.location')}</label>\n        <input type=\"text\" id=\"adddog-location\" name=\"location\" autoComplete=\"address-level2\" placeholder={t('adddog.location')} {...register('location', { required: true })} />\n\n        <label htmlFor=\"adddog-age\">{t('adddog.age')}</label>\n        <small>{t('adddogExtra.ageNote')}</small>\n        <input type=\"number\" id=\"adddog-age\" name=\"age\" autoComplete=\"off\" placeholder={t('adddog.age')} step=\"0.1\" {...register('age', { valueAsNumber: true })} />\n\n        <label htmlFor=\"adddog-description\">{t('adddog.description')}</label>\n        <textarea id=\"adddog-description\" name=\"description\" rows={3} cols={30} autoComplete=\"off\" placeholder={t('adddog.description')} {...register('description')} />\n\n        <label htmlFor=\"adddog-size\">{t('adddog.size')}</label>\n        <select {...register('size')} id=\"adddog-size\" name=\"size\" autoComplete=\"off\">\n          <option value=\"small\">{t('size.small')}</option>\n          <option value=\"medium\">{t('size.medium')}</option>\n          <option value=\"large\">{t('size.large')}</option>\n        </select>\n\n        <div id=\"gender\">\n          <label>{t('adddog.gender')}</label>\n          <div className=\"gender-options\">\n            <label htmlFor=\"adddog-gender-male\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-male\" name=\"gender\" value=\"male\" />\n              <span>{t('gender.male')}</span>\n            </label>\n            <label htmlFor=\"adddog-gender-female\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-female\" name=\"gender\" value=\"female\" />\n              <span>{t('gender.female')}</span>\n            </label>\n          </div>\n        </div>\n\n        <div id=\"health\">\n          <label htmlFor=\"adddog-vaccinated\">\n            <span>{t('adddog.vaccinated')}</span>\n            <input type=\"checkbox\" {...register('vaccinated')} id=\"adddog-vaccinated\" name=\"vaccinated\" />\n          </label>\n\n          <label htmlFor=\"adddog-neutered\">\n            <span>{t('adddog.neutered')}</span>\n            <input type=\"checkbox\" {...register('neutered')} id=\"adddog-neutered\" name=\"neutered\" />\n          </label>\n        </div>\n\n        <div id=\"media-upload\">\n          <label htmlFor=\"media\">{t('adddog.media')}</label>\n          <div className=\"media-input-row\">\n            <input type=\"file\" accept=\"image/*,video/*\" id=\"adddog-media\" name=\"media\" onChange={onFileChange} />\n            {smallPreview && <img className=\"thumb-small\" src={smallPreview} alt=\"thumb\" />}\n          </div>\n          {mediaPreview && (\n            <div id=\"media-preview\">\n              {isVideo ? (\n                <div className=\"preview-wrap\">\n                  <video src={mediaPreview} controls width={150} poster={smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)}></video>\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              ) : (\n                <div className=\"preview-wrap\">\n                  <img src={smallPreview || mediaPreview} alt=\"preview\" />\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"form-actions\">\n          <button type=\"submit\" disabled={submitting}>{submitting ? t('adddog.saving') : t('button.addDog')}</button>\n          {submitError && <div className=\"error\" role=\"alert\">{submitError}</div>}\n          {successMessage && <div className=\"notification success\" role=\"status\">{successMessage}</div>}\n        </div>\n      </form>\n    </main>\n  );\n};\n\nexport default AdddogForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}