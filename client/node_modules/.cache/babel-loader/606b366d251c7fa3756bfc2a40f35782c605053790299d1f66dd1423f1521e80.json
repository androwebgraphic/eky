{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/eky/client/src/components/pages/DogList.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useSearchParams } from 'react-router-dom';\nimport EditDogModal from './EditDogModal';\nimport Search from '../Search';\nimport CardSmall from '../CardSmall';\nimport DogDetails from './DogDetails';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DogList = () => {\n  _s();\n  // Helper to get API URL\n  const getApiUrl = () => {\n    if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n    return 'http://localhost:3001';\n  };\n  // Helper to refetch dogs after adoption actions\n  const refetchDogs = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const headers = {\n        'Content-Type': 'application/json'\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n      const res = await fetch(`${getApiUrl()}/api/dogs`, {\n        cache: 'no-store',\n        headers\n      });\n      if (!res.ok) {\n        const txt = await res.text();\n        throw new Error(txt || `Request failed (${res.status})`);\n      }\n      const data = await res.json();\n      // Debug: log images array for each dog\n      if (Array.isArray(data)) {\n        data.forEach(dog => {\n          console.log(`[DogList DEBUG] Dog ${dog._id} images:`, dog.images);\n        });\n      }\n      // Debug: log full dog object and images property after fetch\n      if (Array.isArray(data)) {\n        data.forEach(dog => {\n          console.log('[DogList DEBUG] Dog', dog._id, 'images:', dog.images);\n        });\n      }\n      setDogs(data);\n    } catch (err) {\n      console.error('Failed to fetch dogs', err);\n      setError(err.message || t('doglist.failedToLoad'));\n    } finally {\n      setLoading(false);\n    }\n  };\n  const {\n    t\n  } = useTranslation();\n  const {\n    user,\n    token,\n    isAuthenticated\n  } = useAuth();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [dogs, setDogs] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedDog, setSelectedDog] = useState(null);\n  const [editDog, setEditDog] = useState(null);\n  const [modalPosition, setModalPosition] = useState(null);\n\n  // Debug: log editDog and modal state changes\n  useEffect(() => {\n    console.log('[DogList] editDog state changed:', editDog);\n    if (editDog) {\n      console.log('[DogList] Edit modal should be open for dog:', editDog);\n    }\n  }, [editDog]);\n  useEffect(() => {\n    console.log('[DogList] selectedDog state changed:', selectedDog);\n  }, [selectedDog]);\n  useEffect(() => {\n    console.log('[DogList] modalPosition state changed:', modalPosition);\n  }, [modalPosition]);\n\n  // Search filters - initialize from URL parameters\n  const [searchTerm, setSearchTerm] = useState(searchParams.get('search') || '');\n  const [genderFilter, setGenderFilter] = useState(searchParams.get('gender') || '');\n  const [sizeFilter, setSizeFilter] = useState(searchParams.get('size') || '');\n  const [locationFilter, setLocationFilter] = useState('');\n\n  // Get unique locations for dropdown\n  const availableLocations = Array.from(new Set(dogs.map(dog => dog.location || dog.place).filter(Boolean).sort()));\n  // Store availableLocations in localStorage for Footer search modal\n  React.useEffect(() => {\n    if (availableLocations.length > 0) {\n      localStorage.setItem('availableLocations', JSON.stringify(availableLocations));\n    }\n  }, [availableLocations]);\n\n  // Update URL parameters when search filters change\n  useEffect(() => {\n    const params = new URLSearchParams();\n    if (searchTerm) params.set('search', searchTerm);\n    if (genderFilter) params.set('gender', genderFilter);\n    if (sizeFilter) params.set('size', sizeFilter);\n\n    // Only update URL if params have changed\n    if (params.toString() !== searchParams.toString()) {\n      setSearchParams(params);\n    }\n  }, [searchTerm, genderFilter, sizeFilter, setSearchParams, searchParams]);\n\n  // Listen for URL parameter changes (e.g., from search modal)\n  useEffect(() => {\n    const search = searchParams.get('search') || '';\n    const gender = searchParams.get('gender') || '';\n    const size = searchParams.get('size') || '';\n    if (search !== searchTerm) setSearchTerm(search);\n    if (gender !== genderFilter) setGenderFilter(gender);\n    if (size !== sizeFilter) setSizeFilter(size);\n  }, [searchParams, searchTerm, genderFilter, sizeFilter]);\n\n  // Filter dogs based on search criteria\n  const filteredDogs = dogs.filter(dog => {\n    if (!searchTerm && !genderFilter && !sizeFilter && !locationFilter) {\n      return true; // No filters applied, show all dogs\n    }\n    const matchesSearch = !searchTerm || dog.name && dog.name.toLowerCase().includes(searchTerm.toLowerCase()) || dog.breed && dog.breed.toLowerCase().includes(searchTerm.toLowerCase()) || dog.location && dog.location.toLowerCase().includes(searchTerm.toLowerCase()) || dog.place && dog.place.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesGender = !genderFilter || dog.gender === genderFilter;\n    const matchesSize = !sizeFilter || dog.size === sizeFilter;\n    const matchesLocation = !locationFilter || dog.location === locationFilter || dog.place === locationFilter;\n    return matchesSearch && matchesGender && matchesSize && matchesLocation;\n  });\n\n  // Debug logging to help identify the issue\n\n  // Add/remove modal-open class when modal state changes\n  useEffect(() => {\n    if (selectedDog || editDog) {\n      document.body.classList.add('modal-open');\n    } else {\n      document.body.classList.remove('modal-open');\n    }\n\n    // Cleanup on unmount\n    return () => {\n      document.body.classList.remove('modal-open');\n    };\n  }, [selectedDog, editDog]);\n  useEffect(() => {\n    const getApiUrl = () => {\n      if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n      return 'http://localhost:3001';\n    };\n    const API_URL = getApiUrl();\n    let mounted = true;\n    (async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const headers = {\n          'Content-Type': 'application/json'\n        };\n        if (token) {\n          headers['Authorization'] = `Bearer ${token}`;\n        }\n        const res = await fetch(`${API_URL}/api/dogs`, {\n          cache: 'no-store',\n          headers\n        });\n        if (!res.ok) {\n          const txt = await res.text();\n          throw new Error(txt || `Request failed (${res.status})`);\n        }\n        const data = await res.json();\n        setDogs(data);\n      } catch (err) {\n        console.error('Failed to fetch dogs', err);\n        if (mounted) setError(err.message || t('doglist.failedToLoad'));\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, [token, t]);\n  useEffect(() => {\n    const closeHandler = () => {\n      if (typeof setEditDog === 'function') {\n        setEditDog(null);\n      }\n    };\n    window.addEventListener('closeEditDogModal', closeHandler);\n    return () => {\n      window.removeEventListener('closeEditDogModal', closeHandler);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: t('doglist.title')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Search, {\n      searchTerm: searchTerm,\n      onSearchChange: setSearchTerm,\n      genderFilter: genderFilter,\n      onGenderChange: setGenderFilter,\n      sizeFilter: sizeFilter,\n      onSizeChange: setSizeFilter,\n      locationFilter: locationFilter,\n      onLocationChange: setLocationFilter,\n      availableLocations: availableLocations\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"log\",\n      children: t('doglist.loading')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 17\n    }, this), !loading && !error && dogs.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"empty\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: t('doglist.empty')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/dodajpsa\",\n          children: t('doglist.addFirst')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 9\n    }, this), !loading && !error && dogs.length > 0 && filteredDogs.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"empty\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: t('search.noResults')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"Doglist\",\n      children: !loading && !error && filteredDogs.length === 1 && typeof window !== 'undefined' && window.innerWidth > 768 ? (() => {\n        const d = filteredDogs[0];\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'flex-start',\n            width: '100%'\n          },\n          children: /*#__PURE__*/_jsxDEV(CardSmall, {\n            smallImage: true,\n            compactDesktop: true,\n            _id: d._id,\n            name: d.name,\n            breed: d.breed,\n            age: d.age,\n            likes: d.likes || [],\n            images: d.images,\n            video: d.video,\n            thumbnail: d.thumbnail,\n            color: d.color,\n            place: d.place || d.location,\n            description: d.description,\n            size: d.size,\n            gender: d.gender,\n            vaccinated: d.vaccinated,\n            neutered: d.neutered,\n            user: d.user,\n            canEdit: true,\n            adoptionStatus: d.adoptionStatus,\n            adoptionQueue: d.adoptionQueue,\n            onDogUpdate: update => {\n              console.log('[DogList] onDogUpdate received:', update);\n              if (update && update.remove && update.id) {\n                setDogs(prev => {\n                  console.log('[DogList] Dog list before removal:', prev);\n                  const filtered = prev.filter(dog => dog._id !== update.id);\n                  console.log('[DogList] Dog list after removal:', filtered);\n                  return filtered;\n                });\n                if (selectedDog && selectedDog._id === update.id) setSelectedDog(null);\n                // Always refetch dogs after adoption actions to ensure correct state\n                refetchDogs();\n              } else {\n                refetchDogs();\n                if (selectedDog && update && selectedDog._id === update._id) setSelectedDog(update);\n              }\n            },\n            onViewDetails: event => {\n              const rect = event.currentTarget.getBoundingClientRect();\n              setModalPosition({\n                x: rect.left + rect.width / 2,\n                y: rect.top + rect.height / 2\n              });\n              setSelectedDog(d);\n            },\n            onEdit: event => {\n              // Always set modal position to center for testing\n              setModalPosition({\n                x: window.innerWidth / 2,\n                y: window.innerHeight / 2\n              });\n              handleEditDog(d);\n            },\n            onRemove: () => handleRemoveDog(d)\n          }, d._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 15\n        }, this);\n      })() : !loading && !error && filteredDogs.length > 1 && typeof window !== 'undefined' && window.innerWidth > 768 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          justifyContent: 'center',\n          alignItems: 'flex-start',\n          gap: '1.5rem',\n          width: '100%'\n        },\n        children: filteredDogs.map(d => /*#__PURE__*/_jsxDEV(CardSmall, {\n          smallImage: false,\n          compactDesktop: true,\n          _id: d._id,\n          name: d.name,\n          breed: d.breed,\n          age: d.age,\n          likes: d.likes || [],\n          images: d.images,\n          video: d.video,\n          thumbnail: d.thumbnail,\n          color: d.color,\n          place: d.place || d.location,\n          description: d.description,\n          size: d.size,\n          gender: d.gender,\n          vaccinated: d.vaccinated,\n          neutered: d.neutered,\n          user: d.user,\n          canEdit: true,\n          adoptionStatus: d.adoptionStatus,\n          adoptionQueue: d.adoptionQueue,\n          onDogUpdate: update => {\n            console.log('[DogList] onDogUpdate received:', update);\n            if (update && update.remove && update.id) {\n              setDogs(prev => {\n                console.log('[DogList] Dog list before removal:', prev);\n                const filtered = prev.filter(dog => dog._id !== update.id);\n                console.log('[DogList] Dog list after removal:', filtered);\n                return filtered;\n              });\n              if (selectedDog && selectedDog._id === update.id) setSelectedDog(null);\n              // Always refetch dogs after adoption actions to ensure correct state\n              refetchDogs();\n            } else {\n              refetchDogs();\n              if (selectedDog && update && selectedDog._id === update._id) setSelectedDog(update);\n            }\n          },\n          onViewDetails: event => {\n            const rect = event.currentTarget.getBoundingClientRect();\n            setModalPosition({\n              x: rect.left + rect.width / 2,\n              y: rect.top + rect.height / 2\n            });\n            setSelectedDog(d);\n          },\n          onEdit: event => {\n            // Always set modal position to center for testing\n            setModalPosition({\n              x: window.innerWidth / 2,\n              y: window.innerHeight / 2\n            });\n            handleEditDog(d);\n          },\n          onRemove: () => handleRemoveDog(d)\n        }, d._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 11\n      }, this) : !loading && !error && filteredDogs.map(d => {\n        const showSmallImage = filteredDogs.length === 1;\n        const compactDesktop = typeof window !== 'undefined' && window.innerWidth > 768;\n        // Extract dog owner ID (handle both string and object, and _id vs id)\n        let dogOwnerId;\n        if (typeof d.user === 'string') {\n          dogOwnerId = d.user;\n        } else if (d.user) {\n          // Try _id first, then id\n          dogOwnerId = d.user._id || d.user.id;\n        }\n\n        // Extract current user ID\n        const currentUserId = user === null || user === void 0 ? void 0 : user._id;\n\n        // Check if user is superadmin\n        const isSuperAdmin = (user === null || user === void 0 ? void 0 : user.role) === 'superadmin';\n\n        // Compare as strings to avoid type mismatches\n        const isOwner = Boolean(currentUserId && dogOwnerId && String(currentUserId) === String(dogOwnerId));\n\n        // User can edit if they're the owner OR if they're a superadmin\n        const canEdit = Boolean(isAuthenticated && (isOwner || isSuperAdmin));\n        return /*#__PURE__*/_jsxDEV(CardSmall, {\n          smallImage: showSmallImage,\n          compactDesktop: compactDesktop,\n          _id: d._id,\n          name: d.name,\n          breed: d.breed,\n          age: d.age,\n          likes: d.likes || [],\n          images: d.images,\n          video: d.video,\n          thumbnail: d.thumbnail,\n          color: d.color,\n          place: d.place || d.location,\n          description: d.description,\n          size: d.size,\n          gender: d.gender,\n          vaccinated: d.vaccinated,\n          neutered: d.neutered,\n          user: d.user,\n          canEdit: canEdit,\n          adoptionStatus: d.adoptionStatus,\n          adoptionQueue: d.adoptionQueue,\n          onDogUpdate: update => {\n            console.log('[DogList] onDogUpdate received:', update);\n            if (update && update.remove && update.id) {\n              setDogs(prev => {\n                console.log('[DogList] Dog list before removal:', prev);\n                const filtered = prev.filter(dog => dog._id !== update.id);\n                console.log('[DogList] Dog list after removal:', filtered);\n                return filtered;\n              });\n              if (selectedDog && selectedDog._id === update.id) setSelectedDog(null);\n              // Always refetch dogs after adoption actions to ensure correct state\n              refetchDogs();\n            } else {\n              refetchDogs();\n              if (selectedDog && update && selectedDog._id === update._id) setSelectedDog(update);\n            }\n          },\n          onViewDetails: event => {\n            const rect = event.currentTarget.getBoundingClientRect();\n            setModalPosition({\n              x: rect.left + rect.width / 2,\n              y: rect.top + rect.height / 2\n            });\n            setSelectedDog(d);\n          },\n          onEdit: event => {\n            // Always set modal position to center for testing\n            setModalPosition({\n              x: window.innerWidth / 2,\n              y: window.innerHeight / 2\n            });\n            handleEditDog(d);\n          },\n          onRemove: () => handleRemoveDog(d)\n        }, d._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }, this), selectedDog && modalPosition && /*#__PURE__*/createPortal(/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100vw',\n        height: '100vh',\n        backgroundColor: 'rgba(0, 0, 0, 0.8)',\n        zIndex: 2147483647,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        padding: '2rem',\n        boxSizing: 'border-box'\n      },\n      onClick: () => {\n        setSelectedDog(null);\n        setModalPosition(null);\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: 'white',\n          borderRadius: '12px',\n          padding: '2rem',\n          maxWidth: '90vw',\n          maxHeight: '90vh',\n          overflowY: 'auto',\n          position: 'relative',\n          zIndex: 2147483647,\n          boxShadow: '0 20px 60px rgba(0,0,0,0.5)'\n        },\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            position: 'absolute',\n            top: 15,\n            right: 15,\n            width: 56,\n            height: 56,\n            backgroundColor: '#e74c3c',\n            color: '#fff',\n            border: 'none',\n            borderRadius: '50%',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            boxShadow: '0 4px 12px rgba(0,0,0,0.3)',\n            cursor: 'pointer',\n            zIndex: 2147483647,\n            padding: 0\n          },\n          onClick: () => {\n            setSelectedDog(null);\n            setModalPosition(null);\n          },\n          title: t('common.close'),\n          \"aria-label\": t('common.close'),\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: 40,\n              fontWeight: 900,\n              lineHeight: '56px',\n              width: '100%',\n              textAlign: 'center',\n              display: 'block',\n              userSelect: 'none',\n              letterSpacing: 2\n            },\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(DogDetails, {\n          ...selectedDog,\n          adoptionStatus: selectedDog === null || selectedDog === void 0 ? void 0 : selectedDog.adoptionStatus,\n          adoptionQueue: selectedDog === null || selectedDog === void 0 ? void 0 : selectedDog.adoptionQueue,\n          onDogUpdate: async update => {\n            // Always reload the full dog list and update selected dog with latest from backend\n            const getApiUrl = () => {\n              if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n              return 'http://localhost:3001';\n            };\n            const API_URL = getApiUrl();\n            setLoading(true);\n            setError(null);\n            try {\n              const headers = {\n                'Content-Type': 'application/json'\n              };\n              if (token) headers['Authorization'] = `Bearer ${token}`;\n              const res = await fetch(`${API_URL}/api/dogs`, {\n                cache: 'no-store',\n                headers\n              });\n              if (!res.ok) throw new Error((await res.text()) || `Request failed (${res.status})`);\n              const data = await res.json();\n              setDogs(data);\n              // Update selected dog with latest data\n              if (update && update._id) {\n                const latest = data.find(d => d._id === update._id);\n                setSelectedDog(latest || null);\n              } else if (update && update.remove) {\n                setSelectedDog(null);\n              }\n            } catch (err) {\n              setError(err.message || t('doglist.failedToLoad'));\n            } finally {\n              setLoading(false);\n            }\n          },\n          onDogChanged: async () => {\n            // Also reload the full dog list after adoption actions\n            const getApiUrl = () => {\n              if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n              return 'http://localhost:3001';\n            };\n            const API_URL = getApiUrl();\n            setLoading(true);\n            setError(null);\n            try {\n              const headers = {\n                'Content-Type': 'application/json'\n              };\n              if (token) headers['Authorization'] = `Bearer ${token}`;\n              const res = await fetch(`${API_URL}/api/dogs`, {\n                cache: 'no-store',\n                headers\n              });\n              if (!res.ok) throw new Error((await res.text()) || `Request failed (${res.status})`);\n              const data = await res.json();\n              setDogs(data);\n              // If a dog is selected, update it\n              if (selectedDog && selectedDog._id) {\n                const latest = data.find(d => d._id === selectedDog._id);\n                setSelectedDog(latest || null);\n              }\n            } catch (err) {\n              setError(err.message || t('doglist.failedToLoad'));\n            } finally {\n              setLoading(false);\n            }\n          },\n          onClose: () => {\n            setSelectedDog(null);\n            setModalPosition(null);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 507,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 487,\n      columnNumber: 9\n    }, this), document.body), editDog && modalPosition && /*#__PURE__*/createPortal(/*#__PURE__*/_jsxDEV(EditDogModal, {\n      dog: editDog,\n      onSave: async updatedDog => {\n        console.log('[DogList] onSave called from EditDogModal', updatedDog);\n        // Update the dog list and also update editDog so modal receives new images\n        await handleSaveEditDog(updatedDog);\n        // Force refresh the full dog list after save to ensure images update everywhere\n        const getApiUrl = () => {\n          if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n          return 'http://localhost:3001';\n        };\n        const API_URL = getApiUrl();\n        let latestDog = updatedDog;\n        try {\n          // Fetch the latest dog data for the edited dog\n          const res = await fetch(`${API_URL}/api/dogs/${updatedDog._id}`);\n          if (res.ok) {\n            latestDog = await res.json();\n          }\n          // Fetch the full dog list and update state\n          const listRes = await fetch(`${API_URL}/api/dogs`, {\n            cache: 'no-store'\n          });\n          if (listRes.ok) {\n            const data = await listRes.json();\n            setDogs(data);\n          }\n        } catch (err) {\n          console.error('DogList: Failed to refresh dog list after save', err);\n        }\n        // Always keep modal open with updated dog after save\n        setEditDog(latestDog);\n        setModalPosition(modalPosition); // keep modal position unchanged\n        // Never set selectedDog here; only update editDog and refresh list\n        console.log('[DogList] setEditDog called with latestDog (modal stays open)', latestDog);\n      },\n      isSingleDog: dogs.length === 1\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 631,\n      columnNumber: 9\n    }, this), document.body)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 239,\n    columnNumber: 5\n  }, this);\n\n  // Handler for editing a dog\n  function handleEditDog(dog) {\n    console.log('[DogList] handleEditDog called with:', dog);\n    setEditDog(dog);\n  }\n\n  // Handler for saving an edited dog\n  async function handleSaveEditDog(updatedDog) {\n    console.log('[DogList] handleSaveEditDog called with:', updatedDog);\n    // Re-fetch the full dog list after editing\n    const getApiUrl = () => {\n      if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n      return 'http://localhost:3001';\n    };\n    const API_URL = getApiUrl();\n    setLoading(true);\n    setError(null);\n    try {\n      const headers = {\n        'Content-Type': 'application/json'\n      };\n      if (token) headers['Authorization'] = `Bearer ${token}`;\n      // Always fetch the latest dog data after update\n      const res = await fetch(`${API_URL}/api/dogs`, {\n        cache: 'no-store',\n        headers\n      });\n      if (!res.ok) throw new Error((await res.text()) || `Request failed (${res.status})`);\n      const data = await res.json();\n      setDogs(data);\n      // Do not set selectedDog here; only update editDog and refresh dog list\n    } catch (err) {\n      setError(err.message || t('doglist.failedToLoad'));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Handler for removing a dog\n  async function handleRemoveDog(dog) {\n    if (!window.confirm(t('doglist.confirmRemove', {\n      name: dog.name\n    }))) return;\n    try {\n      // Debug auth context values\n      console.log('Delete request - Auth context values:', {\n        user: user,\n        token: token,\n        isAuthenticated: isAuthenticated,\n        localStorageToken: localStorage.getItem('token'),\n        localStorageUser: localStorage.getItem('user')\n      });\n      const getApiUrl = () => {\n        if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n        return 'http://localhost:3001';\n      };\n      const API_URL = getApiUrl();\n      const headers = {\n        'Content-Type': 'application/json'\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('Delete request - Using token:', token.substring(0, 20) + '...');\n      } else {\n        console.error('Delete request - No token available!');\n      }\n      console.log('Delete request details:', {\n        url: `${API_URL}/api/dogs/${dog._id}`,\n        method: 'DELETE',\n        headers,\n        dogId: dog._id,\n        dogName: dog.name\n      });\n      const resp = await fetch(`${API_URL}/api/dogs/${dog._id}`, {\n        method: 'DELETE',\n        headers\n      });\n      console.log('Delete response status:', resp.status);\n      if (!resp.ok) {\n        const errorText = await resp.text();\n        console.error('Delete failed:', resp.status, errorText);\n        throw new Error(`${resp.status}: ${errorText}`);\n      }\n      console.log('Delete successful, removing from UI');\n      setDogs(dogs => dogs.filter(d => d._id !== dog._id));\n      // Close modals if open for this dog\n      setEditDog(editDog => editDog && editDog._id === dog._id ? null : editDog);\n      setSelectedDog(selectedDog => selectedDog && selectedDog._id === dog._id ? null : selectedDog);\n    } catch (err) {\n      console.error('Delete error details:', err);\n      alert(err.message || t('doglist.failedToRemove'));\n    }\n  }\n};\n_s(DogList, \"cpF0dq6Gj/NNQa4ZRpR2nwut+9k=\", false, function () {\n  return [useTranslation, useAuth, useSearchParams];\n});\n_c = DogList;\nexport default DogList;\nvar _c;\n$RefreshReg$(_c, \"DogList\");","map":{"version":3,"names":["React","useState","useEffect","createPortal","useSearchParams","EditDogModal","Search","CardSmall","DogDetails","useTranslation","useAuth","jsxDEV","_jsxDEV","DogList","_s","getApiUrl","process","env","REACT_APP_API_URL","refetchDogs","setLoading","setError","headers","token","res","fetch","cache","ok","txt","text","Error","status","data","json","Array","isArray","forEach","dog","console","log","_id","images","setDogs","err","error","message","t","user","isAuthenticated","searchParams","setSearchParams","dogs","loading","selectedDog","setSelectedDog","editDog","setEditDog","modalPosition","setModalPosition","searchTerm","setSearchTerm","get","genderFilter","setGenderFilter","sizeFilter","setSizeFilter","locationFilter","setLocationFilter","availableLocations","from","Set","map","location","place","filter","Boolean","sort","length","localStorage","setItem","JSON","stringify","params","URLSearchParams","set","toString","search","gender","size","filteredDogs","matchesSearch","name","toLowerCase","includes","breed","matchesGender","matchesSize","matchesLocation","document","body","classList","add","remove","API_URL","mounted","closeHandler","window","addEventListener","removeEventListener","children","fileName","_jsxFileName","lineNumber","columnNumber","onSearchChange","onGenderChange","onSizeChange","onLocationChange","className","href","id","innerWidth","d","style","display","justifyContent","alignItems","width","smallImage","compactDesktop","age","likes","video","thumbnail","color","description","vaccinated","neutered","canEdit","adoptionStatus","adoptionQueue","onDogUpdate","update","prev","filtered","onViewDetails","event","rect","currentTarget","getBoundingClientRect","x","left","y","top","height","onEdit","innerHeight","handleEditDog","onRemove","handleRemoveDog","flexWrap","gap","showSmallImage","dogOwnerId","currentUserId","isSuperAdmin","role","isOwner","String","position","backgroundColor","zIndex","padding","boxSizing","onClick","borderRadius","maxWidth","maxHeight","overflowY","boxShadow","e","stopPropagation","right","border","cursor","title","fontSize","fontWeight","lineHeight","textAlign","userSelect","letterSpacing","latest","find","onDogChanged","onClose","onSave","updatedDog","handleSaveEditDog","latestDog","listRes","isSingleDog","confirm","localStorageToken","getItem","localStorageUser","substring","url","method","dogId","dogName","resp","errorText","alert","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/pages/DogList.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useSearchParams } from 'react-router-dom';\nimport EditDogModal from './EditDogModal';\nimport Search from '../Search';\nimport CardSmall from '../CardSmall';\nimport DogDetails from './DogDetails';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface Dog {\n  _id: string;\n  name: string;\n  breed?: string;\n  age?: number;\n  images?: any[];\n  video?: any;\n  thumbnail?: any;\n  color?: string;\n  place?: string;\n  description?: string;\n  size?: string;\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n  location?: string;\n  likes?: string[];\n  user?: { \n    _id: string; \n    name: string; \n    username: string;\n    email?: string;\n    phone?: string;\n    person?: 'private' | 'organization';\n  };\n  adoptionStatus?: string;\n  adoptionQueue?: any;\n}\n\nconst DogList: React.FC = () => {\n      // Helper to get API URL\n      const getApiUrl = () => {\n        if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n        return 'http://localhost:3001';\n      };\n    // Helper to refetch dogs after adoption actions\n    const refetchDogs = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const headers: any = { 'Content-Type': 'application/json' };\n        if (token) {\n          headers['Authorization'] = `Bearer ${token}`;\n        }\n        const res = await fetch(`${getApiUrl()}/api/dogs`, { \n          cache: 'no-store',\n          headers \n        });\n        if (!res.ok) {\n          const txt = await res.text();\n          throw new Error(txt || `Request failed (${res.status})`);\n        }\n        const data = await res.json();\n        // Debug: log images array for each dog\n        if (Array.isArray(data)) {\n          data.forEach(dog => {\n            console.log(`[DogList DEBUG] Dog ${dog._id} images:`, dog.images);\n          });\n        }\n        // Debug: log full dog object and images property after fetch\n        if (Array.isArray(data)) {\n          data.forEach(dog => {\n            console.log('[DogList DEBUG] Dog', dog._id, 'images:', dog.images);\n          });\n        }\n        setDogs(data);\n      } catch (err: any) {\n        console.error('Failed to fetch dogs', err);\n        setError(err.message || t('doglist.failedToLoad'));\n      } finally {\n        setLoading(false);\n      }\n    };\n  const { t } = useTranslation();\n  const { user, token, isAuthenticated } = useAuth();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [dogs, setDogs] = useState<Dog[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedDog, setSelectedDog] = useState<Dog | null>(null);\n  const [editDog, setEditDog] = useState<Dog | null>(null);\n  const [modalPosition, setModalPosition] = useState<{x: number, y: number} | null>(null);\n\n  // Debug: log editDog and modal state changes\n  useEffect(() => {\n    console.log('[DogList] editDog state changed:', editDog);\n    if (editDog) {\n      console.log('[DogList] Edit modal should be open for dog:', editDog);\n    }\n  }, [editDog]);\n  useEffect(() => {\n    console.log('[DogList] selectedDog state changed:', selectedDog);\n  }, [selectedDog]);\n  useEffect(() => {\n    console.log('[DogList] modalPosition state changed:', modalPosition);\n  }, [modalPosition]);\n  \n  // Search filters - initialize from URL parameters\n  const [searchTerm, setSearchTerm] = useState(searchParams.get('search') || '');\n  const [genderFilter, setGenderFilter] = useState(searchParams.get('gender') || '');\n  const [sizeFilter, setSizeFilter] = useState(searchParams.get('size') || '');\n  const [locationFilter, setLocationFilter] = useState('');\n  \n\n  // Get unique locations for dropdown\n  const availableLocations = Array.from(new Set(\n    dogs.map(dog => dog.location || dog.place)\n      .filter(Boolean)\n      .sort()\n  ));\n  // Store availableLocations in localStorage for Footer search modal\n  React.useEffect(() => {\n    if (availableLocations.length > 0) {\n      localStorage.setItem('availableLocations', JSON.stringify(availableLocations));\n    }\n  }, [availableLocations]);\n  \n  // Update URL parameters when search filters change\n  useEffect(() => {\n    const params = new URLSearchParams();\n    if (searchTerm) params.set('search', searchTerm);\n    if (genderFilter) params.set('gender', genderFilter);\n    if (sizeFilter) params.set('size', sizeFilter);\n    \n    // Only update URL if params have changed\n    if (params.toString() !== searchParams.toString()) {\n      setSearchParams(params);\n    }\n  }, [searchTerm, genderFilter, sizeFilter, setSearchParams, searchParams]);\n\n  // Listen for URL parameter changes (e.g., from search modal)\n  useEffect(() => {\n    const search = searchParams.get('search') || '';\n    const gender = searchParams.get('gender') || '';\n    const size = searchParams.get('size') || '';\n    \n    if (search !== searchTerm) setSearchTerm(search);\n    if (gender !== genderFilter) setGenderFilter(gender);\n    if (size !== sizeFilter) setSizeFilter(size);\n  }, [searchParams, searchTerm, genderFilter, sizeFilter]);\n  \n  // Filter dogs based on search criteria\n  const filteredDogs = dogs.filter(dog => {\n    if (!searchTerm && !genderFilter && !sizeFilter && !locationFilter) {\n      return true; // No filters applied, show all dogs\n    }\n    \n    const matchesSearch = !searchTerm || \n      (dog.name && dog.name.toLowerCase().includes(searchTerm.toLowerCase())) ||\n      (dog.breed && dog.breed.toLowerCase().includes(searchTerm.toLowerCase())) ||\n      (dog.location && dog.location.toLowerCase().includes(searchTerm.toLowerCase())) ||\n      (dog.place && dog.place.toLowerCase().includes(searchTerm.toLowerCase()));\n    \n    const matchesGender = !genderFilter || dog.gender === genderFilter;\n    const matchesSize = !sizeFilter || dog.size === sizeFilter;\n    const matchesLocation = !locationFilter || \n      dog.location === locationFilter || dog.place === locationFilter;\n    \n    return matchesSearch && matchesGender && matchesSize && matchesLocation;\n  });\n  \n  // Debug logging to help identify the issue\n  \n\n  // Add/remove modal-open class when modal state changes\n  useEffect(() => {\n    if (selectedDog || editDog) {\n      document.body.classList.add('modal-open');\n    } else {\n      document.body.classList.remove('modal-open');\n    }\n    \n    // Cleanup on unmount\n    return () => {\n      document.body.classList.remove('modal-open');\n    };\n  }, [selectedDog, editDog]);\n\n  useEffect(() => {\n    const getApiUrl = () => {\n      if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n      return 'http://localhost:3001';\n    };\n    const API_URL = getApiUrl();\n    let mounted = true;\n\n    (async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const headers: any = { 'Content-Type': 'application/json' };\n        if (token) {\n          headers['Authorization'] = `Bearer ${token}`;\n        }\n        const res = await fetch(`${API_URL}/api/dogs`, { \n          cache: 'no-store',\n          headers \n        });\n        if (!res.ok) {\n          const txt = await res.text();\n          throw new Error(txt || `Request failed (${res.status})`);\n        }\n        const data = await res.json();\n        setDogs(data);\n      } catch (err: any) {\n        console.error('Failed to fetch dogs', err);\n        if (mounted) setError(err.message || t('doglist.failedToLoad'));\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    })();\n\n    return () => { mounted = false; };\n  }, [token, t]);\n\n  useEffect(() => {\n    const closeHandler = () => {\n      if (typeof setEditDog === 'function') {\n        setEditDog(null);\n      }\n    };\n    window.addEventListener('closeEditDogModal', closeHandler);\n    return () => {\n      window.removeEventListener('closeEditDogModal', closeHandler);\n    };\n  }, []);\n\n  return (\n    <main>\n      <h2>{t('doglist.title')}</h2>\n      <Search \n        searchTerm={searchTerm}\n        onSearchChange={setSearchTerm}\n        genderFilter={genderFilter}\n        onGenderChange={setGenderFilter}\n        sizeFilter={sizeFilter}\n        onSizeChange={setSizeFilter}\n        locationFilter={locationFilter}\n        onLocationChange={setLocationFilter}\n        availableLocations={availableLocations}\n      />\n\n      {loading && <p className=\"log\">{t('doglist.loading')}</p>}\n      {error && <p className=\"error\">{error}</p>}\n\n      {!loading && !error && dogs.length === 0 && (\n        <div className=\"empty\">\n          <p>{t('doglist.empty')}</p>\n          <p>\n            <a href=\"/dodajpsa\">{t('doglist.addFirst')}</a>\n          </p>\n        </div>\n      )}\n\n      {!loading && !error && dogs.length > 0 && filteredDogs.length === 0 && (\n        <div className=\"empty\">\n          <p>{t('search.noResults')}</p>\n        </div>\n      )}\n\n      <div id=\"Doglist\">\n\n        {!loading && !error && filteredDogs.length === 1 && typeof window !== 'undefined' && window.innerWidth > 768 ? (\n          (() => {\n            const d = filteredDogs[0];\n            return (\n              <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'flex-start', width: '100%' }}>\n                <CardSmall\n                  smallImage={true}\n                  compactDesktop={true}\n                  key={d._id}\n                  _id={d._id}\n                  name={d.name}\n                  breed={d.breed}\n                  age={d.age}\n                  likes={d.likes || []}\n                  images={d.images}\n                  video={d.video}\n                  thumbnail={d.thumbnail}\n                  color={d.color}\n                  place={d.place || d.location}\n                  description={d.description}\n                  size={d.size}\n                  gender={d.gender}\n                  vaccinated={d.vaccinated}\n                  neutered={d.neutered}\n                  user={d.user}\n                  canEdit={true}\n                  adoptionStatus={d.adoptionStatus}\n                  adoptionQueue={d.adoptionQueue}\n                  onDogUpdate={update => {\n                    console.log('[DogList] onDogUpdate received:', update);\n                    if (update && update.remove && update.id) {\n                      setDogs(prev => {\n                        console.log('[DogList] Dog list before removal:', prev);\n                        const filtered = prev.filter(dog => dog._id !== update.id);\n                        console.log('[DogList] Dog list after removal:', filtered);\n                        return filtered;\n                      });\n                      if (selectedDog && selectedDog._id === update.id) setSelectedDog(null);\n                      // Always refetch dogs after adoption actions to ensure correct state\n                      refetchDogs();\n                    } else {\n                      refetchDogs();\n                      if (selectedDog && update && selectedDog._id === update._id) setSelectedDog(update);\n                    }\n                  }}\n                  onViewDetails={(event) => {\n                    const rect = event.currentTarget.getBoundingClientRect();\n                    setModalPosition({\n                      x: rect.left + rect.width / 2,\n                      y: rect.top + rect.height / 2\n                    });\n                    setSelectedDog(d);\n                  }}\n                  onEdit={(event) => {\n                    // Always set modal position to center for testing\n                    setModalPosition({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                    handleEditDog(d);\n                  }}\n                  onRemove={() => handleRemoveDog(d)}\n                />\n              </div>\n            );\n          })()\n        ) :\n        !loading && !error && filteredDogs.length > 1 && typeof window !== 'undefined' && window.innerWidth > 768 ? (\n          <div style={{ display: 'flex', flexWrap: 'wrap', justifyContent: 'center', alignItems: 'flex-start', gap: '1.5rem', width: '100%' }}>\n            {filteredDogs.map(d => (\n              <CardSmall\n                smallImage={false}\n                compactDesktop={true}\n                key={d._id}\n                _id={d._id}\n                name={d.name}\n                breed={d.breed}\n                age={d.age}\n                likes={d.likes || []}\n                images={d.images}\n                video={d.video}\n                thumbnail={d.thumbnail}\n                color={d.color}\n                place={d.place || d.location}\n                description={d.description}\n                size={d.size}\n                gender={d.gender}\n                vaccinated={d.vaccinated}\n                neutered={d.neutered}\n                user={d.user}\n                canEdit={true}\n                adoptionStatus={d.adoptionStatus}\n                adoptionQueue={d.adoptionQueue}\n                onDogUpdate={update => {\n                  console.log('[DogList] onDogUpdate received:', update);\n                  if (update && update.remove && update.id) {\n                    setDogs(prev => {\n                      console.log('[DogList] Dog list before removal:', prev);\n                      const filtered = prev.filter(dog => dog._id !== update.id);\n                      console.log('[DogList] Dog list after removal:', filtered);\n                      return filtered;\n                    });\n                    if (selectedDog && selectedDog._id === update.id) setSelectedDog(null);\n                    // Always refetch dogs after adoption actions to ensure correct state\n                    refetchDogs();\n                  } else {\n                    refetchDogs();\n                    if (selectedDog && update && selectedDog._id === update._id) setSelectedDog(update);\n                  }\n                }}\n                onViewDetails={(event) => {\n                  const rect = event.currentTarget.getBoundingClientRect();\n                  setModalPosition({\n                    x: rect.left + rect.width / 2,\n                    y: rect.top + rect.height / 2\n                  });\n                  setSelectedDog(d);\n                }}\n                onEdit={(event) => {\n                  // Always set modal position to center for testing\n                  setModalPosition({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                  handleEditDog(d);\n                }}\n                onRemove={() => handleRemoveDog(d)}\n              />\n            ))}\n          </div>\n        ) :\n        !loading && !error && filteredDogs.map(d => {\n          const showSmallImage = filteredDogs.length === 1;\n          const compactDesktop = typeof window !== 'undefined' && window.innerWidth > 768;\n          // Extract dog owner ID (handle both string and object, and _id vs id)\n          let dogOwnerId;\n          if (typeof (d.user as any) === 'string') {\n            dogOwnerId = d.user as any;\n          } else if (d.user) {\n            // Try _id first, then id\n            dogOwnerId = (d.user as any)._id || (d.user as any).id;\n          }\n          \n          // Extract current user ID\n          const currentUserId = user?._id;\n          \n          // Check if user is superadmin\n          const isSuperAdmin = user?.role === 'superadmin';\n          \n          // Compare as strings to avoid type mismatches\n          const isOwner = Boolean(\n            currentUserId && \n            dogOwnerId && \n            String(currentUserId) === String(dogOwnerId)\n          );\n          \n          // User can edit if they're the owner OR if they're a superadmin\n          const canEdit = Boolean(isAuthenticated && (isOwner || isSuperAdmin));\n          \n          return (\n            <CardSmall\n              smallImage={showSmallImage}\n              compactDesktop={compactDesktop}\n              key={d._id}\n              _id={d._id}\n              name={d.name}\n              breed={d.breed}\n              age={d.age}\n              likes={d.likes || []}\n              images={d.images}\n              video={d.video}\n              thumbnail={d.thumbnail}\n              color={d.color}\n              place={d.place || d.location}\n              description={d.description}\n              size={d.size}\n              gender={d.gender}\n              vaccinated={d.vaccinated}\n              neutered={d.neutered}\n              user={d.user}\n              canEdit={canEdit}\n              adoptionStatus={d.adoptionStatus}\n              adoptionQueue={d.adoptionQueue}\n              onDogUpdate={update => {\n                console.log('[DogList] onDogUpdate received:', update);\n                if (update && update.remove && update.id) {\n                  setDogs(prev => {\n                    console.log('[DogList] Dog list before removal:', prev);\n                    const filtered = prev.filter(dog => dog._id !== update.id);\n                    console.log('[DogList] Dog list after removal:', filtered);\n                    return filtered;\n                  });\n                  if (selectedDog && selectedDog._id === update.id) setSelectedDog(null);\n                  // Always refetch dogs after adoption actions to ensure correct state\n                  refetchDogs();\n                } else {\n                  refetchDogs();\n                  if (selectedDog && update && selectedDog._id === update._id) setSelectedDog(update);\n                }\n              }}\n              onViewDetails={(event) => {\n                const rect = event.currentTarget.getBoundingClientRect();\n                setModalPosition({\n                  x: rect.left + rect.width / 2,\n                  y: rect.top + rect.height / 2\n                });\n                setSelectedDog(d);\n              }}\n              onEdit={(event) => {\n                // Always set modal position to center for testing\n                setModalPosition({ x: window.innerWidth / 2, y: window.innerHeight / 2 });\n                handleEditDog(d);\n              }}\n              onRemove={() => handleRemoveDog(d)}\n            />\n          );\n        })}\n      </div>\n\n      {selectedDog && modalPosition && createPortal(\n        <div \n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            width: '100vw',\n            height: '100vh',\n            backgroundColor: 'rgba(0, 0, 0, 0.8)',\n            zIndex: 2147483647,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            padding: '2rem',\n            boxSizing: 'border-box'\n          }}\n          onClick={() => {\n            setSelectedDog(null);\n            setModalPosition(null);\n          }}\n        >\n          <div \n            style={{\n              backgroundColor: 'white',\n              borderRadius: '12px',\n              padding: '2rem',\n              maxWidth: '90vw',\n              maxHeight: '90vh',\n              overflowY: 'auto',\n              position: 'relative',\n              zIndex: 2147483647,\n              boxShadow: '0 20px 60px rgba(0,0,0,0.5)'\n            }}\n            onClick={e => e.stopPropagation()}\n          >\n            <button\n              style={{\n                position: 'absolute',\n                top: 15,\n                right: 15,\n                width: 56,\n                height: 56,\n                backgroundColor: '#e74c3c',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '50%',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                boxShadow: '0 4px 12px rgba(0,0,0,0.3)',\n                cursor: 'pointer',\n                zIndex: 2147483647,\n                padding: 0\n              }}\n              onClick={() => {\n                setSelectedDog(null);\n                setModalPosition(null);\n              }}\n              title={t('common.close')}\n              aria-label={t('common.close')}\n            >\n              <span style={{\n                fontSize: 40,\n                fontWeight: 900,\n                lineHeight: '56px',\n                width: '100%',\n                textAlign: 'center',\n                display: 'block',\n                userSelect: 'none',\n                letterSpacing: 2\n              }}>\n                \n              </span>\n            </button>\n            <DogDetails\n              {...selectedDog}\n              adoptionStatus={selectedDog?.adoptionStatus}\n              adoptionQueue={selectedDog?.adoptionQueue}\n              onDogUpdate={async update => {\n                // Always reload the full dog list and update selected dog with latest from backend\n                const getApiUrl = () => {\n                  if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n                  return 'http://localhost:3001';\n                };\n                const API_URL = getApiUrl();\n                setLoading(true);\n                setError(null);\n                try {\n                  const headers = { 'Content-Type': 'application/json' };\n                  if (token) headers['Authorization'] = `Bearer ${token}`;\n                  const res = await fetch(`${API_URL}/api/dogs`, { cache: 'no-store', headers });\n                  if (!res.ok) throw new Error(await res.text() || `Request failed (${res.status})`);\n                  const data = await res.json();\n                  setDogs(data);\n                  // Update selected dog with latest data\n                  if (update && update._id) {\n                    const latest = data.find((d: any) => d._id === update._id);\n                    setSelectedDog(latest || null);\n                  } else if (update && update.remove) {\n                    setSelectedDog(null);\n                  }\n                } catch (err: any) {\n                  setError(err.message || t('doglist.failedToLoad'));\n                } finally {\n                  setLoading(false);\n                }\n              }}\n              onDogChanged={async () => {\n                // Also reload the full dog list after adoption actions\n                const getApiUrl = () => {\n                  if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n                  return 'http://localhost:3001';\n                };\n                const API_URL = getApiUrl();\n                setLoading(true);\n                setError(null);\n                try {\n                  const headers = { 'Content-Type': 'application/json' };\n                  if (token) headers['Authorization'] = `Bearer ${token}`;\n                  const res = await fetch(`${API_URL}/api/dogs`, { cache: 'no-store', headers });\n                  if (!res.ok) throw new Error(await res.text() || `Request failed (${res.status})`);\n                  const data = await res.json();\n                  setDogs(data);\n                  // If a dog is selected, update it\n                  if (selectedDog && selectedDog._id) {\n                    const latest = data.find((d: any) => d._id === selectedDog._id);\n                    setSelectedDog(latest || null);\n                  }\n                } catch (err: any) {\n                  setError(err.message || t('doglist.failedToLoad'));\n                } finally {\n                  setLoading(false);\n                }\n              }}\n              onClose={() => {\n                setSelectedDog(null);\n                setModalPosition(null);\n              }}\n            />\n          </div>\n        </div>,\n        document.body\n      )}\n\n      {editDog && modalPosition && createPortal(\n        <EditDogModal\n          dog={editDog}\n          onSave={async (updatedDog) => {\n            console.log('[DogList] onSave called from EditDogModal', updatedDog);\n            // Update the dog list and also update editDog so modal receives new images\n            await handleSaveEditDog(updatedDog);\n            // Force refresh the full dog list after save to ensure images update everywhere\n            const getApiUrl = () => {\n              if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n              return 'http://localhost:3001';\n            };\n            const API_URL = getApiUrl();\n            let latestDog = updatedDog;\n            try {\n              // Fetch the latest dog data for the edited dog\n              const res = await fetch(`${API_URL}/api/dogs/${updatedDog._id}`);\n              if (res.ok) {\n                latestDog = await res.json();\n              }\n              // Fetch the full dog list and update state\n              const listRes = await fetch(`${API_URL}/api/dogs`, { cache: 'no-store' });\n              if (listRes.ok) {\n                const data = await listRes.json();\n                setDogs(data);\n              }\n            } catch (err) {\n              console.error('DogList: Failed to refresh dog list after save', err);\n            }\n            // Always keep modal open with updated dog after save\n            setEditDog(latestDog);\n            setModalPosition(modalPosition); // keep modal position unchanged\n            // Never set selectedDog here; only update editDog and refresh list\n            console.log('[DogList] setEditDog called with latestDog (modal stays open)', latestDog);\n          }}\n          isSingleDog={dogs.length === 1}\n        />, \n        document.body\n      )}\n    </main>\n  );\n\n  // Handler for editing a dog\n  function handleEditDog(dog: Dog) {\n    console.log('[DogList] handleEditDog called with:', dog);\n    setEditDog(dog);\n  }\n\n  // Handler for saving an edited dog\n  async function handleSaveEditDog(updatedDog: Dog) {\n    console.log('[DogList] handleSaveEditDog called with:', updatedDog);\n    // Re-fetch the full dog list after editing\n    const getApiUrl = () => {\n      if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n      return 'http://localhost:3001';\n    };\n    const API_URL = getApiUrl();\n    setLoading(true);\n    setError(null);\n    try {\n      const headers: any = { 'Content-Type': 'application/json' };\n      if (token) headers['Authorization'] = `Bearer ${token}`;\n      // Always fetch the latest dog data after update\n      const res = await fetch(`${API_URL}/api/dogs`, { cache: 'no-store', headers });\n      if (!res.ok) throw new Error(await res.text() || `Request failed (${res.status})`);\n      const data = await res.json();\n      setDogs(data);\n      // Do not set selectedDog here; only update editDog and refresh dog list\n    } catch (err: any) {\n      setError(err.message || t('doglist.failedToLoad'));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  // Handler for removing a dog\n  async function handleRemoveDog(dog: Dog) {\n    if (!window.confirm(t('doglist.confirmRemove', { name: dog.name }))) return;\n    try {\n      // Debug auth context values\n      console.log('Delete request - Auth context values:', {\n        user: user,\n        token: token,\n        isAuthenticated: isAuthenticated,\n        localStorageToken: localStorage.getItem('token'),\n        localStorageUser: localStorage.getItem('user')\n      });\n      \n      const getApiUrl = () => {\n        if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n        return 'http://localhost:3001';\n      };\n      const API_URL = getApiUrl();\n      \n      const headers: any = {\n        'Content-Type': 'application/json'\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('Delete request - Using token:', token.substring(0, 20) + '...');\n      } else {\n        console.error('Delete request - No token available!');\n      }\n      \n      console.log('Delete request details:', {\n        url: `${API_URL}/api/dogs/${dog._id}`,\n        method: 'DELETE',\n        headers,\n        dogId: dog._id,\n        dogName: dog.name\n      });\n      \n      const resp = await fetch(`${API_URL}/api/dogs/${dog._id}`, { \n        method: 'DELETE',\n        headers \n      });\n      \n      console.log('Delete response status:', resp.status);\n      if (!resp.ok) {\n        const errorText = await resp.text();\n        console.error('Delete failed:', resp.status, errorText);\n        throw new Error(`${resp.status}: ${errorText}`);\n      }\n      \n      console.log('Delete successful, removing from UI');\n      setDogs(dogs => dogs.filter(d => d._id !== dog._id));\n      // Close modals if open for this dog\n      setEditDog(editDog => (editDog && editDog._id === dog._id ? null : editDog));\n      setSelectedDog(selectedDog => (selectedDog && selectedDog._id === dog._id ? null : selectedDog));\n    } catch (err: any) {\n      console.error('Delete error details:', err);\n      alert(err.message || t('doglist.failedToRemove'));\n    }\n  }\n\n};\n\nexport default DogList;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}