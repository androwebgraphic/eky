{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// Simple, reliable API URL for mobile\nconst API_URL = process.env.REACT_APP_API_URL || (window.location.protocol === 'https:' ? `https://${window.location.hostname}` : window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' ? 'http://localhost:3001' : 'http://172.20.10.2:3001');\nconst AdddogForm = () => {\n  _s();\n  const {\n    t\n  } = useTranslation();\n  const {\n    token,\n    isAuthenticated\n  } = useAuth();\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', {\n      isAuthenticated,\n      hasToken: !!token,\n      tokenLength: token === null || token === void 0 ? void 0 : token.length\n    });\n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n  const [mediaFile, setMediaFile] = useState(null);\n  const [mediaPreview, setMediaPreview] = useState(null);\n  const [smallPreview, setSmallPreview] = useState(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = file => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob(blob => {\n          cleanup();\n          if (blob) resolve(blob);else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = e => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file, size = 64) => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = e => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n  const onFileChange = async e => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try {\n        URL.revokeObjectURL(mediaPreview);\n      } catch (err) {/* ignore */}\n    }\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState(null);\n  const [successMessage, setSuccessMessage] = useState(null);\n  const abortControllerRef = useRef(null);\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n  const onSubmit = async fields => {\n    var _fields$name, _fields$location;\n    console.log('Form submit triggered with fields:', fields);\n\n    // Basic validation\n    if (!((_fields$name = fields.name) !== null && _fields$name !== void 0 && _fields$name.trim())) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!((_fields$location = fields.location) !== null && _fields$location !== void 0 && _fields$location.trim())) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', {\n            type: 'image/jpeg'\n          });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      abortControllerRef.current = new AbortController();\n      const headers = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      }).catch(async firstError => {\n        // If initial fetch fails on mobile, try fallback URLs\n        console.warn('First fetch failed, trying fallback:', firstError.message);\n        const fallbackUrls = ['http://172.20.10.2:3001/api/dogs',\n        // Direct IP\n        'http://localhost:3001/api/dogs' // Localhost fallback\n        ];\n        for (const fallbackUrl of fallbackUrls) {\n          try {\n            console.log('Trying fallback URL:', fallbackUrl);\n            const fallbackResp = await fetch(fallbackUrl, {\n              method: 'POST',\n              body: formData,\n              signal: abortControllerRef.current.signal,\n              headers\n            });\n            console.log('Fallback succeeded:', fallbackUrl);\n            return fallbackResp;\n          } catch (fallbackError) {\n            console.warn('Fallback failed:', fallbackUrl, fallbackError.message);\n          }\n        }\n\n        // If all fallbacks fail, throw the original error\n        throw firstError;\n      });\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => {\n          if (isMountedRef.current) navigate('/psi');\n        }, 1400);\n      }\n    } catch (err) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: t('adddog.title')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: '#f0f0f0',\n        padding: '8px',\n        margin: '8px 0',\n        fontSize: '11px',\n        borderRadius: '4px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Debug:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this), \" API_URL = \", API_URL, \" | hostname = \", window.location.hostname]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"adddog-form\",\n      onSubmit: handleSubmit(onSubmit),\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-name\",\n        children: t('adddog.name')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-name\",\n        name: \"name\",\n        autoComplete: \"name\",\n        placeholder: t('adddog.name'),\n        ...register('name', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), errors.name && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        role: \"alert\",\n        children: [t('adddog.name'), \" is required\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-breed\",\n        children: t('adddog.breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-breed\",\n        name: \"breed\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.breed'),\n        ...register('breed')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-color\",\n        children: t('adddog.color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-color\",\n        name: \"color\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.color'),\n        ...register('color')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-location\",\n        children: t('adddog.location')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"adddog-location\",\n        name: \"location\",\n        autoComplete: \"address-level2\",\n        placeholder: t('adddog.location'),\n        ...register('location', {\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-age\",\n        children: t('adddog.age')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n        children: t('adddogExtra.ageNote')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        id: \"adddog-age\",\n        name: \"age\",\n        autoComplete: \"off\",\n        placeholder: t('adddog.age'),\n        step: \"0.1\",\n        ...register('age', {\n          valueAsNumber: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-description\",\n        children: t('adddog.description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        id: \"adddog-description\",\n        name: \"description\",\n        rows: 3,\n        cols: 30,\n        autoComplete: \"off\",\n        placeholder: t('adddog.description'),\n        ...register('description')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"adddog-size\",\n        children: t('adddog.size')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        ...register('size'),\n        id: \"adddog-size\",\n        name: \"size\",\n        autoComplete: \"off\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"small\",\n          children: t('size.small')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"medium\",\n          children: t('size.medium')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"large\",\n          children: t('size.large')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"gender\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: t('adddog.gender')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"gender-options\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-male\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-male\",\n              name: \"gender\",\n              value: \"male\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.male')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"adddog-gender-female\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ...register('gender'),\n              id: \"adddog-gender-female\",\n              name: \"gender\",\n              value: \"female\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: t('gender.female')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"health\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-vaccinated\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.vaccinated')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('vaccinated'),\n            id: \"adddog-vaccinated\",\n            name: \"vaccinated\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"adddog-neutered\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: t('adddog.neutered')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            ...register('neutered'),\n            id: \"adddog-neutered\",\n            name: \"neutered\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"media-upload\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"media\",\n          children: t('adddog.media')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"media-input-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"image/*,video/*\",\n            id: \"adddog-media\",\n            name: \"media\",\n            onChange: onFileChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 13\n          }, this), smallPreview && /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"thumb-small\",\n            src: smallPreview,\n            alt: \"thumb\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 11\n        }, this), mediaPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"media-preview\",\n          children: isVideo ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"preview-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              src: mediaPreview,\n              controls: true,\n              width: 150,\n              poster: smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"view-full\",\n              onClick: () => window.open(mediaPreview, '_blank'),\n              children: \"View full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"preview-wrap\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: smallPreview || mediaPreview,\n              alt: \"preview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"view-full\",\n              onClick: () => window.open(mediaPreview, '_blank'),\n              children: \"View full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: submitting,\n          children: submitting ? t('adddog.saving') : t('button.addDog')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 11\n        }, this), submitError && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error\",\n          role: \"alert\",\n          children: submitError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 27\n        }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification success\",\n          role: \"status\",\n          children: successMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 30\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 325,\n    columnNumber: 5\n  }, this);\n};\n_s(AdddogForm, \"SkNTYFF5NUJdUc/D6GovgRNZZ7w=\", false, function () {\n  return [useTranslation, useAuth, useForm, useNavigate];\n});\n_c = AdddogForm;\nexport default AdddogForm;\nvar _c;\n$RefreshReg$(_c, \"AdddogForm\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","useTranslation","useNavigate","useAuth","jsxDEV","_jsxDEV","API_URL","process","env","REACT_APP_API_URL","window","location","protocol","hostname","AdddogForm","_s","t","token","isAuthenticated","register","handleSubmit","formState","errors","defaultValues","vaccinated","neutered","navigate","isMountedRef","console","log","hasToken","tokenLength","length","warn","current","mediaFile","setMediaFile","mediaPreview","setMediaPreview","smallPreview","setSmallPreview","isVideo","setIsVideo","posterBlob","setPosterBlob","createVideoPoster","file","Promise","resolve","reject","url","URL","createObjectURL","video","document","createElement","preload","muted","src","currentTime","cleanup","revokeObjectURL","onloadeddata","canvas","width","videoWidth","height","videoHeight","ctx","getContext","Error","drawImage","toBlob","blob","onerror","e","createImageThumbnail","size","img","Image","onload","ratio","Math","round","dataUrl","toDataURL","onFileChange","f","target","files","startsWith","err","type","poster","thumb","submitting","setSubmitting","submitError","setSubmitError","successMessage","setSuccessMessage","abortControllerRef","abort","onSubmit","fields","_fields$name","_fields$location","name","trim","href","formData","FormData","append","breed","color","age","undefined","String","description","posterFile","File","Object","fromEntries","entries","substring","AbortController","headers","error","resp","fetch","method","body","signal","catch","firstError","message","fallbackUrls","fallbackUrl","fallbackResp","fallbackError","ok","errMsg","status","statusText","json","JSON","stringify","txt","text","setTimeout","errorMessage","children","fileName","_jsxFileName","lineNumber","columnNumber","style","background","padding","margin","fontSize","borderRadius","id","htmlFor","autoComplete","placeholder","required","className","role","step","valueAsNumber","rows","cols","value","accept","onChange","alt","controls","onClick","open","disabled","_c","$RefreshReg$"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface AddDogFormData {\n  name: string;\n  breed: string;\n  color?: string;\n  location: string;\n  age: number;\n  description: string;\n  size: 'small' | 'medium' | 'large';\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n}\n\n// Simple, reliable API URL for mobile\nconst API_URL = process.env.REACT_APP_API_URL ||\n  (window.location.protocol === 'https:'\n    ? `https://${window.location.hostname}`\n    : (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'\n      ? 'http://localhost:3001'\n      : 'http://172.20.10.2:3001'));\n\nconst AdddogForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { token, isAuthenticated } = useAuth();\n  const { register, handleSubmit, formState: { errors } } = useForm<AddDogFormData>({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false,\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', { isAuthenticated, hasToken: !!token, tokenLength: token?.length });\n    \n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  const [mediaFile, setMediaFile] = useState<File | null>(null);\n  const [mediaPreview, setMediaPreview] = useState<string | null>(null);\n  const [smallPreview, setSmallPreview] = useState<string | null>(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState<Blob | null>(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = (file: File): Promise<Blob> => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob((blob) => {\n          cleanup();\n          if (blob) resolve(blob);\n          else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = (e) => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file: File, size = 64): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = (e) => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  const onFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try { URL.revokeObjectURL(mediaPreview); } catch (err) { /* ignore */ }\n    }\n\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n\n  const onSubmit: SubmitHandler<AddDogFormData> = async (fields) => {\n    console.log('Form submit triggered with fields:', fields);\n    \n    // Basic validation\n    if (!fields.name?.trim()) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!fields.location?.trim()) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    \n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', { type: 'image/jpeg' });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      \n      abortControllerRef.current = new AbortController();\n      \n      const headers: any = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      \n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      }).catch(async (firstError) => {\n        // If initial fetch fails on mobile, try fallback URLs\n        console.warn('First fetch failed, trying fallback:', firstError.message);\n        \n        const fallbackUrls = [\n          'http://172.20.10.2:3001/api/dogs',  // Direct IP\n          'http://localhost:3001/api/dogs'      // Localhost fallback\n        ];\n        \n        for (const fallbackUrl of fallbackUrls) {\n          try {\n            console.log('Trying fallback URL:', fallbackUrl);\n            const fallbackResp = await fetch(fallbackUrl, {\n              method: 'POST',\n              body: formData,\n              signal: abortControllerRef.current.signal,\n              headers\n            });\n            console.log('Fallback succeeded:', fallbackUrl);\n            return fallbackResp;\n          } catch (fallbackError) {\n            console.warn('Fallback failed:', fallbackUrl, fallbackError.message);\n          }\n        }\n        \n        // If all fallbacks fail, throw the original error\n        throw firstError;\n      });\n\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => { \n          if (isMountedRef.current) navigate('/psi'); \n        }, 1400);\n      }\n    } catch (err: any) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      \n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      \n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      \n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n\n  return (\n    <main>\n      <h2>{t('adddog.title')}</h2>\n      {/* Temporary debug info */}\n      <div style={{background: '#f0f0f0', padding: '8px', margin: '8px 0', fontSize: '11px', borderRadius: '4px'}}>\n        <strong>Debug:</strong> API_URL = {API_URL} | hostname = {window.location.hostname}\n      </div>\n      \n      <form id=\"adddog-form\" onSubmit={handleSubmit(onSubmit)}>\n        <label htmlFor=\"adddog-name\">{t('adddog.name')}</label>\n        <input type=\"text\" id=\"adddog-name\" name=\"name\" autoComplete=\"name\" placeholder={t('adddog.name')} {...register('name', { required: true })} />\n        {errors.name && <div className=\"error\" role=\"alert\">{t('adddog.name')} is required</div> }\n\n        <label htmlFor=\"adddog-breed\">{t('adddog.breed')}</label>\n        <input type=\"text\" id=\"adddog-breed\" name=\"breed\" autoComplete=\"off\" placeholder={t('adddog.breed')} {...register('breed')} />\n\n        <label htmlFor=\"adddog-color\">{t('adddog.color')}</label>\n        <input type=\"text\" id=\"adddog-color\" name=\"color\" autoComplete=\"off\" placeholder={t('adddog.color')} {...register('color')} />\n\n        <label htmlFor=\"adddog-location\">{t('adddog.location')}</label>\n        <input type=\"text\" id=\"adddog-location\" name=\"location\" autoComplete=\"address-level2\" placeholder={t('adddog.location')} {...register('location', { required: true })} />\n\n        <label htmlFor=\"adddog-age\">{t('adddog.age')}</label>\n        <small>{t('adddogExtra.ageNote')}</small>\n        <input type=\"number\" id=\"adddog-age\" name=\"age\" autoComplete=\"off\" placeholder={t('adddog.age')} step=\"0.1\" {...register('age', { valueAsNumber: true })} />\n\n        <label htmlFor=\"adddog-description\">{t('adddog.description')}</label>\n        <textarea id=\"adddog-description\" name=\"description\" rows={3} cols={30} autoComplete=\"off\" placeholder={t('adddog.description')} {...register('description')} />\n\n        <label htmlFor=\"adddog-size\">{t('adddog.size')}</label>\n        <select {...register('size')} id=\"adddog-size\" name=\"size\" autoComplete=\"off\">\n          <option value=\"small\">{t('size.small')}</option>\n          <option value=\"medium\">{t('size.medium')}</option>\n          <option value=\"large\">{t('size.large')}</option>\n        </select>\n\n        <div id=\"gender\">\n          <label>{t('adddog.gender')}</label>\n          <div className=\"gender-options\">\n            <label htmlFor=\"adddog-gender-male\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-male\" name=\"gender\" value=\"male\" />\n              <span>{t('gender.male')}</span>\n            </label>\n            <label htmlFor=\"adddog-gender-female\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-female\" name=\"gender\" value=\"female\" />\n              <span>{t('gender.female')}</span>\n            </label>\n          </div>\n        </div>\n\n        <div id=\"health\">\n          <label htmlFor=\"adddog-vaccinated\">\n            <span>{t('adddog.vaccinated')}</span>\n            <input type=\"checkbox\" {...register('vaccinated')} id=\"adddog-vaccinated\" name=\"vaccinated\" />\n          </label>\n\n          <label htmlFor=\"adddog-neutered\">\n            <span>{t('adddog.neutered')}</span>\n            <input type=\"checkbox\" {...register('neutered')} id=\"adddog-neutered\" name=\"neutered\" />\n          </label>\n        </div>\n\n        <div id=\"media-upload\">\n          <label htmlFor=\"media\">{t('adddog.media')}</label>\n          <div className=\"media-input-row\">\n            <input type=\"file\" accept=\"image/*,video/*\" id=\"adddog-media\" name=\"media\" onChange={onFileChange} />\n            {smallPreview && <img className=\"thumb-small\" src={smallPreview} alt=\"thumb\" />}\n          </div>\n          {mediaPreview && (\n            <div id=\"media-preview\">\n              {isVideo ? (\n                <div className=\"preview-wrap\">\n                  <video src={mediaPreview} controls width={150} poster={smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)}></video>\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              ) : (\n                <div className=\"preview-wrap\">\n                  <img src={smallPreview || mediaPreview} alt=\"preview\" />\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"form-actions\">\n          <button type=\"submit\" disabled={submitting}>{submitting ? t('adddog.saving') : t('button.addDog')}</button>\n          {submitError && <div className=\"error\" role=\"alert\">{submitError}</div>}\n          {successMessage && <div className=\"notification success\" role=\"status\">{successMessage}</div>}\n        </div>\n      </form>\n    </main>\n  );\n};\n\nexport default AdddogForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}