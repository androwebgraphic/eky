{"ast":null,"code":"import _objectSpread from\"/Applications/MAMP/htdocs/eky/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{useForm}from'react-hook-form';import{useTranslation}from'react-i18next';import{useNavigate}from'react-router-dom';import{useAuth}from'../../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";// Use API URL from environment, fallback to localhost:3002\nconst API_URL=process.env.REACT_APP_API_URL||'http://localhost:3002';const AdddogForm=()=>{const{t}=useTranslation();const{token,isAuthenticated}=useAuth();const{register,handleSubmit,formState:{errors}}=useForm({defaultValues:{vaccinated:false,neutered:false}});const navigate=useNavigate();const isMountedRef=useRef(true);useEffect(()=>{console.log('ðŸ” AddDogForm auth state:',{isAuthenticated,hasToken:!!token,tokenLength:token===null||token===void 0?void 0:token.length});if(!isAuthenticated||!token){console.warn('âš ï¸ User not authenticated, redirecting to login');navigate('/logiranje');}},[isAuthenticated,token,navigate]);useEffect(()=>{return()=>{isMountedRef.current=false;};},[]);const[mediaFile,setMediaFile]=useState(null);const[mediaPreview,setMediaPreview]=useState(null);const[smallPreview,setSmallPreview]=useState(null);const[isVideo,setIsVideo]=useState(false);const[posterBlob,setPosterBlob]=useState(null);const[mediaError,setMediaError]=useState(null);// create poster image for a video file by capturing first frame in browser\nconst createVideoPoster=file=>{return new Promise((resolve,reject)=>{const url=URL.createObjectURL(file);const video=document.createElement('video');video.preload='metadata';video.muted=true;video.src=url;// attempt to jump to 1s so a frame is available\nvideo.currentTime=1;const cleanup=()=>URL.revokeObjectURL(url);video.onloadeddata=function(){const canvas=document.createElement('canvas');canvas.width=video.videoWidth||640;canvas.height=video.videoHeight||360;const ctx=canvas.getContext('2d');if(!ctx)return reject(new Error('Canvas not supported'));ctx.drawImage(video,0,0,canvas.width,canvas.height);canvas.toBlob(blob=>{cleanup();if(blob)resolve(blob);else reject(new Error('Could not create poster'));},'image/jpeg',0.8);};video.onerror=e=>{cleanup();reject(e);};});};// create a small thumbnail for image preview (data URL)\nconst createImageThumbnail=function(file){let size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:64;return new Promise((resolve,reject)=>{const img=new Image();const url=URL.createObjectURL(file);img.onload=()=>{const ratio=img.width/img.height||1;let width=size;let height=Math.round(size/ratio);if(ratio<1){// portrait\nheight=size;width=Math.round(size*ratio);}const canvas=document.createElement('canvas');canvas.width=width;canvas.height=height;const ctx=canvas.getContext('2d');if(!ctx){URL.revokeObjectURL(url);return reject(new Error('Canvas not supported'));}ctx.drawImage(img,0,0,width,height);const dataUrl=canvas.toDataURL('image/jpeg',0.7);URL.revokeObjectURL(url);resolve(dataUrl);};img.onerror=e=>{URL.revokeObjectURL(url);reject(e);};img.src=url;});};const onFileChange=async e=>{const f=e.target.files&&e.target.files[0];if(!f)return;setMediaFile(f);// revoke previous object URL if necessary\nif(mediaPreview&&mediaPreview.startsWith('blob:')){try{URL.revokeObjectURL(mediaPreview);}catch(err){/* ignore */}}const url=URL.createObjectURL(f);setMediaPreview(url);if(f.type.startsWith('video/')){setIsVideo(true);setSmallPreview(null);try{const poster=await createVideoPoster(f);setPosterBlob(poster);}catch(err){console.warn('Could not create poster image',err);}}else{setIsVideo(false);try{const thumb=await createImageThumbnail(f,64);setSmallPreview(thumb);}catch(err){console.warn('Could not create thumbnail',err);setSmallPreview(null);}}};const[submitting,setSubmitting]=useState(false);const[submitError,setSubmitError]=useState(null);const[successMessage,setSuccessMessage]=useState(null);const abortControllerRef=useRef(null);useEffect(()=>{return()=>{isMountedRef.current=false;// Cancel any pending fetch requests\nif(abortControllerRef.current){abortControllerRef.current.abort();}};},[]);const onSubmit=async fields=>{var _fields$name,_fields$location;console.log('Form submit triggered with fields:',fields);// Basic validation\nif(!((_fields$name=fields.name)!==null&&_fields$name!==void 0&&_fields$name.trim())){setSubmitError(t('adddog.nameRequired'));return;}if(!((_fields$location=fields.location)!==null&&_fields$location!==void 0&&_fields$location.trim())){setSubmitError(t('adddog.locationRequired'));return;}if(!mediaFile){setMediaError(t('adddog.mediaRequired')||'Image is required');return;}else{setMediaError(null);}try{setSubmitting(true);setSubmitError(null);console.log('Form data will be sent to:',API_URL);console.log('Current hostname:',window.location.hostname);console.log('Window location:',window.location.href);const formData=new FormData();formData.append('name',fields.name);if(fields.breed)formData.append('breed',fields.breed);if(fields.color)formData.append('color',fields.color);if(fields.age!==undefined)formData.append('age',String(fields.age));if(fields.description)formData.append('description',fields.description);if(fields.size)formData.append('size',fields.size);if(fields.location)formData.append('location',fields.location);// Always send boolean values for checkboxes\nformData.append('vaccinated',fields.vaccinated?'true':'false');formData.append('neutered',fields.neutered?'true':'false');if(mediaFile){formData.append('media',mediaFile,mediaFile.name);if(posterBlob){const posterFile=new File([posterBlob],'poster.jpg',{type:'image/jpeg'});formData.append('poster',posterFile,'poster.jpg');}}console.log('Submitting to:',\"\".concat(API_URL,\"/api/dogs\"));console.log('Form data fields:',Object.fromEntries(formData.entries()));console.log('Media file present:',!!mediaFile);console.log('ðŸ”‘ Token present:',!!token);console.log('ðŸ”‘ Token value:',token?\"\".concat(token.substring(0,20),\"...\"):'NO TOKEN');abortControllerRef.current=new AbortController();const headers={// Don't set Content-Type for FormData, let browser set it with boundary\n};if(token){headers['Authorization']=\"Bearer \".concat(token);console.log('âœ… Authorization header set');}else{console.error('âŒ NO TOKEN - Authorization header NOT set');}const resp=await fetch(\"\".concat(API_URL,\"/api/dogs\"),{method:'POST',body:formData,signal:abortControllerRef.current.signal,headers});if(!resp.ok){// try to get JSON message\nlet errMsg=\"Upload failed with status \".concat(resp.status,\" (\").concat(resp.statusText,\")\");console.error('Response not OK:',resp.status,resp.statusText);try{const body=await resp.json();console.error('Error body:',body);errMsg=body.message||JSON.stringify(body);}catch(e){console.error('Could not parse error as JSON:',e);const txt=await resp.text();console.error('Error text:',txt);if(txt)errMsg=txt.substring(0,200);// limit error message length\n}console.error('API error:',errMsg);setSubmitError(errMsg);throw new Error(errMsg);}// success â†’ show confirmation and then go to list\nif(isMountedRef.current){setSuccessMessage(t('adddog.added'));// keep message visible briefly before navigating\nsetTimeout(()=>{if(isMountedRef.current)navigate('/psi');},1400);}}catch(err){// Ignore abort errors (expected when component unmounts)\nif(err.name==='AbortError'){console.log('Request was aborted (component unmounted)');return;}console.error('Add dog failed:',err);console.error('Error type:',err.name);console.error('Error message:',err.message);console.error('Full error:',err);let errorMessage=t('adddog.failed');if(err.message){errorMessage+=\": \".concat(err.message);}if(isMountedRef.current&&!submitError){setSubmitError(errorMessage);}}finally{if(isMountedRef.current)setSubmitting(false);}};return/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:t('adddog.title')}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f0f0f0',padding:'8px',margin:'8px 0',fontSize:'11px',borderRadius:'4px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Debug:\"}),\" API_URL = \",API_URL,\" | hostname = \",window.location.hostname]}),/*#__PURE__*/_jsxs(\"form\",{id:\"adddog-form\",onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-name\",children:t('adddog.name')}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",id:\"adddog-name\",name:\"name\",autoComplete:\"name\",placeholder:t('adddog.name')},register('name',{required:true}))),errors.name&&/*#__PURE__*/_jsxs(\"div\",{className:\"error\",role:\"alert\",children:[t('adddog.name'),\" is required\"]}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-breed\",children:t('adddog.breed')}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",id:\"adddog-breed\",name:\"breed\",autoComplete:\"off\",placeholder:t('adddog.breed')},register('breed'))),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-color\",children:t('adddog.color')}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",id:\"adddog-color\",name:\"color\",autoComplete:\"off\",placeholder:t('adddog.color')},register('color'))),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-location\",children:t('adddog.location')}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",id:\"adddog-location\",name:\"location\",autoComplete:\"address-level2\",placeholder:t('adddog.location')},register('location',{required:true}))),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-age\",children:t('adddog.age')}),/*#__PURE__*/_jsx(\"small\",{children:t('adddogExtra.ageNote')}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"number\",id:\"adddog-age\",name:\"age\",autoComplete:\"off\",placeholder:t('adddog.age'),step:\"0.1\"},register('age',{valueAsNumber:true}))),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-description\",children:t('adddog.description')}),/*#__PURE__*/_jsx(\"textarea\",_objectSpread({id:\"adddog-description\",name:\"description\",rows:3,cols:30,autoComplete:\"off\",placeholder:t('adddog.description')},register('description'))),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adddog-size\",children:t('adddog.size')}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({},register('size')),{},{id:\"adddog-size\",name:\"size\",autoComplete:\"off\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"small\",children:t('size.small')}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:t('size.medium')}),/*#__PURE__*/_jsx(\"option\",{value:\"large\",children:t('size.large')})]})),/*#__PURE__*/_jsxs(\"div\",{id:\"gender\",children:[/*#__PURE__*/_jsx(\"label\",{children:t('adddog.gender')}),/*#__PURE__*/_jsxs(\"div\",{className:\"gender-options\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"adddog-gender-male\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"radio\"},register('gender')),{},{id:\"adddog-gender-male\",name:\"gender\",value:\"male\"})),/*#__PURE__*/_jsx(\"span\",{children:t('gender.male')})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"adddog-gender-female\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"radio\"},register('gender')),{},{id:\"adddog-gender-female\",name:\"gender\",value:\"female\"})),/*#__PURE__*/_jsx(\"span\",{children:t('gender.female')})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"health\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"adddog-vaccinated\",children:[/*#__PURE__*/_jsx(\"span\",{children:t('adddog.vaccinated')}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"checkbox\"},register('vaccinated')),{},{id:\"adddog-vaccinated\",name:\"vaccinated\"}))]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"adddog-neutered\",children:[/*#__PURE__*/_jsx(\"span\",{children:t('adddog.neutered')}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"checkbox\"},register('neutered')),{},{id:\"adddog-neutered\",name:\"neutered\"}))]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"media-upload\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"media\",children:t('adddog.media')}),/*#__PURE__*/_jsxs(\"div\",{className:\"media-input-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*,video/*\",id:\"adddog-media\",name:\"media\",onChange:onFileChange}),smallPreview&&/*#__PURE__*/_jsx(\"img\",{className:\"thumb-small\",src:smallPreview,alt:\"thumb\"})]}),mediaError&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",role:\"alert\",style:{color:'red',marginTop:4},children:mediaError}),mediaPreview&&/*#__PURE__*/_jsx(\"div\",{id:\"media-preview\",children:isVideo?/*#__PURE__*/_jsxs(\"div\",{className:\"preview-wrap\",children:[/*#__PURE__*/_jsx(\"video\",{src:mediaPreview,controls:true,width:150,poster:smallPreview||(posterBlob?URL.createObjectURL(posterBlob):undefined)}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"view-full\",onClick:()=>window.open(mediaPreview,'_blank'),children:\"View full\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"preview-wrap\",children:[/*#__PURE__*/_jsx(\"img\",{src:smallPreview||mediaPreview,alt:\"preview\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"view-full\",onClick:()=>window.open(mediaPreview,'_blank'),children:\"View full\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitting,children:submitting?t('adddog.saving'):t('button.addDog')}),submitError&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",role:\"alert\",children:submitError}),successMessage&&/*#__PURE__*/_jsx(\"div\",{className:\"notification success\",role:\"status\",children:successMessage})]})]})]});};export default AdddogForm;","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","useTranslation","useNavigate","useAuth","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","AdddogForm","t","token","isAuthenticated","register","handleSubmit","formState","errors","defaultValues","vaccinated","neutered","navigate","isMountedRef","console","log","hasToken","tokenLength","length","warn","current","mediaFile","setMediaFile","mediaPreview","setMediaPreview","smallPreview","setSmallPreview","isVideo","setIsVideo","posterBlob","setPosterBlob","mediaError","setMediaError","createVideoPoster","file","Promise","resolve","reject","url","URL","createObjectURL","video","document","createElement","preload","muted","src","currentTime","cleanup","revokeObjectURL","onloadeddata","canvas","width","videoWidth","height","videoHeight","ctx","getContext","Error","drawImage","toBlob","blob","onerror","e","createImageThumbnail","size","arguments","undefined","img","Image","onload","ratio","Math","round","dataUrl","toDataURL","onFileChange","f","target","files","startsWith","err","type","poster","thumb","submitting","setSubmitting","submitError","setSubmitError","successMessage","setSuccessMessage","abortControllerRef","abort","onSubmit","fields","_fields$name","_fields$location","name","trim","location","window","hostname","href","formData","FormData","append","breed","color","age","String","description","posterFile","File","concat","Object","fromEntries","entries","substring","AbortController","headers","error","resp","fetch","method","body","signal","ok","errMsg","status","statusText","json","message","JSON","stringify","txt","text","setTimeout","errorMessage","children","style","background","padding","margin","fontSize","borderRadius","id","htmlFor","_objectSpread","autoComplete","placeholder","required","className","role","step","valueAsNumber","rows","cols","value","accept","onChange","alt","marginTop","controls","onClick","open","disabled"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/pages/AdddogForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface AddDogFormData {\n  name: string;\n  breed: string;\n  color?: string;\n  location: string;\n  age: number;\n  description: string;\n  size: 'small' | 'medium' | 'large';\n  gender?: 'male' | 'female';\n  vaccinated?: boolean;\n  neutered?: boolean;\n}\n\n// Use API URL from environment, fallback to localhost:3002\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:3002';\n\nconst AdddogForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { token, isAuthenticated } = useAuth();\n  const { register, handleSubmit, formState: { errors } } = useForm<AddDogFormData>({\n    defaultValues: {\n      vaccinated: false,\n      neutered: false,\n    }\n  });\n  const navigate = useNavigate();\n  const isMountedRef = useRef(true);\n\n  useEffect(() => {\n    console.log('ðŸ” AddDogForm auth state:', { isAuthenticated, hasToken: !!token, tokenLength: token?.length });\n    \n    if (!isAuthenticated || !token) {\n      console.warn('âš ï¸ User not authenticated, redirecting to login');\n      navigate('/logiranje');\n    }\n  }, [isAuthenticated, token, navigate]);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n\n  const [mediaFile, setMediaFile] = useState<File | null>(null);\n  const [mediaPreview, setMediaPreview] = useState<string | null>(null);\n  const [smallPreview, setSmallPreview] = useState<string | null>(null);\n  const [isVideo, setIsVideo] = useState(false);\n  const [posterBlob, setPosterBlob] = useState<Blob | null>(null);\n  const [mediaError, setMediaError] = useState<string | null>(null);\n\n  // create poster image for a video file by capturing first frame in browser\n  const createVideoPoster = (file: File): Promise<Blob> => {\n    return new Promise((resolve, reject) => {\n      const url = URL.createObjectURL(file);\n      const video = document.createElement('video');\n      video.preload = 'metadata';\n      video.muted = true;\n      video.src = url;\n      // attempt to jump to 1s so a frame is available\n      video.currentTime = 1;\n      const cleanup = () => URL.revokeObjectURL(url);\n\n      video.onloadeddata = function () {\n        const canvas = document.createElement('canvas');\n        canvas.width = video.videoWidth || 640;\n        canvas.height = video.videoHeight || 360;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) return reject(new Error('Canvas not supported'));\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        canvas.toBlob((blob) => {\n          cleanup();\n          if (blob) resolve(blob);\n          else reject(new Error('Could not create poster'));\n        }, 'image/jpeg', 0.8);\n      };\n      video.onerror = (e) => {\n        cleanup();\n        reject(e);\n      };\n    });\n  };\n\n  // create a small thumbnail for image preview (data URL)\n  const createImageThumbnail = (file: File, size = 64): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      img.onload = () => {\n        const ratio = img.width / img.height || 1;\n        let width = size;\n        let height = Math.round(size / ratio);\n        if (ratio < 1) {\n          // portrait\n          height = size;\n          width = Math.round(size * ratio);\n        }\n        const canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n          URL.revokeObjectURL(url);\n          return reject(new Error('Canvas not supported'));\n        }\n        ctx.drawImage(img, 0, 0, width, height);\n        const dataUrl = canvas.toDataURL('image/jpeg', 0.7);\n        URL.revokeObjectURL(url);\n        resolve(dataUrl);\n      };\n      img.onerror = (e) => {\n        URL.revokeObjectURL(url);\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  const onFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files && e.target.files[0];\n    if (!f) return;\n    setMediaFile(f);\n\n    // revoke previous object URL if necessary\n    if (mediaPreview && mediaPreview.startsWith('blob:')) {\n      try { URL.revokeObjectURL(mediaPreview); } catch (err) { /* ignore */ }\n    }\n\n    const url = URL.createObjectURL(f);\n    setMediaPreview(url);\n\n    if (f.type.startsWith('video/')) {\n      setIsVideo(true);\n      setSmallPreview(null);\n      try {\n        const poster = await createVideoPoster(f);\n        setPosterBlob(poster);\n      } catch (err) {\n        console.warn('Could not create poster image', err);\n      }\n    } else {\n      setIsVideo(false);\n      try {\n        const thumb = await createImageThumbnail(f, 64);\n        setSmallPreview(thumb);\n      } catch (err) {\n        console.warn('Could not create thumbnail', err);\n        setSmallPreview(null);\n      }\n    }\n  };\n\n  const [submitting, setSubmitting] = useState(false);\n  const [submitError, setSubmitError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  useEffect(() => {\n    return () => {\n      isMountedRef.current = false;\n      // Cancel any pending fetch requests\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n    };\n  }, []);\n\n  const onSubmit: SubmitHandler<AddDogFormData> = async (fields) => {\n    console.log('Form submit triggered with fields:', fields);\n    \n    // Basic validation\n    if (!fields.name?.trim()) {\n      setSubmitError(t('adddog.nameRequired'));\n      return;\n    }\n    if (!fields.location?.trim()) {\n      setSubmitError(t('adddog.locationRequired'));\n      return;\n    }\n    if (!mediaFile) {\n      setMediaError(t('adddog.mediaRequired') || 'Image is required');\n      return;\n    } else {\n      setMediaError(null);\n    }\n    \n    try {\n      setSubmitting(true);\n      setSubmitError(null);\n\n      console.log('Form data will be sent to:', API_URL);\n      console.log('Current hostname:', window.location.hostname);\n      console.log('Window location:', window.location.href);\n\n      const formData = new FormData();\n      formData.append('name', fields.name);\n      if (fields.breed) formData.append('breed', fields.breed);\n      if (fields.color) formData.append('color', fields.color);\n      if (fields.age !== undefined) formData.append('age', String(fields.age));\n      if (fields.description) formData.append('description', fields.description);\n      if (fields.size) formData.append('size', fields.size);\n      if (fields.location) formData.append('location', fields.location);\n\n      // Always send boolean values for checkboxes\n      formData.append('vaccinated', fields.vaccinated ? 'true' : 'false');\n      formData.append('neutered', fields.neutered ? 'true' : 'false');\n\n      if (mediaFile) {\n        formData.append('media', mediaFile, mediaFile.name);\n        if (posterBlob) {\n          const posterFile = new File([posterBlob], 'poster.jpg', { type: 'image/jpeg' });\n          formData.append('poster', posterFile, 'poster.jpg');\n        }\n      }\n\n      console.log('Submitting to:', `${API_URL}/api/dogs`);\n      console.log('Form data fields:', Object.fromEntries(formData.entries()));\n      console.log('Media file present:', !!mediaFile);\n      console.log('ðŸ”‘ Token present:', !!token);\n      console.log('ðŸ”‘ Token value:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n      \n      abortControllerRef.current = new AbortController();\n      \n      const headers: any = {\n        // Don't set Content-Type for FormData, let browser set it with boundary\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n        console.log('âœ… Authorization header set');\n      } else {\n        console.error('âŒ NO TOKEN - Authorization header NOT set');\n      }\n      \n      const resp = await fetch(`${API_URL}/api/dogs`, {\n        method: 'POST',\n        body: formData,\n        signal: abortControllerRef.current.signal,\n        headers\n      });\n\n      if (!resp.ok) {\n        // try to get JSON message\n        let errMsg = `Upload failed with status ${resp.status} (${resp.statusText})`;\n        console.error('Response not OK:', resp.status, resp.statusText);\n        try {\n          const body = await resp.json();\n          console.error('Error body:', body);\n          errMsg = body.message || JSON.stringify(body);\n        } catch (e) {\n          console.error('Could not parse error as JSON:', e);\n          const txt = await resp.text();\n          console.error('Error text:', txt);\n          if (txt) errMsg = txt.substring(0, 200); // limit error message length\n        }\n        console.error('API error:', errMsg);\n        setSubmitError(errMsg);\n        throw new Error(errMsg);\n      }\n\n      // success â†’ show confirmation and then go to list\n      if (isMountedRef.current) {\n        setSuccessMessage(t('adddog.added'));\n        // keep message visible briefly before navigating\n        setTimeout(() => { \n          if (isMountedRef.current) navigate('/psi'); \n        }, 1400);\n      }\n    } catch (err: any) {\n      // Ignore abort errors (expected when component unmounts)\n      if (err.name === 'AbortError') {\n        console.log('Request was aborted (component unmounted)');\n        return;\n      }\n      \n      console.error('Add dog failed:', err);\n      console.error('Error type:', err.name);\n      console.error('Error message:', err.message);\n      console.error('Full error:', err);\n      \n      let errorMessage = t('adddog.failed');\n      if (err.message) {\n        errorMessage += `: ${err.message}`;\n      }\n      \n      if (isMountedRef.current && !submitError) {\n        setSubmitError(errorMessage);\n      }\n    } finally {\n      if (isMountedRef.current) setSubmitting(false);\n    }\n  };\n\n  return (\n    <main>\n      <h2>{t('adddog.title')}</h2>\n      {/* Temporary debug info */}\n      <div style={{background: '#f0f0f0', padding: '8px', margin: '8px 0', fontSize: '11px', borderRadius: '4px'}}>\n        <strong>Debug:</strong> API_URL = {API_URL} | hostname = {window.location.hostname}\n      </div>\n      \n      <form id=\"adddog-form\" onSubmit={handleSubmit(onSubmit)}>\n        <label htmlFor=\"adddog-name\">{t('adddog.name')}</label>\n        <input type=\"text\" id=\"adddog-name\" name=\"name\" autoComplete=\"name\" placeholder={t('adddog.name')} {...register('name', { required: true })} />\n        {errors.name && <div className=\"error\" role=\"alert\">{t('adddog.name')} is required</div> }\n\n        <label htmlFor=\"adddog-breed\">{t('adddog.breed')}</label>\n        <input type=\"text\" id=\"adddog-breed\" name=\"breed\" autoComplete=\"off\" placeholder={t('adddog.breed')} {...register('breed')} />\n\n        <label htmlFor=\"adddog-color\">{t('adddog.color')}</label>\n        <input type=\"text\" id=\"adddog-color\" name=\"color\" autoComplete=\"off\" placeholder={t('adddog.color')} {...register('color')} />\n\n        <label htmlFor=\"adddog-location\">{t('adddog.location')}</label>\n        <input type=\"text\" id=\"adddog-location\" name=\"location\" autoComplete=\"address-level2\" placeholder={t('adddog.location')} {...register('location', { required: true })} />\n\n        <label htmlFor=\"adddog-age\">{t('adddog.age')}</label>\n        <small>{t('adddogExtra.ageNote')}</small>\n        <input type=\"number\" id=\"adddog-age\" name=\"age\" autoComplete=\"off\" placeholder={t('adddog.age')} step=\"0.1\" {...register('age', { valueAsNumber: true })} />\n\n        <label htmlFor=\"adddog-description\">{t('adddog.description')}</label>\n        <textarea id=\"adddog-description\" name=\"description\" rows={3} cols={30} autoComplete=\"off\" placeholder={t('adddog.description')} {...register('description')} />\n\n        <label htmlFor=\"adddog-size\">{t('adddog.size')}</label>\n        <select {...register('size')} id=\"adddog-size\" name=\"size\" autoComplete=\"off\">\n          <option value=\"small\">{t('size.small')}</option>\n          <option value=\"medium\">{t('size.medium')}</option>\n          <option value=\"large\">{t('size.large')}</option>\n        </select>\n\n        <div id=\"gender\">\n          <label>{t('adddog.gender')}</label>\n          <div className=\"gender-options\">\n            <label htmlFor=\"adddog-gender-male\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-male\" name=\"gender\" value=\"male\" />\n              <span>{t('gender.male')}</span>\n            </label>\n            <label htmlFor=\"adddog-gender-female\">\n              <input type=\"radio\" {...register('gender')} id=\"adddog-gender-female\" name=\"gender\" value=\"female\" />\n              <span>{t('gender.female')}</span>\n            </label>\n          </div>\n        </div>\n\n        <div id=\"health\">\n          <label htmlFor=\"adddog-vaccinated\">\n            <span>{t('adddog.vaccinated')}</span>\n            <input type=\"checkbox\" {...register('vaccinated')} id=\"adddog-vaccinated\" name=\"vaccinated\" />\n          </label>\n\n          <label htmlFor=\"adddog-neutered\">\n            <span>{t('adddog.neutered')}</span>\n            <input type=\"checkbox\" {...register('neutered')} id=\"adddog-neutered\" name=\"neutered\" />\n          </label>\n        </div>\n\n        <div id=\"media-upload\">\n          <label htmlFor=\"media\">{t('adddog.media')}</label>\n          <div className=\"media-input-row\">\n            <input type=\"file\" accept=\"image/*,video/*\" id=\"adddog-media\" name=\"media\" onChange={onFileChange} />\n            {smallPreview && <img className=\"thumb-small\" src={smallPreview} alt=\"thumb\" />}\n          </div>\n          {mediaError && <div className=\"error\" role=\"alert\" style={{ color: 'red', marginTop: 4 }}>{mediaError}</div>}\n          {mediaPreview && (\n            <div id=\"media-preview\">\n              {isVideo ? (\n                <div className=\"preview-wrap\">\n                  <video src={mediaPreview} controls width={150} poster={smallPreview || (posterBlob ? URL.createObjectURL(posterBlob) : undefined)}></video>\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              ) : (\n                <div className=\"preview-wrap\">\n                  <img src={smallPreview || mediaPreview} alt=\"preview\" />\n                  <button type=\"button\" className=\"view-full\" onClick={() => window.open(mediaPreview, '_blank')}>View full</button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"form-actions\">\n          <button type=\"submit\" disabled={submitting}>{submitting ? t('adddog.saving') : t('button.addDog')}</button>\n          {submitError && <div className=\"error\" role=\"alert\">{submitError}</div>}\n          {successMessage && <div className=\"notification success\" role=\"status\">{successMessage}</div>}\n        </div>\n      </form>\n    </main>\n  );\n};\n\nexport default AdddogForm;\n"],"mappings":"yHAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OAASC,OAAO,KAAuB,iBAAiB,CACxD,OAASC,cAAc,KAAQ,eAAe,CAC9C,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,OAAO,KAAQ,4BAA4B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAerD;AACA,KAAM,CAAAC,OAAO,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,uBAAuB,CAExE,KAAM,CAAAC,UAAoB,CAAGA,CAAA,GAAM,CACjC,KAAM,CAAEC,CAAE,CAAC,CAAGZ,cAAc,CAAC,CAAC,CAC9B,KAAM,CAAEa,KAAK,CAAEC,eAAgB,CAAC,CAAGZ,OAAO,CAAC,CAAC,CAC5C,KAAM,CAAEa,QAAQ,CAAEC,YAAY,CAAEC,SAAS,CAAE,CAAEC,MAAO,CAAE,CAAC,CAAGnB,OAAO,CAAiB,CAChFoB,aAAa,CAAE,CACbC,UAAU,CAAE,KAAK,CACjBC,QAAQ,CAAE,KACZ,CACF,CAAC,CAAC,CACF,KAAM,CAAAC,QAAQ,CAAGrB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAsB,YAAY,CAAGzB,MAAM,CAAC,IAAI,CAAC,CAEjCD,SAAS,CAAC,IAAM,CACd2B,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAE,CAAEX,eAAe,CAAEY,QAAQ,CAAE,CAAC,CAACb,KAAK,CAAEc,WAAW,CAAEd,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEe,MAAO,CAAC,CAAC,CAE5G,GAAI,CAACd,eAAe,EAAI,CAACD,KAAK,CAAE,CAC9BW,OAAO,CAACK,IAAI,CAAC,iDAAiD,CAAC,CAC/DP,QAAQ,CAAC,YAAY,CAAC,CACxB,CACF,CAAC,CAAE,CAACR,eAAe,CAAED,KAAK,CAAES,QAAQ,CAAC,CAAC,CAEtCzB,SAAS,CAAC,IAAM,CACd,MAAO,IAAM,CACX0B,YAAY,CAACO,OAAO,CAAG,KAAK,CAC9B,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGpC,QAAQ,CAAc,IAAI,CAAC,CAC7D,KAAM,CAACqC,YAAY,CAAEC,eAAe,CAAC,CAAGtC,QAAQ,CAAgB,IAAI,CAAC,CACrE,KAAM,CAACuC,YAAY,CAAEC,eAAe,CAAC,CAAGxC,QAAQ,CAAgB,IAAI,CAAC,CACrE,KAAM,CAACyC,OAAO,CAAEC,UAAU,CAAC,CAAG1C,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC2C,UAAU,CAAEC,aAAa,CAAC,CAAG5C,QAAQ,CAAc,IAAI,CAAC,CAC/D,KAAM,CAAC6C,UAAU,CAAEC,aAAa,CAAC,CAAG9C,QAAQ,CAAgB,IAAI,CAAC,CAEjE;AACA,KAAM,CAAA+C,iBAAiB,CAAIC,IAAU,EAAoB,CACvD,MAAO,IAAI,CAAAC,OAAO,CAAC,CAACC,OAAO,CAAEC,MAAM,GAAK,CACtC,KAAM,CAAAC,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC,CACrC,KAAM,CAAAO,KAAK,CAAGC,QAAQ,CAACC,aAAa,CAAC,OAAO,CAAC,CAC7CF,KAAK,CAACG,OAAO,CAAG,UAAU,CAC1BH,KAAK,CAACI,KAAK,CAAG,IAAI,CAClBJ,KAAK,CAACK,GAAG,CAAGR,GAAG,CACf;AACAG,KAAK,CAACM,WAAW,CAAG,CAAC,CACrB,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAMT,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC,CAE9CG,KAAK,CAACS,YAAY,CAAG,UAAY,CAC/B,KAAM,CAAAC,MAAM,CAAGT,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC,CAC/CQ,MAAM,CAACC,KAAK,CAAGX,KAAK,CAACY,UAAU,EAAI,GAAG,CACtCF,MAAM,CAACG,MAAM,CAAGb,KAAK,CAACc,WAAW,EAAI,GAAG,CACxC,KAAM,CAAAC,GAAG,CAAGL,MAAM,CAACM,UAAU,CAAC,IAAI,CAAC,CACnC,GAAI,CAACD,GAAG,CAAE,MAAO,CAAAnB,MAAM,CAAC,GAAI,CAAAqB,KAAK,CAAC,sBAAsB,CAAC,CAAC,CAC1DF,GAAG,CAACG,SAAS,CAAClB,KAAK,CAAE,CAAC,CAAE,CAAC,CAAEU,MAAM,CAACC,KAAK,CAAED,MAAM,CAACG,MAAM,CAAC,CACvDH,MAAM,CAACS,MAAM,CAAEC,IAAI,EAAK,CACtBb,OAAO,CAAC,CAAC,CACT,GAAIa,IAAI,CAAEzB,OAAO,CAACyB,IAAI,CAAC,CAAC,IACnB,CAAAxB,MAAM,CAAC,GAAI,CAAAqB,KAAK,CAAC,yBAAyB,CAAC,CAAC,CACnD,CAAC,CAAE,YAAY,CAAE,GAAG,CAAC,CACvB,CAAC,CACDjB,KAAK,CAACqB,OAAO,CAAIC,CAAC,EAAK,CACrBf,OAAO,CAAC,CAAC,CACTX,MAAM,CAAC0B,CAAC,CAAC,CACX,CAAC,CACH,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAC,oBAAoB,CAAG,QAAAA,CAAC9B,IAAU,CAAiC,IAA/B,CAAA+B,IAAI,CAAAC,SAAA,CAAAhD,MAAA,IAAAgD,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,EAAE,CACjD,MAAO,IAAI,CAAA/B,OAAO,CAAC,CAACC,OAAO,CAAEC,MAAM,GAAK,CACtC,KAAM,CAAA+B,GAAG,CAAG,GAAI,CAAAC,KAAK,CAAC,CAAC,CACvB,KAAM,CAAA/B,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC,CACrCkC,GAAG,CAACE,MAAM,CAAG,IAAM,CACjB,KAAM,CAAAC,KAAK,CAAGH,GAAG,CAAChB,KAAK,CAAGgB,GAAG,CAACd,MAAM,EAAI,CAAC,CACzC,GAAI,CAAAF,KAAK,CAAGa,IAAI,CAChB,GAAI,CAAAX,MAAM,CAAGkB,IAAI,CAACC,KAAK,CAACR,IAAI,CAAGM,KAAK,CAAC,CACrC,GAAIA,KAAK,CAAG,CAAC,CAAE,CACb;AACAjB,MAAM,CAAGW,IAAI,CACbb,KAAK,CAAGoB,IAAI,CAACC,KAAK,CAACR,IAAI,CAAGM,KAAK,CAAC,CAClC,CACA,KAAM,CAAApB,MAAM,CAAGT,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC,CAC/CQ,MAAM,CAACC,KAAK,CAAGA,KAAK,CACpBD,MAAM,CAACG,MAAM,CAAGA,MAAM,CACtB,KAAM,CAAAE,GAAG,CAAGL,MAAM,CAACM,UAAU,CAAC,IAAI,CAAC,CACnC,GAAI,CAACD,GAAG,CAAE,CACRjB,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC,CACxB,MAAO,CAAAD,MAAM,CAAC,GAAI,CAAAqB,KAAK,CAAC,sBAAsB,CAAC,CAAC,CAClD,CACAF,GAAG,CAACG,SAAS,CAACS,GAAG,CAAE,CAAC,CAAE,CAAC,CAAEhB,KAAK,CAAEE,MAAM,CAAC,CACvC,KAAM,CAAAoB,OAAO,CAAGvB,MAAM,CAACwB,SAAS,CAAC,YAAY,CAAE,GAAG,CAAC,CACnDpC,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC,CACxBF,OAAO,CAACsC,OAAO,CAAC,CAClB,CAAC,CACDN,GAAG,CAACN,OAAO,CAAIC,CAAC,EAAK,CACnBxB,GAAG,CAACU,eAAe,CAACX,GAAG,CAAC,CACxBD,MAAM,CAAC0B,CAAC,CAAC,CACX,CAAC,CACDK,GAAG,CAACtB,GAAG,CAAGR,GAAG,CACf,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAsC,YAAY,CAAG,KAAO,CAAAb,CAAsC,EAAK,CACrE,KAAM,CAAAc,CAAC,CAAGd,CAAC,CAACe,MAAM,CAACC,KAAK,EAAIhB,CAAC,CAACe,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAC7C,GAAI,CAACF,CAAC,CAAE,OACRvD,YAAY,CAACuD,CAAC,CAAC,CAEf;AACA,GAAItD,YAAY,EAAIA,YAAY,CAACyD,UAAU,CAAC,OAAO,CAAC,CAAE,CACpD,GAAI,CAAEzC,GAAG,CAACU,eAAe,CAAC1B,YAAY,CAAC,CAAE,CAAE,MAAO0D,GAAG,CAAE,CAAE,aAC3D,CAEA,KAAM,CAAA3C,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACqC,CAAC,CAAC,CAClCrD,eAAe,CAACc,GAAG,CAAC,CAEpB,GAAIuC,CAAC,CAACK,IAAI,CAACF,UAAU,CAAC,QAAQ,CAAC,CAAE,CAC/BpD,UAAU,CAAC,IAAI,CAAC,CAChBF,eAAe,CAAC,IAAI,CAAC,CACrB,GAAI,CACF,KAAM,CAAAyD,MAAM,CAAG,KAAM,CAAAlD,iBAAiB,CAAC4C,CAAC,CAAC,CACzC/C,aAAa,CAACqD,MAAM,CAAC,CACvB,CAAE,MAAOF,GAAG,CAAE,CACZnE,OAAO,CAACK,IAAI,CAAC,+BAA+B,CAAE8D,GAAG,CAAC,CACpD,CACF,CAAC,IAAM,CACLrD,UAAU,CAAC,KAAK,CAAC,CACjB,GAAI,CACF,KAAM,CAAAwD,KAAK,CAAG,KAAM,CAAApB,oBAAoB,CAACa,CAAC,CAAE,EAAE,CAAC,CAC/CnD,eAAe,CAAC0D,KAAK,CAAC,CACxB,CAAE,MAAOH,GAAG,CAAE,CACZnE,OAAO,CAACK,IAAI,CAAC,4BAA4B,CAAE8D,GAAG,CAAC,CAC/CvD,eAAe,CAAC,IAAI,CAAC,CACvB,CACF,CACF,CAAC,CAED,KAAM,CAAC2D,UAAU,CAAEC,aAAa,CAAC,CAAGpG,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAACqG,WAAW,CAAEC,cAAc,CAAC,CAAGtG,QAAQ,CAAgB,IAAI,CAAC,CACnE,KAAM,CAACuG,cAAc,CAAEC,iBAAiB,CAAC,CAAGxG,QAAQ,CAAgB,IAAI,CAAC,CACzE,KAAM,CAAAyG,kBAAkB,CAAGvG,MAAM,CAAyB,IAAI,CAAC,CAE/DD,SAAS,CAAC,IAAM,CACd,MAAO,IAAM,CACX0B,YAAY,CAACO,OAAO,CAAG,KAAK,CAC5B;AACA,GAAIuE,kBAAkB,CAACvE,OAAO,CAAE,CAC9BuE,kBAAkB,CAACvE,OAAO,CAACwE,KAAK,CAAC,CAAC,CACpC,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,QAAuC,CAAG,KAAO,CAAAC,MAAM,EAAK,KAAAC,YAAA,CAAAC,gBAAA,CAChElF,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAE+E,MAAM,CAAC,CAEzD;AACA,GAAI,GAAAC,YAAA,CAACD,MAAM,CAACG,IAAI,UAAAF,YAAA,WAAXA,YAAA,CAAaG,IAAI,CAAC,CAAC,EAAE,CACxBV,cAAc,CAACtF,CAAC,CAAC,qBAAqB,CAAC,CAAC,CACxC,OACF,CACA,GAAI,GAAA8F,gBAAA,CAACF,MAAM,CAACK,QAAQ,UAAAH,gBAAA,WAAfA,gBAAA,CAAiBE,IAAI,CAAC,CAAC,EAAE,CAC5BV,cAAc,CAACtF,CAAC,CAAC,yBAAyB,CAAC,CAAC,CAC5C,OACF,CACA,GAAI,CAACmB,SAAS,CAAE,CACdW,aAAa,CAAC9B,CAAC,CAAC,sBAAsB,CAAC,EAAI,mBAAmB,CAAC,CAC/D,OACF,CAAC,IAAM,CACL8B,aAAa,CAAC,IAAI,CAAC,CACrB,CAEA,GAAI,CACFsD,aAAa,CAAC,IAAI,CAAC,CACnBE,cAAc,CAAC,IAAI,CAAC,CAEpB1E,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAElB,OAAO,CAAC,CAClDiB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEqF,MAAM,CAACD,QAAQ,CAACE,QAAQ,CAAC,CAC1DvF,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEqF,MAAM,CAACD,QAAQ,CAACG,IAAI,CAAC,CAErD,KAAM,CAAAC,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEX,MAAM,CAACG,IAAI,CAAC,CACpC,GAAIH,MAAM,CAACY,KAAK,CAAEH,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAEX,MAAM,CAACY,KAAK,CAAC,CACxD,GAAIZ,MAAM,CAACa,KAAK,CAAEJ,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAEX,MAAM,CAACa,KAAK,CAAC,CACxD,GAAIb,MAAM,CAACc,GAAG,GAAKzC,SAAS,CAAEoC,QAAQ,CAACE,MAAM,CAAC,KAAK,CAAEI,MAAM,CAACf,MAAM,CAACc,GAAG,CAAC,CAAC,CACxE,GAAId,MAAM,CAACgB,WAAW,CAAEP,QAAQ,CAACE,MAAM,CAAC,aAAa,CAAEX,MAAM,CAACgB,WAAW,CAAC,CAC1E,GAAIhB,MAAM,CAAC7B,IAAI,CAAEsC,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEX,MAAM,CAAC7B,IAAI,CAAC,CACrD,GAAI6B,MAAM,CAACK,QAAQ,CAAEI,QAAQ,CAACE,MAAM,CAAC,UAAU,CAAEX,MAAM,CAACK,QAAQ,CAAC,CAEjE;AACAI,QAAQ,CAACE,MAAM,CAAC,YAAY,CAAEX,MAAM,CAACpF,UAAU,CAAG,MAAM,CAAG,OAAO,CAAC,CACnE6F,QAAQ,CAACE,MAAM,CAAC,UAAU,CAAEX,MAAM,CAACnF,QAAQ,CAAG,MAAM,CAAG,OAAO,CAAC,CAE/D,GAAIU,SAAS,CAAE,CACbkF,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAEpF,SAAS,CAAEA,SAAS,CAAC4E,IAAI,CAAC,CACnD,GAAIpE,UAAU,CAAE,CACd,KAAM,CAAAkF,UAAU,CAAG,GAAI,CAAAC,IAAI,CAAC,CAACnF,UAAU,CAAC,CAAE,YAAY,CAAE,CAAEqD,IAAI,CAAE,YAAa,CAAC,CAAC,CAC/EqB,QAAQ,CAACE,MAAM,CAAC,QAAQ,CAAEM,UAAU,CAAE,YAAY,CAAC,CACrD,CACF,CAEAjG,OAAO,CAACC,GAAG,CAAC,gBAAgB,IAAAkG,MAAA,CAAKpH,OAAO,aAAW,CAAC,CACpDiB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEmG,MAAM,CAACC,WAAW,CAACZ,QAAQ,CAACa,OAAO,CAAC,CAAC,CAAC,CAAC,CACxEtG,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAE,CAAC,CAACM,SAAS,CAAC,CAC/CP,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAE,CAAC,CAACZ,KAAK,CAAC,CACzCW,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEZ,KAAK,IAAA8G,MAAA,CAAM9G,KAAK,CAACkH,SAAS,CAAC,CAAC,CAAE,EAAE,CAAC,QAAQ,UAAU,CAAC,CAEnF1B,kBAAkB,CAACvE,OAAO,CAAG,GAAI,CAAAkG,eAAe,CAAC,CAAC,CAElD,KAAM,CAAAC,OAAY,CAAG,CACnB;AAAA,CACD,CAED,GAAIpH,KAAK,CAAE,CACToH,OAAO,CAAC,eAAe,CAAC,WAAAN,MAAA,CAAa9G,KAAK,CAAE,CAC5CW,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC,CAC3C,CAAC,IAAM,CACLD,OAAO,CAAC0G,KAAK,CAAC,2CAA2C,CAAC,CAC5D,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAC,KAAK,IAAAT,MAAA,CAAIpH,OAAO,cAAa,CAC9C8H,MAAM,CAAE,MAAM,CACdC,IAAI,CAAErB,QAAQ,CACdsB,MAAM,CAAElC,kBAAkB,CAACvE,OAAO,CAACyG,MAAM,CACzCN,OACF,CAAC,CAAC,CAEF,GAAI,CAACE,IAAI,CAACK,EAAE,CAAE,CACZ;AACA,GAAI,CAAAC,MAAM,8BAAAd,MAAA,CAAgCQ,IAAI,CAACO,MAAM,OAAAf,MAAA,CAAKQ,IAAI,CAACQ,UAAU,KAAG,CAC5EnH,OAAO,CAAC0G,KAAK,CAAC,kBAAkB,CAAEC,IAAI,CAACO,MAAM,CAAEP,IAAI,CAACQ,UAAU,CAAC,CAC/D,GAAI,CACF,KAAM,CAAAL,IAAI,CAAG,KAAM,CAAAH,IAAI,CAACS,IAAI,CAAC,CAAC,CAC9BpH,OAAO,CAAC0G,KAAK,CAAC,aAAa,CAAEI,IAAI,CAAC,CAClCG,MAAM,CAAGH,IAAI,CAACO,OAAO,EAAIC,IAAI,CAACC,SAAS,CAACT,IAAI,CAAC,CAC/C,CAAE,MAAO7D,CAAC,CAAE,CACVjD,OAAO,CAAC0G,KAAK,CAAC,gCAAgC,CAAEzD,CAAC,CAAC,CAClD,KAAM,CAAAuE,GAAG,CAAG,KAAM,CAAAb,IAAI,CAACc,IAAI,CAAC,CAAC,CAC7BzH,OAAO,CAAC0G,KAAK,CAAC,aAAa,CAAEc,GAAG,CAAC,CACjC,GAAIA,GAAG,CAAEP,MAAM,CAAGO,GAAG,CAACjB,SAAS,CAAC,CAAC,CAAE,GAAG,CAAC,CAAE;AAC3C,CACAvG,OAAO,CAAC0G,KAAK,CAAC,YAAY,CAAEO,MAAM,CAAC,CACnCvC,cAAc,CAACuC,MAAM,CAAC,CACtB,KAAM,IAAI,CAAArE,KAAK,CAACqE,MAAM,CAAC,CACzB,CAEA;AACA,GAAIlH,YAAY,CAACO,OAAO,CAAE,CACxBsE,iBAAiB,CAACxF,CAAC,CAAC,cAAc,CAAC,CAAC,CACpC;AACAsI,UAAU,CAAC,IAAM,CACf,GAAI3H,YAAY,CAACO,OAAO,CAAER,QAAQ,CAAC,MAAM,CAAC,CAC5C,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CAAE,MAAOqE,GAAQ,CAAE,CACjB;AACA,GAAIA,GAAG,CAACgB,IAAI,GAAK,YAAY,CAAE,CAC7BnF,OAAO,CAACC,GAAG,CAAC,2CAA2C,CAAC,CACxD,OACF,CAEAD,OAAO,CAAC0G,KAAK,CAAC,iBAAiB,CAAEvC,GAAG,CAAC,CACrCnE,OAAO,CAAC0G,KAAK,CAAC,aAAa,CAAEvC,GAAG,CAACgB,IAAI,CAAC,CACtCnF,OAAO,CAAC0G,KAAK,CAAC,gBAAgB,CAAEvC,GAAG,CAACkD,OAAO,CAAC,CAC5CrH,OAAO,CAAC0G,KAAK,CAAC,aAAa,CAAEvC,GAAG,CAAC,CAEjC,GAAI,CAAAwD,YAAY,CAAGvI,CAAC,CAAC,eAAe,CAAC,CACrC,GAAI+E,GAAG,CAACkD,OAAO,CAAE,CACfM,YAAY,OAAAxB,MAAA,CAAShC,GAAG,CAACkD,OAAO,CAAE,CACpC,CAEA,GAAItH,YAAY,CAACO,OAAO,EAAI,CAACmE,WAAW,CAAE,CACxCC,cAAc,CAACiD,YAAY,CAAC,CAC9B,CACF,CAAC,OAAS,CACR,GAAI5H,YAAY,CAACO,OAAO,CAAEkE,aAAa,CAAC,KAAK,CAAC,CAChD,CACF,CAAC,CAED,mBACE1F,KAAA,SAAA8I,QAAA,eACEhJ,IAAA,OAAAgJ,QAAA,CAAKxI,CAAC,CAAC,cAAc,CAAC,CAAK,CAAC,cAE5BN,KAAA,QAAK+I,KAAK,CAAE,CAACC,UAAU,CAAE,SAAS,CAAEC,OAAO,CAAE,KAAK,CAAEC,MAAM,CAAE,OAAO,CAAEC,QAAQ,CAAE,MAAM,CAAEC,YAAY,CAAE,KAAK,CAAE,CAAAN,QAAA,eAC1GhJ,IAAA,WAAAgJ,QAAA,CAAQ,QAAM,CAAQ,CAAC,cAAW,CAAC7I,OAAO,CAAC,gBAAc,CAACuG,MAAM,CAACD,QAAQ,CAACE,QAAQ,EAC/E,CAAC,cAENzG,KAAA,SAAMqJ,EAAE,CAAC,aAAa,CAACpD,QAAQ,CAAEvF,YAAY,CAACuF,QAAQ,CAAE,CAAA6C,QAAA,eACtDhJ,IAAA,UAAOwJ,OAAO,CAAC,aAAa,CAAAR,QAAA,CAAExI,CAAC,CAAC,aAAa,CAAC,CAAQ,CAAC,cACvDR,IAAA,SAAAyJ,aAAA,EAAOjE,IAAI,CAAC,MAAM,CAAC+D,EAAE,CAAC,aAAa,CAAChD,IAAI,CAAC,MAAM,CAACmD,YAAY,CAAC,MAAM,CAACC,WAAW,CAAEnJ,CAAC,CAAC,aAAa,CAAE,EAAKG,QAAQ,CAAC,MAAM,CAAE,CAAEiJ,QAAQ,CAAE,IAAK,CAAC,CAAC,CAAG,CAAC,CAC9I9I,MAAM,CAACyF,IAAI,eAAIrG,KAAA,QAAK2J,SAAS,CAAC,OAAO,CAACC,IAAI,CAAC,OAAO,CAAAd,QAAA,EAAExI,CAAC,CAAC,aAAa,CAAC,CAAC,cAAY,EAAK,CAAC,cAExFR,IAAA,UAAOwJ,OAAO,CAAC,cAAc,CAAAR,QAAA,CAAExI,CAAC,CAAC,cAAc,CAAC,CAAQ,CAAC,cACzDR,IAAA,SAAAyJ,aAAA,EAAOjE,IAAI,CAAC,MAAM,CAAC+D,EAAE,CAAC,cAAc,CAAChD,IAAI,CAAC,OAAO,CAACmD,YAAY,CAAC,KAAK,CAACC,WAAW,CAAEnJ,CAAC,CAAC,cAAc,CAAE,EAAKG,QAAQ,CAAC,OAAO,CAAC,CAAG,CAAC,cAE9HX,IAAA,UAAOwJ,OAAO,CAAC,cAAc,CAAAR,QAAA,CAAExI,CAAC,CAAC,cAAc,CAAC,CAAQ,CAAC,cACzDR,IAAA,SAAAyJ,aAAA,EAAOjE,IAAI,CAAC,MAAM,CAAC+D,EAAE,CAAC,cAAc,CAAChD,IAAI,CAAC,OAAO,CAACmD,YAAY,CAAC,KAAK,CAACC,WAAW,CAAEnJ,CAAC,CAAC,cAAc,CAAE,EAAKG,QAAQ,CAAC,OAAO,CAAC,CAAG,CAAC,cAE9HX,IAAA,UAAOwJ,OAAO,CAAC,iBAAiB,CAAAR,QAAA,CAAExI,CAAC,CAAC,iBAAiB,CAAC,CAAQ,CAAC,cAC/DR,IAAA,SAAAyJ,aAAA,EAAOjE,IAAI,CAAC,MAAM,CAAC+D,EAAE,CAAC,iBAAiB,CAAChD,IAAI,CAAC,UAAU,CAACmD,YAAY,CAAC,gBAAgB,CAACC,WAAW,CAAEnJ,CAAC,CAAC,iBAAiB,CAAE,EAAKG,QAAQ,CAAC,UAAU,CAAE,CAAEiJ,QAAQ,CAAE,IAAK,CAAC,CAAC,CAAG,CAAC,cAEzK5J,IAAA,UAAOwJ,OAAO,CAAC,YAAY,CAAAR,QAAA,CAAExI,CAAC,CAAC,YAAY,CAAC,CAAQ,CAAC,cACrDR,IAAA,UAAAgJ,QAAA,CAAQxI,CAAC,CAAC,qBAAqB,CAAC,CAAQ,CAAC,cACzCR,IAAA,SAAAyJ,aAAA,EAAOjE,IAAI,CAAC,QAAQ,CAAC+D,EAAE,CAAC,YAAY,CAAChD,IAAI,CAAC,KAAK,CAACmD,YAAY,CAAC,KAAK,CAACC,WAAW,CAAEnJ,CAAC,CAAC,YAAY,CAAE,CAACuJ,IAAI,CAAC,KAAK,EAAKpJ,QAAQ,CAAC,KAAK,CAAE,CAAEqJ,aAAa,CAAE,IAAK,CAAC,CAAC,CAAG,CAAC,cAE5JhK,IAAA,UAAOwJ,OAAO,CAAC,oBAAoB,CAAAR,QAAA,CAAExI,CAAC,CAAC,oBAAoB,CAAC,CAAQ,CAAC,cACrER,IAAA,YAAAyJ,aAAA,EAAUF,EAAE,CAAC,oBAAoB,CAAChD,IAAI,CAAC,aAAa,CAAC0D,IAAI,CAAE,CAAE,CAACC,IAAI,CAAE,EAAG,CAACR,YAAY,CAAC,KAAK,CAACC,WAAW,CAAEnJ,CAAC,CAAC,oBAAoB,CAAE,EAAKG,QAAQ,CAAC,aAAa,CAAC,CAAG,CAAC,cAEhKX,IAAA,UAAOwJ,OAAO,CAAC,aAAa,CAAAR,QAAA,CAAExI,CAAC,CAAC,aAAa,CAAC,CAAQ,CAAC,cACvDN,KAAA,UAAAuJ,aAAA,CAAAA,aAAA,IAAY9I,QAAQ,CAAC,MAAM,CAAC,MAAE4I,EAAE,CAAC,aAAa,CAAChD,IAAI,CAAC,MAAM,CAACmD,YAAY,CAAC,KAAK,CAAAV,QAAA,eAC3EhJ,IAAA,WAAQmK,KAAK,CAAC,OAAO,CAAAnB,QAAA,CAAExI,CAAC,CAAC,YAAY,CAAC,CAAS,CAAC,cAChDR,IAAA,WAAQmK,KAAK,CAAC,QAAQ,CAAAnB,QAAA,CAAExI,CAAC,CAAC,aAAa,CAAC,CAAS,CAAC,cAClDR,IAAA,WAAQmK,KAAK,CAAC,OAAO,CAAAnB,QAAA,CAAExI,CAAC,CAAC,YAAY,CAAC,CAAS,CAAC,GAC1C,CAAC,cAETN,KAAA,QAAKqJ,EAAE,CAAC,QAAQ,CAAAP,QAAA,eACdhJ,IAAA,UAAAgJ,QAAA,CAAQxI,CAAC,CAAC,eAAe,CAAC,CAAQ,CAAC,cACnCN,KAAA,QAAK2J,SAAS,CAAC,gBAAgB,CAAAb,QAAA,eAC7B9I,KAAA,UAAOsJ,OAAO,CAAC,oBAAoB,CAAAR,QAAA,eACjChJ,IAAA,SAAAyJ,aAAA,CAAAA,aAAA,EAAOjE,IAAI,CAAC,OAAO,EAAK7E,QAAQ,CAAC,QAAQ,CAAC,MAAE4I,EAAE,CAAC,oBAAoB,CAAChD,IAAI,CAAC,QAAQ,CAAC4D,KAAK,CAAC,MAAM,EAAE,CAAC,cACjGnK,IAAA,SAAAgJ,QAAA,CAAOxI,CAAC,CAAC,aAAa,CAAC,CAAO,CAAC,EAC1B,CAAC,cACRN,KAAA,UAAOsJ,OAAO,CAAC,sBAAsB,CAAAR,QAAA,eACnChJ,IAAA,SAAAyJ,aAAA,CAAAA,aAAA,EAAOjE,IAAI,CAAC,OAAO,EAAK7E,QAAQ,CAAC,QAAQ,CAAC,MAAE4I,EAAE,CAAC,sBAAsB,CAAChD,IAAI,CAAC,QAAQ,CAAC4D,KAAK,CAAC,QAAQ,EAAE,CAAC,cACrGnK,IAAA,SAAAgJ,QAAA,CAAOxI,CAAC,CAAC,eAAe,CAAC,CAAO,CAAC,EAC5B,CAAC,EACL,CAAC,EACH,CAAC,cAENN,KAAA,QAAKqJ,EAAE,CAAC,QAAQ,CAAAP,QAAA,eACd9I,KAAA,UAAOsJ,OAAO,CAAC,mBAAmB,CAAAR,QAAA,eAChChJ,IAAA,SAAAgJ,QAAA,CAAOxI,CAAC,CAAC,mBAAmB,CAAC,CAAO,CAAC,cACrCR,IAAA,SAAAyJ,aAAA,CAAAA,aAAA,EAAOjE,IAAI,CAAC,UAAU,EAAK7E,QAAQ,CAAC,YAAY,CAAC,MAAE4I,EAAE,CAAC,mBAAmB,CAAChD,IAAI,CAAC,YAAY,EAAE,CAAC,EACzF,CAAC,cAERrG,KAAA,UAAOsJ,OAAO,CAAC,iBAAiB,CAAAR,QAAA,eAC9BhJ,IAAA,SAAAgJ,QAAA,CAAOxI,CAAC,CAAC,iBAAiB,CAAC,CAAO,CAAC,cACnCR,IAAA,SAAAyJ,aAAA,CAAAA,aAAA,EAAOjE,IAAI,CAAC,UAAU,EAAK7E,QAAQ,CAAC,UAAU,CAAC,MAAE4I,EAAE,CAAC,iBAAiB,CAAChD,IAAI,CAAC,UAAU,EAAE,CAAC,EACnF,CAAC,EACL,CAAC,cAENrG,KAAA,QAAKqJ,EAAE,CAAC,cAAc,CAAAP,QAAA,eACpBhJ,IAAA,UAAOwJ,OAAO,CAAC,OAAO,CAAAR,QAAA,CAAExI,CAAC,CAAC,cAAc,CAAC,CAAQ,CAAC,cAClDN,KAAA,QAAK2J,SAAS,CAAC,iBAAiB,CAAAb,QAAA,eAC9BhJ,IAAA,UAAOwF,IAAI,CAAC,MAAM,CAAC4E,MAAM,CAAC,iBAAiB,CAACb,EAAE,CAAC,cAAc,CAAChD,IAAI,CAAC,OAAO,CAAC8D,QAAQ,CAAEnF,YAAa,CAAE,CAAC,CACpGnD,YAAY,eAAI/B,IAAA,QAAK6J,SAAS,CAAC,aAAa,CAACzG,GAAG,CAAErB,YAAa,CAACuI,GAAG,CAAC,OAAO,CAAE,CAAC,EAC5E,CAAC,CACLjI,UAAU,eAAIrC,IAAA,QAAK6J,SAAS,CAAC,OAAO,CAACC,IAAI,CAAC,OAAO,CAACb,KAAK,CAAE,CAAEhC,KAAK,CAAE,KAAK,CAAEsD,SAAS,CAAE,CAAE,CAAE,CAAAvB,QAAA,CAAE3G,UAAU,CAAM,CAAC,CAC3GR,YAAY,eACX7B,IAAA,QAAKuJ,EAAE,CAAC,eAAe,CAAAP,QAAA,CACpB/G,OAAO,cACN/B,KAAA,QAAK2J,SAAS,CAAC,cAAc,CAAAb,QAAA,eAC3BhJ,IAAA,UAAOoD,GAAG,CAAEvB,YAAa,CAAC2I,QAAQ,MAAC9G,KAAK,CAAE,GAAI,CAAC+B,MAAM,CAAE1D,YAAY,GAAKI,UAAU,CAAGU,GAAG,CAACC,eAAe,CAACX,UAAU,CAAC,CAAGsC,SAAS,CAAE,CAAQ,CAAC,cAC3IzE,IAAA,WAAQwF,IAAI,CAAC,QAAQ,CAACqE,SAAS,CAAC,WAAW,CAACY,OAAO,CAAEA,CAAA,GAAM/D,MAAM,CAACgE,IAAI,CAAC7I,YAAY,CAAE,QAAQ,CAAE,CAAAmH,QAAA,CAAC,WAAS,CAAQ,CAAC,EAC/G,CAAC,cAEN9I,KAAA,QAAK2J,SAAS,CAAC,cAAc,CAAAb,QAAA,eAC3BhJ,IAAA,QAAKoD,GAAG,CAAErB,YAAY,EAAIF,YAAa,CAACyI,GAAG,CAAC,SAAS,CAAE,CAAC,cACxDtK,IAAA,WAAQwF,IAAI,CAAC,QAAQ,CAACqE,SAAS,CAAC,WAAW,CAACY,OAAO,CAAEA,CAAA,GAAM/D,MAAM,CAACgE,IAAI,CAAC7I,YAAY,CAAE,QAAQ,CAAE,CAAAmH,QAAA,CAAC,WAAS,CAAQ,CAAC,EAC/G,CACN,CACE,CACN,EACE,CAAC,cAEN9I,KAAA,QAAK2J,SAAS,CAAC,cAAc,CAAAb,QAAA,eAC3BhJ,IAAA,WAAQwF,IAAI,CAAC,QAAQ,CAACmF,QAAQ,CAAEhF,UAAW,CAAAqD,QAAA,CAAErD,UAAU,CAAGnF,CAAC,CAAC,eAAe,CAAC,CAAGA,CAAC,CAAC,eAAe,CAAC,CAAS,CAAC,CAC1GqF,WAAW,eAAI7F,IAAA,QAAK6J,SAAS,CAAC,OAAO,CAACC,IAAI,CAAC,OAAO,CAAAd,QAAA,CAAEnD,WAAW,CAAM,CAAC,CACtEE,cAAc,eAAI/F,IAAA,QAAK6J,SAAS,CAAC,sBAAsB,CAACC,IAAI,CAAC,QAAQ,CAAAd,QAAA,CAAEjD,cAAc,CAAM,CAAC,EAC1F,CAAC,EACF,CAAC,EACH,CAAC,CAEX,CAAC,CAED,cAAe,CAAAxF,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}