{"ast":null,"code":"import _objectSpread from\"/Applications/MAMP/htdocs/eky/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from'react';import ReactDOM from'react-dom';import{useTranslation}from'react-i18next';import{useAuth}from'../contexts/AuthContext';import'../css/modal.css';// Portal container for modal\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const modalRoot=document.getElementById('modal-root')||(()=>{const root=document.createElement('div');root.id='modal-root';// Portal root should NOT block clicks - only modal overlay should\nroot.style.position='absolute';root.style.top='0';root.style.left='0';root.style.zIndex='0';root.style.pointerEvents='none';document.body.appendChild(root);return root;})();const UserProfileModal=_ref=>{let{isOpen,onClose}=_ref;const{user,token,logout,updateUser,getWishlist,removeFromWishlist}=useAuth();const typedUser=user;const{t}=useTranslation();const[isEditing,setIsEditing]=useState(false);const[activeTab,setActiveTab]=useState('profile');const[wishlist,setWishlist]=useState([]);const[loadingWishlist,setLoadingWishlist]=useState(false);const[profilePicture,setProfilePicture]=useState(null);const[profilePicturePreview,setProfilePicturePreview]=useState('');// Helper to get full image URL (robust)\nconst getProfileImageUrl=profilePicture=>{if(!profilePicture)return\"../img/androcolored-80x80.jpg\";let url=profilePicture.startsWith('/')?profilePicture:'/'+profilePicture;// Use /u/ for compatibility if needed\nurl=url.replace('/uploads','/u');// Always use API base for /uploads/ and /u/ paths\nif(url.startsWith('/uploads/')||url.startsWith('/u/')){const apiBase=process.env.REACT_APP_API_URL||'http://localhost:3001';return apiBase+url;}// If already absolute URL, return as is\nif(/^https?:\\/\\//.test(url))return url;// Fallback to placeholder\nreturn'../img/androcolored-80x80.jpg';};const[formData,setFormData]=useState({name:(typedUser===null||typedUser===void 0?void 0:typedUser.name)||'',email:(typedUser===null||typedUser===void 0?void 0:typedUser.email)||'',username:(typedUser===null||typedUser===void 0?void 0:typedUser.username)||'',phone:(typedUser===null||typedUser===void 0?void 0:typedUser.phone)||''});const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// Used to force re-render after profile update\nconst[profilePicKey,setProfilePicKey]=useState(0);const[success,setSuccess]=useState(null);const loadWishlist=React.useCallback(async()=>{setLoadingWishlist(true);const wishlistData=await getWishlist();setWishlist(wishlistData);setLoadingWishlist(false);},[getWishlist]);// Load wishlist when modal opens and wishlist tab is active\nReact.useEffect(()=>{if(isOpen){loadWishlist();}// Reset form data when modal opens\nif(isOpen&&user){setFormData({name:typedUser.name||'',email:typedUser.email||'',username:typedUser.username||'',phone:typedUser.phone||''});setProfilePicture(null);setProfilePicturePreview('');setError(null);setSuccess(null);}else if(isOpen&&!user){setFormData({name:'',email:'',username:'',phone:''});setProfilePicture(null);setProfilePicturePreview('');setError(null);setSuccess(null);}// Listen for wishlist-updated events (from DogList add)\nconst handler=e=>{if(e.detail&&Array.isArray(e.detail.wishlist)){setWishlist(e.detail.wishlist);}};window.addEventListener('wishlist-updated',handler);return()=>window.removeEventListener('wishlist-updated',handler);// Only re-run when modal opens/closes or user ID changes\n// eslint-disable-next-line react-hooks/exhaustive-deps\n},[isOpen,typedUser===null||typedUser===void 0?void 0:typedUser._id]);const handleModalClose=React.useCallback(()=>{console.log('handleModalClose called');setIsEditing(false);setError(null);setSuccess(null);onClose();},[onClose]);// Handle escape key to close modal\nReact.useEffect(()=>{const handleEscapeKey=event=>{if(event.key==='Escape'&&isOpen){console.log('Escape key pressed, closing modal');handleModalClose();}};if(isOpen){document.addEventListener('keydown',handleEscapeKey);return()=>{document.removeEventListener('keydown',handleEscapeKey);};}},[isOpen,handleModalClose]);// Reset state when modal closes\nReact.useEffect(()=>{if(!isOpen){setIsEditing(false);setActiveTab('profile');setError(null);setSuccess(null);setLoading(false);}},[isOpen]);// Prevent body scrolling when modal is open\nReact.useEffect(()=>{if(isOpen){// Prevent body scroll\ndocument.body.style.overflow='hidden';document.body.style.position='fixed';document.body.style.width='100%';document.body.style.height='100%';// Store scroll position\nconst scrollY=window.scrollY;document.body.dataset.scrollY=scrollY.toString();// Prevent touch scrolling on mobile\ndocument.body.style.touchAction='none';}else{// Restore body scroll\nconst scrollY=document.body.dataset.scrollY||'0';document.body.style.overflow='';document.body.style.position='';document.body.style.width='';document.body.style.height='';document.body.style.touchAction='';// Restore scroll position\nwindow.scrollTo(0,parseInt(scrollY,10));// Clear stored scroll position\ndelete document.body.dataset.scrollY;}return()=>{// Cleanup when modal unmounts\ndocument.body.style.overflow='';document.body.style.position='';document.body.style.width='';document.body.style.height='';document.body.style.touchAction='';delete document.body.dataset.scrollY;};},[isOpen]);// Don't render if modal is not open - MOVED AFTER ALL HOOKS\nif(!isOpen){return null;}const handleAdopt=async dogId=>{try{const API_URL=getApiUrl();const resp=await fetch(\"\".concat(API_URL,\"/api/dogs/\").concat(dogId,\"/adopt-request\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':token?\"Bearer \".concat(token):''}});const data=await resp.json();if(!resp.ok)throw new Error(data.message||'Error');await loadWishlist();}catch(e){alert(e.message||'Error');}};const handleProfilePictureChange=e=>{var _e$target$files;const file=(_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){setProfilePicture(file);const reader=new FileReader();reader.onloadend=()=>{setProfilePicturePreview(reader.result);};reader.readAsDataURL(file);}};const handlePasswordReset=async()=>{if(!(user!==null&&user!==void 0&&user.email))return;try{const API_URL=getApiUrl();const response=await fetch(\"\".concat(API_URL,\"/api/users/password-reset\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:user.email})});const data=await response.json();if(response.ok){setSuccess('Password reset link sent to your email!');setError(null);}else{setError(data.message||'Failed to send password reset email');setSuccess(null);}}catch(error){console.error('Password reset error:',error);setError('Network error. Please try again.');setSuccess(null);}};// Get API URL based on environment\nconst getApiUrl=()=>{if(process.env.REACT_APP_API_URL)return process.env.REACT_APP_API_URL;if(window.location.hostname==='localhost'||window.location.hostname==='127.0.0.1'){return\"http://\".concat(window.location.hostname,\":3001\");}return\"http://172.20.10.2:3001\";};const handleInputChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const handleUpdateProfile=async e=>{console.log('[PROFILE UPDATE DEBUG] handleUpdateProfile called');if(profilePicture){console.log('[PROFILE UPDATE DEBUG] Uploading file:',profilePicture.name,'type:',profilePicture.type);}e.preventDefault();setLoading(true);setError(null);setSuccess(null);try{const API_URL=getApiUrl();// Create FormData for file upload\nconst uploadFormData=new FormData();uploadFormData.append('name',formData.name);uploadFormData.append('username',formData.username);uploadFormData.append('email',formData.email);uploadFormData.append('phone',formData.phone);// Add profile picture if selected\nif(profilePicture){uploadFormData.append('profilePicture',profilePicture);console.log('Profile picture selected:',profilePicture.name,profilePicture.size,profilePicture.type);}console.log('Updating profile with form data:',{name:formData.name,username:formData.username,email:formData.email,hasProfilePicture:!!profilePicture});let response,data;try{response=await fetch(\"\".concat(API_URL,\"/api/users/profile\"),{method:'PUT',headers:{'Authorization':\"Bearer \".concat(token)},body:uploadFormData});console.log('Response status:',response.status);data=await response.json();console.log('[PROFILE UPDATE DEBUG] Full server response:',data);if(data&&data.user){console.log('[PROFILE UPDATE DEBUG] Returned user.profilePicture:',data.user.profilePicture);alert('Backend response profilePicture: '+data.user.profilePicture);}}catch(err){console.error('[PROFILE UPDATE DEBUG] Error during fetch:',err);return;}if(response.ok){setSuccess('Profile updated successfully!');// Update both localStorage and AuthContext with new user data\nconst updatedUser=_objectSpread(_objectSpread({},user),{},{name:data.user.name,username:data.user.username,email:data.user.email,phone:data.user.phone},data.user.profilePicture&&{profilePicture:data.user.profilePicture});// Extract timestamp from filename for cache busting\nlet cacheBuster='';if(data.user.profilePicture){const match=data.user.profilePicture.match(/profile-(\\d+)/);if(match&&match[1]){cacheBuster=match[1];}}console.log('[PROFILE UPDATE DEBUG] Using cacheBuster:',cacheBuster);updateUser(_objectSpread(_objectSpread({},updatedUser),{},{_profilePicCacheBuster:cacheBuster}));setProfilePicKey(prev=>prev+1);// Force re-render\n// Reset profile picture state but keep the new image visible\nsetProfilePicture(null);setProfilePicturePreview('');// Update form data to reflect changes\nsetFormData({name:data.user.name,email:data.user.email,username:data.user.username,phone:data.user.phone||''});// Close editing mode after successful update\nsetTimeout(()=>{setIsEditing(false);},100);}else{console.error('Profile update failed:',data);setError(data.message||'Failed to update profile');}}catch(error){console.error('Profile update error:',error);setError('Network error. Please try again.');}finally{setLoading(false);}};const handleDeleteAccount=async()=>{if(!window.confirm('Are you sure you want to delete your account? This action cannot be undone.')){return;}setLoading(true);setError(null);try{const API_URL=getApiUrl();const response=await fetch(\"\".concat(API_URL,\"/api/users/profile\"),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){logout();onClose();alert('Account deleted successfully');}else{const data=await response.json();setError(data.message||'Failed to delete account');}}catch(error){setError('Network error. Please try again.');}finally{setLoading(false);}};// Render modal using portal to escape #Wrap container\nreturn/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:e=>{// Close modal when clicking on backdrop\nif(e.target===e.currentTarget){console.log('Backdrop clicked, closing modal');handleModalClose();}},children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",onClick:e=>{// Prevent modal from closing when clicking inside the modal\ne.stopPropagation();},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'20px',flexShrink:0},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,color:'#333'},children:t('userProfile.title')}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.preventDefault();e.stopPropagation();handleModalClose();},style:{background:'#e74c3c',border:'none',width:'22px',height:'22px',borderRadius:'50%',display:'flex',alignItems:'center',justifyContent:'center',padding:0,cursor:'pointer',boxShadow:'0 2px 8px rgba(231,76,60,0.10)',zIndex:10000},\"aria-label\":\"Close\",title:\"Close\",type:\"button\",children:/*#__PURE__*/_jsx(\"span\",{style:{color:'#fff',fontSize:'2rem',fontWeight:900,lineHeight:1,display:'flex',alignItems:'center',justifyContent:'center',width:'100%',height:'100%'},children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',marginBottom:'20px',borderBottom:'1px solid #ddd',flexShrink:0},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('profile'),style:{padding:'10px 20px',border:'none',background:activeTab==='profile'?'#2196F3':'transparent',color:activeTab==='profile'?'white':'#666',cursor:'pointer',borderRadius:'4px 4px 0 0',marginRight:'5px'},children:t('userProfile.profileTab')}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('wishlist'),style:{padding:'10px 20px',border:'none',background:activeTab==='wishlist'?'#2196F3':'transparent',color:activeTab==='wishlist'?'white':'#666',cursor:'pointer',borderRadius:'4px 4px 0 0'},children:[t('userProfile.wishlistTab'),\" (\",wishlist.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,overflowY:'auto',overflowX:'hidden',minHeight:0},children:[error&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#ffebee',color:'#c62828',padding:'12px',borderRadius:'4px',marginBottom:'16px'},children:error}),success&&/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'#e8f5e8',color:'#2e7d32',padding:'12px',borderRadius:'4px',marginBottom:'16px'},children:success}),activeTab==='profile'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'20px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'12px',marginBottom:'20px'},children:[/*#__PURE__*/_jsx(\"img\",{src:profilePicturePreview||getProfileImageUrl(user===null||user===void 0?void 0:user.profilePicture),alt:user&&user.username?\"\".concat(user.username,\"'s profile\"):'User profile',style:{width:'60px',height:'60px',borderRadius:'50%',objectFit:'cover',border:'2px solid #ddd'}},profilePicKey),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 4px 0'},children:user?user.username:''}),user&&/*#__PURE__*/_jsx(\"span\",{style:{color:'#4CAF50',fontSize:'14px'},children:t('userProfile.online')})]})]})}),isEditing?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpdateProfile,children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'15px'},children:/*#__PURE__*/_jsx(\"img\",{src:profilePicturePreview||getProfileImageUrl(user===null||user===void 0?void 0:user.profilePicture),alt:user.username?\"\".concat(user.username,\"'s profile\"):'User profile',style:{width:'100px',height:'100px',borderRadius:'50%',objectFit:'cover',border:'3px solid #ddd'}},profilePicKey)}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'15px'},children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"profilePictureInput\",style:{display:'inline-block',padding:'8px 16px',backgroundColor:'#f0f0f0',border:'1px solid #ddd',borderRadius:'20px',cursor:'pointer',fontSize:'14px',color:'#333',width:'100%',textAlign:'center'},tabIndex:0,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleProfilePictureChange,style:{display:'none'},id:\"profilePictureInput\",\"aria-label\":\"Profile picture\",autoComplete:\"photo\"}),/*#__PURE__*/_jsxs(\"span\",{role:\"button\",style:{fontSize:'18px',verticalAlign:'middle'},children:[\"\\uD83D\\uDCF7 \",t('userProfile.changePhoto')]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'4px',fontWeight:'bold'},children:t('userProfile.fullName')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"profileNameInput\",name:\"name\",value:formData.name,onChange:handleInputChange,style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'16px',WebkitUserSelect:'text',userSelect:'text'},required:true,autoComplete:\"name\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'4px',fontWeight:'bold'},children:t('userProfile.phone')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"profileContactNum\",name:\"contactNum\",value:formData.phone,onChange:e=>setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{phone:e.target.value})),style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'16px',background:'#fff'},autoComplete:\"off\",\"data-form-type\":\"other\",\"data-lpignore\":\"true\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'4px',fontWeight:'bold'},children:t('userProfile.email')}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"profileEmailInput\",name:\"email\",value:formData.email,onChange:handleInputChange,style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'16px',WebkitUserSelect:'text',userSelect:'text'},required:true,autoComplete:\"email\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'4px',fontWeight:'bold'},children:t('userProfile.username')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"profileUsernameInput\",name:\"username\",value:formData.username,onChange:handleInputChange,style:{width:'100%',padding:'8px 12px',border:'1px solid #ddd',borderRadius:'4px',fontSize:'16px',WebkitUserSelect:'text',userSelect:'text'},required:true,autoComplete:\"username\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',padding:'15px',backgroundColor:'#f8f9fa',borderRadius:'8px',border:'1px solid #e9ecef'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 10px 0',color:'#333',fontSize:'16px'},children:t('userProfile.password')}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0 0 15px 0',fontSize:'14px',color:'#666'},children:t('userProfile.passwordInfo')}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:handlePasswordReset,style:{padding:'8px 16px',backgroundColor:'#6c757d',color:'white',border:'none',borderRadius:'20px',cursor:'pointer',fontSize:'14px',fontWeight:'500'},children:[\"\\uD83D\\uDD11 \",t('userProfile.sendPasswordReset')]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,style:{padding:'10px 20px',backgroundColor:'#4CAF50',color:'white',border:'none',borderRadius:'4px',cursor:loading?'not-allowed':'pointer',opacity:loading?0.6:1},children:loading?t('userProfile.saving'):t('userProfile.saveChanges')}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{console.log('Cancel button clicked');setIsEditing(false);},style:{padding:'10px 20px',backgroundColor:'#757575',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},children:t('userProfile.cancel')})]})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'bold',fontSize:'1.1em'},children:[t('userProfile.fullName'),\":\"]}),\" \",user?user.name:'']}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'bold',fontSize:'1.1em'},children:[t('userProfile.email'),\":\"]}),\" \",user?user.email:'']}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'bold',fontSize:'1.1em'},children:[t('userProfile.username'),\":\"]}),\" \",user?user.username:'']}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:'bold',fontSize:'1.1em'},children:[t('userProfile.phone'),\":\"]}),\" \",typedUser?typedUser.phone:'']}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'12px',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(true),style:{padding:'10px 20px',backgroundColor:'#2196F3',color:'white',border:'none',borderRadius:'4px',cursor:'pointer'},children:t('userProfile.editProfile')}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDeleteAccount,disabled:loading,style:{padding:'10px 20px',backgroundColor:'#f44336',color:'white',border:'none',borderRadius:'4px',cursor:loading?'not-allowed':'pointer',opacity:loading?0.6:1},children:loading?t('userProfile.deleting'):t('userProfile.deleteAccount')})]})]})]}),activeTab==='wishlist'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{style:{marginBottom:'20px',fontSize:'1.2em'},children:[t('userProfile.myWishlist'),\" (\",wishlist.length,\")\"]}),loadingWishlist?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px',fontSize:'1.1em'},children:t('userProfile.loadingWishlist')}):wishlist.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'40px',color:'#666',fontSize:'1.1em'},children:[/*#__PURE__*/_jsx(\"p\",{children:t('userProfile.emptyWishlist')}),/*#__PURE__*/_jsx(\"p\",{children:t('userProfile.emptyWishlistHint')})]}):/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'400px',overflowY:'auto'},children:wishlist.map(dog=>/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #ddd',borderRadius:'8px',padding:'15px',marginBottom:'15px',display:'flex',gap:'15px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"img\",{src:((_dog$thumbnail,_dog$images,_dog$images$)=>{const url=((_dog$thumbnail=dog.thumbnail)===null||_dog$thumbnail===void 0?void 0:_dog$thumbnail.url)||((_dog$images=dog.images)===null||_dog$images===void 0?void 0:(_dog$images$=_dog$images[0])===null||_dog$images$===void 0?void 0:_dog$images$.url);if(!url)return'../img/placeholder-dog.jpg';if(/^https?:\\/\\//.test(url))return url;if(url.startsWith('/uploads/')||url.startsWith('/u/dogs/')){const apiBase=process.env.REACT_APP_API_URL||'http://localhost:3001';return apiBase+url;}// Fallback to placeholder if not a valid path\nreturn'../img/placeholder-dog.jpg';})(),alt:dog.name,style:{width:'60px',height:'60px',borderRadius:'8px',objectFit:'cover'}}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:'0 0 5px 0',color:'#333'},children:dog.name}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:'0 0 5px 0',fontSize:'14px',color:'#666'},children:[dog.breed,\" \\u2022 \",dog.age,\" years \\u2022 \",dog.size,\" \\u2022 \",dog.location||dog.place]}),dog.description&&/*#__PURE__*/_jsx(\"p\",{style:{margin:'0',fontSize:'13px',color:'#888',maxWidth:'300px'},children:dog.description.length>100?dog.description.substring(0,100)+'...':dog.description})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'8px'},children:[dog.adoptionStatus==='pending'&&dog.adoptionQueue&&user&&dog.adoptionQueue.adopter===user._id?/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{// Odustani (cancel adoption)\ntry{const API_URL=getApiUrl();const resp=await fetch(\"\".concat(API_URL,\"/api/dogs/\").concat(dog._id,\"/adopt-cancel\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':token?\"Bearer \".concat(token):''},body:JSON.stringify({reason:''})});const data=await resp.json();if(!resp.ok)throw new Error(data.message||'Error');await loadWishlist();}catch(e){alert(e.message||'Error');}},style:{padding:'8px 16px',backgroundColor:'#e74c3c',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'14px',whiteSpace:'nowrap'},children:t('button.cancelAdoption')||'Odustani od posvajanja'}):dog.adoptionStatus==='pending'?/*#__PURE__*/_jsx(\"button\",{disabled:true,style:{padding:'8px 16px',backgroundColor:'#aaa',color:'white',border:'none',borderRadius:'4px',cursor:'not-allowed',fontSize:'14px',whiteSpace:'nowrap'},children:t('button.requested')||'Zahtjev poslan'}):/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{handleAdopt(dog._id);},style:{padding:'8px 16px',backgroundColor:'#4CAF50',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'14px',whiteSpace:'nowrap'},children:[\"\\uD83C\\uDFE0 \",t('button.adopt')]}),/*#__PURE__*/_jsxs(\"button\",{onClick:async()=>{// const removeKey = t('userProfile.remove');\n// const fallbackRemove = t('button.removeFromList');\nsetWishlist(prev=>prev.filter(d=>d._id!==dog._id));await removeFromWishlist(dog._id);if(user){updateUser(_objectSpread(_objectSpread({},user),{},{wishlist:(user.wishlist||[]).filter(id=>id!==dog._id)}));}},style:{padding:'6px 12px',backgroundColor:'#ff4444',color:'white',border:'none',borderRadius:'20px',cursor:'pointer',fontSize:'14px',fontWeight:600,display:'flex',alignItems:'center',gap:4,boxShadow:'0 0 0 2px #ff4444',transition:'background 0.2s, box-shadow 0.2s'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:18},children:\"\\uD83D\\uDC94\"}),\" \",t('button.removeFromList','Entfernen')]})]})]},dog._id))})]})]})]})}),modalRoot);};export default UserProfileModal;","map":{"version":3,"names":["React","useState","ReactDOM","useTranslation","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","modalRoot","document","getElementById","root","createElement","id","style","position","top","left","zIndex","pointerEvents","body","appendChild","UserProfileModal","_ref","isOpen","onClose","user","token","logout","updateUser","getWishlist","removeFromWishlist","typedUser","t","isEditing","setIsEditing","activeTab","setActiveTab","wishlist","setWishlist","loadingWishlist","setLoadingWishlist","profilePicture","setProfilePicture","profilePicturePreview","setProfilePicturePreview","getProfileImageUrl","url","startsWith","replace","apiBase","process","env","REACT_APP_API_URL","test","formData","setFormData","name","email","username","phone","loading","setLoading","error","setError","profilePicKey","setProfilePicKey","success","setSuccess","loadWishlist","useCallback","wishlistData","useEffect","handler","e","detail","Array","isArray","window","addEventListener","removeEventListener","_id","handleModalClose","console","log","handleEscapeKey","event","key","overflow","width","height","scrollY","dataset","toString","touchAction","scrollTo","parseInt","handleAdopt","dogId","API_URL","getApiUrl","resp","fetch","concat","method","headers","data","json","ok","Error","message","alert","handleProfilePictureChange","_e$target$files","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","handlePasswordReset","response","JSON","stringify","location","hostname","handleInputChange","_objectSpread","value","handleUpdateProfile","type","preventDefault","uploadFormData","FormData","append","size","hasProfilePicture","status","err","updatedUser","cacheBuster","match","_profilePicCacheBuster","prev","setTimeout","handleDeleteAccount","confirm","createPortal","className","onClick","currentTarget","children","stopPropagation","display","justifyContent","alignItems","marginBottom","flexShrink","margin","color","background","border","borderRadius","padding","cursor","boxShadow","title","fontSize","fontWeight","lineHeight","borderBottom","marginRight","length","flex","overflowY","overflowX","minHeight","backgroundColor","gap","src","alt","objectFit","onSubmit","textAlign","htmlFor","tabIndex","accept","onChange","autoComplete","role","verticalAlign","WebkitUserSelect","userSelect","required","marginTop","disabled","opacity","flexWrap","maxHeight","map","dog","_dog$thumbnail","_dog$images","_dog$images$","thumbnail","images","breed","age","place","description","maxWidth","substring","flexDirection","adoptionStatus","adoptionQueue","adopter","reason","whiteSpace","filter","d","transition"],"sources":["/Applications/MAMP/htdocs/eky/client/src/components/UserProfileModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport ReactDOM from 'react-dom';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../contexts/AuthContext';\nimport '../css/modal.css';\n\n// Portal container for modal\nconst modalRoot = document.getElementById('modal-root') || (() => {\n  const root = document.createElement('div');\n  root.id = 'modal-root';\n  // Portal root should NOT block clicks - only modal overlay should\n  root.style.position = 'absolute';\n  root.style.top = '0';\n  root.style.left = '0';\n  root.style.zIndex = '0';\n  root.style.pointerEvents = 'none';\n  document.body.appendChild(root);\n  return root;\n})();\n\ninterface User {\n  id?: string;\n  _id?: string;\n  email?: string;\n  username?: string;\n  name?: string;\n  phone?: string;\n}\n\ninterface UserProfileModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nconst UserProfileModal: React.FC<UserProfileModalProps> = ({ isOpen, onClose }) => {\n  const { user, token, logout, updateUser, getWishlist, removeFromWishlist } = useAuth();\n    const typedUser = user as User;\n  const { t } = useTranslation();\n  const [isEditing, setIsEditing] = useState(false);\n  const [activeTab, setActiveTab] = useState<'profile' | 'wishlist'>('profile');\n  const [wishlist, setWishlist] = useState<any[]>([]);\n  const [loadingWishlist, setLoadingWishlist] = useState(false);\n  const [profilePicture, setProfilePicture] = useState<File | null>(null);\n  const [profilePicturePreview, setProfilePicturePreview] = useState<string>('');\n  \n  // Helper to get full image URL (robust)\n  const getProfileImageUrl = (profilePicture: string | undefined) => {\n    if (!profilePicture) return \"../img/androcolored-80x80.jpg\";\n    let url = profilePicture.startsWith('/') ? profilePicture : '/' + profilePicture;\n    // Use /u/ for compatibility if needed\n    url = url.replace('/uploads', '/u');\n    // Always use API base for /uploads/ and /u/ paths\n    if (url.startsWith('/uploads/') || url.startsWith('/u/')) {\n      const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:3001';\n      return apiBase + url;\n    }\n    // If already absolute URL, return as is\n    if (/^https?:\\/\\//.test(url)) return url;\n    // Fallback to placeholder\n    return '../img/androcolored-80x80.jpg';\n  };\n  const [formData, setFormData] = useState({\n     name: typedUser?.name || '',\n     email: typedUser?.email || '',\n     username: typedUser?.username || '',\n     phone: typedUser?.phone || '',\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Used to force re-render after profile update\n  const [profilePicKey, setProfilePicKey] = useState(0);\n  const [success, setSuccess] = useState<string | null>(null);\n\n\n\n\n\n\n\n\n  const loadWishlist = React.useCallback(async () => {\n    setLoadingWishlist(true);\n    const wishlistData = await getWishlist();\n    setWishlist(wishlistData);\n    setLoadingWishlist(false);\n  }, [getWishlist]);\n\n  // Load wishlist when modal opens and wishlist tab is active\n  React.useEffect(() => {\n    if (isOpen) {\n      loadWishlist();\n    }\n    // Reset form data when modal opens\n    if (isOpen && user) {\n      setFormData({\n          name: typedUser.name || '',\n          email: typedUser.email || '',\n          username: typedUser.username || '',\n          phone: typedUser.phone || '',\n      });\n      setProfilePicture(null);\n      setProfilePicturePreview('');\n      setError(null);\n      setSuccess(null);\n    } else if (isOpen && !user) {\n      setFormData({ name: '', email: '', username: '', phone: '' });\n      setProfilePicture(null);\n      setProfilePicturePreview('');\n      setError(null);\n      setSuccess(null);\n    }\n    // Listen for wishlist-updated events (from DogList add)\n    const handler = (e: any) => {\n      if (e.detail && Array.isArray(e.detail.wishlist)) {\n        setWishlist(e.detail.wishlist);\n      }\n    };\n    window.addEventListener('wishlist-updated', handler);\n    return () => window.removeEventListener('wishlist-updated', handler);\n    // Only re-run when modal opens/closes or user ID changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen, typedUser?._id]);\n\n  const handleModalClose = React.useCallback(() => {\n    console.log('handleModalClose called');\n    setIsEditing(false);\n    setError(null);\n    setSuccess(null);\n    onClose();\n  }, [onClose]);\n\n  // Handle escape key to close modal\n  React.useEffect(() => {\n    const handleEscapeKey = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isOpen) {\n        console.log('Escape key pressed, closing modal');\n        handleModalClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscapeKey);\n      return () => {\n        document.removeEventListener('keydown', handleEscapeKey);\n      };\n    }\n  }, [isOpen, handleModalClose]);\n\n  // Reset state when modal closes\n  React.useEffect(() => {\n    if (!isOpen) {\n      setIsEditing(false);\n      setActiveTab('profile');\n      setError(null);\n      setSuccess(null);\n      setLoading(false);\n    }\n  }, [isOpen]);\n\n  // Prevent body scrolling when modal is open\n  React.useEffect(() => {\n    if (isOpen) {\n      // Prevent body scroll\n      document.body.style.overflow = 'hidden';\n      document.body.style.position = 'fixed';\n      document.body.style.width = '100%';\n      document.body.style.height = '100%';\n      \n      // Store scroll position\n      const scrollY = window.scrollY;\n      document.body.dataset.scrollY = scrollY.toString();\n      \n      // Prevent touch scrolling on mobile\n      document.body.style.touchAction = 'none';\n    } else {\n      // Restore body scroll\n      const scrollY = document.body.dataset.scrollY || '0';\n      document.body.style.overflow = '';\n      document.body.style.position = '';\n      document.body.style.width = '';\n      document.body.style.height = '';\n      document.body.style.touchAction = '';\n      \n      // Restore scroll position\n      window.scrollTo(0, parseInt(scrollY, 10));\n      \n      // Clear stored scroll position\n      delete document.body.dataset.scrollY;\n    }\n    \n    return () => {\n      // Cleanup when modal unmounts\n      document.body.style.overflow = '';\n      document.body.style.position = '';\n      document.body.style.width = '';\n      document.body.style.height = '';\n      document.body.style.touchAction = '';\n      delete document.body.dataset.scrollY;\n    };\n  }, [isOpen]);\n\n\n  // Don't render if modal is not open - MOVED AFTER ALL HOOKS\n  if (!isOpen) {\n    return null;\n  }\n\n  const handleAdopt = async (dogId: string) => {\n    try {\n      const API_URL = getApiUrl();\n      const resp = await fetch(`${API_URL}/api/dogs/${dogId}/adopt-request`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': token ? `Bearer ${token}` : ''\n        }\n      });\n      const data = await resp.json();\n      if (!resp.ok) throw new Error(data.message || 'Error');\n      await loadWishlist();\n    } catch (e: any) {\n      alert(e.message || 'Error');\n    }\n  };\n\n  const handleProfilePictureChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setProfilePicture(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setProfilePicturePreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handlePasswordReset = async () => {\n    if (!user?.email) return;\n    \n    try {\n      const API_URL = getApiUrl();\n      const response = await fetch(`${API_URL}/api/users/password-reset`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ email: user.email }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setSuccess('Password reset link sent to your email!');\n        setError(null);\n      } else {\n        setError(data.message || 'Failed to send password reset email');\n        setSuccess(null);\n      }\n    } catch (error) {\n      console.error('Password reset error:', error);\n      setError('Network error. Please try again.');\n      setSuccess(null);\n    }\n  };\n\n  // Get API URL based on environment\n  const getApiUrl = () => {\n    if (process.env.REACT_APP_API_URL) return process.env.REACT_APP_API_URL;\n    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n      return `http://${window.location.hostname}:3001`;\n    }\n    return `http://172.20.10.2:3001`;\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleUpdateProfile = async (e: React.FormEvent) => {\n    console.log('[PROFILE UPDATE DEBUG] handleUpdateProfile called');\n    if (profilePicture) {\n      console.log('[PROFILE UPDATE DEBUG] Uploading file:', profilePicture.name, 'type:', profilePicture.type);\n    }\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n    setSuccess(null);\n\n    try {\n      const API_URL = getApiUrl();\n      \n      // Create FormData for file upload\n      const uploadFormData = new FormData();\n      uploadFormData.append('name', formData.name);\n      uploadFormData.append('username', formData.username);\n      uploadFormData.append('email', formData.email);\n      uploadFormData.append('phone', formData.phone);\n      \n      // Add profile picture if selected\n      if (profilePicture) {\n        uploadFormData.append('profilePicture', profilePicture);\n        console.log('Profile picture selected:', profilePicture.name, profilePicture.size, profilePicture.type);\n      }\n      \n      console.log('Updating profile with form data:', {\n        name: formData.name,\n        username: formData.username,\n        email: formData.email,\n        hasProfilePicture: !!profilePicture\n      });\n      \n      let response, data;\n      try {\n        response = await fetch(`${API_URL}/api/users/profile`, {\n          method: 'PUT',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: uploadFormData,\n        });\n        console.log('Response status:', response.status);\n        data = await response.json();\n        console.log('[PROFILE UPDATE DEBUG] Full server response:', data);\n        if (data && data.user) {\n          console.log('[PROFILE UPDATE DEBUG] Returned user.profilePicture:', data.user.profilePicture);\n          alert('Backend response profilePicture: ' + data.user.profilePicture);\n        }\n      } catch (err) {\n        console.error('[PROFILE UPDATE DEBUG] Error during fetch:', err);\n        return;\n      }\n\n      if (response.ok) {\n        setSuccess('Profile updated successfully!');\n        \n        // Update both localStorage and AuthContext with new user data\n        const updatedUser = { \n          ...user, \n          name: data.user.name,\n          username: data.user.username,\n          email: data.user.email,\n          phone: data.user.phone,\n          ...(data.user.profilePicture && { profilePicture: data.user.profilePicture })\n        } as any;\n        \n\n        // Extract timestamp from filename for cache busting\n        let cacheBuster = '';\n        if (data.user.profilePicture) {\n          const match = data.user.profilePicture.match(/profile-(\\d+)/);\n          if (match && match[1]) {\n            cacheBuster = match[1];\n          }\n        }\n        console.log('[PROFILE UPDATE DEBUG] Using cacheBuster:', cacheBuster);\n\n        updateUser({ ...updatedUser, _profilePicCacheBuster: cacheBuster });\n        setProfilePicKey(prev => prev + 1); // Force re-render\n\n        // Reset profile picture state but keep the new image visible\n        setProfilePicture(null);\n        setProfilePicturePreview('');\n        \n        // Update form data to reflect changes\n        setFormData({\n          name: data.user.name,\n          email: data.user.email,\n          username: data.user.username,\n          phone: data.user.phone || ''\n        });\n        \n        // Close editing mode after successful update\n        setTimeout(() => {\n          setIsEditing(false);\n        }, 100);\n      } else {\n        console.error('Profile update failed:', data);\n        setError(data.message || 'Failed to update profile');\n      }\n    } catch (error) {\n      console.error('Profile update error:', error);\n      setError('Network error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteAccount = async () => {\n    if (!window.confirm('Are you sure you want to delete your account? This action cannot be undone.')) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const API_URL = getApiUrl();\n      const response = await fetch(`${API_URL}/api/users/profile`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n      });\n\n      if (response.ok) {\n        logout();\n        onClose();\n        alert('Account deleted successfully');\n      } else {\n        const data = await response.json();\n        setError(data.message || 'Failed to delete account');\n      }\n    } catch (error) {\n      setError('Network error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Render modal using portal to escape #Wrap container\n  return ReactDOM.createPortal(\n    <div \n      className=\"modal-overlay\"\n      onClick={(e) => {\n        // Close modal when clicking on backdrop\n        if (e.target === e.currentTarget) {\n          console.log('Backdrop clicked, closing modal');\n          handleModalClose();\n        }\n      }}\n    >\n      <div \n        className=\"modal\"\n        onClick={(e) => {\n          // Prevent modal from closing when clicking inside the modal\n          e.stopPropagation();\n        }}\n      >\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px', flexShrink: 0 }}>\n          <h2 style={{ margin: 0, color: '#333' }}>{t('userProfile.title')}</h2>\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              handleModalClose();\n            }}\n            style={{\n              background: '#e74c3c',\n              border: 'none',\n              width: '22px',\n              height: '22px',\n              borderRadius: '50%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              padding: 0,\n              cursor: 'pointer',\n              boxShadow: '0 2px 8px rgba(231,76,60,0.10)',\n              zIndex: 10000\n            }}\n            aria-label=\"Close\"\n            title=\"Close\"\n            type=\"button\"\n          >\n            <span style={{\n              color: '#fff',\n              fontSize: '2rem',\n              fontWeight: 900,\n              lineHeight: 1,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              width: '100%',\n              height: '100%'\n            }}>Ã—</span>\n          </button>\n        </div>\n\n        {/* Tab Navigation */}\n        <div style={{ display: 'flex', marginBottom: '20px', borderBottom: '1px solid #ddd', flexShrink: 0 }}>\n          <button\n            onClick={() => setActiveTab('profile')}\n            style={{\n              padding: '10px 20px',\n              border: 'none',\n              background: activeTab === 'profile' ? '#2196F3' : 'transparent',\n              color: activeTab === 'profile' ? 'white' : '#666',\n              cursor: 'pointer',\n              borderRadius: '4px 4px 0 0',\n              marginRight: '5px'\n            }}\n          >\n            {t('userProfile.profileTab')}\n          </button>\n          <button\n            onClick={() => setActiveTab('wishlist')}\n            style={{\n              padding: '10px 20px',\n              border: 'none',\n              background: activeTab === 'wishlist' ? '#2196F3' : 'transparent',\n              color: activeTab === 'wishlist' ? 'white' : '#666',\n              cursor: 'pointer',\n              borderRadius: '4px 4px 0 0'\n            }}\n          >\n            {t('userProfile.wishlistTab')} ({wishlist.length})\n          </button>\n        </div>\n\n        <div style={{ flex: 1, overflowY: 'auto', overflowX: 'hidden', minHeight: 0 }}>\n          {error && (\n            <div style={{\n              backgroundColor: '#ffebee',\n              color: '#c62828',\n              padding: '12px',\n              borderRadius: '4px',\n              marginBottom: '16px'\n            }}>\n              {error}\n            </div>\n          )}\n\n          {success && (\n            <div style={{\n              backgroundColor: '#e8f5e8',\n              color: '#2e7d32',\n              padding: '12px',\n              borderRadius: '4px',\n              marginBottom: '16px'\n            }}>\n              {success}\n            </div>\n          )}\n\n        {activeTab === 'profile' && (\n          <>\n            <div style={{ marginBottom: '20px' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '20px' }}>\n                <img \n                  key={profilePicKey}\n                  src={profilePicturePreview || getProfileImageUrl((user as any)?.profilePicture)}\n                  alt={user && user.username ? `${user.username}'s profile` : 'User profile'} \n                  style={{ \n                    width: '60px', \n                    height: '60px', \n                    borderRadius: '50%',\n                    objectFit: 'cover',\n                    border: '2px solid #ddd'\n                  }}\n                />\n                <div>\n                  <h3 style={{ margin: '0 0 4px 0' }}>{user ? user.username : ''}</h3>\n                  {user && <span style={{ color: '#4CAF50', fontSize: '14px' }}>{t('userProfile.online')}</span>}\n                </div>\n              </div>\n            </div>\n\n            {isEditing ? (\n              <form onSubmit={handleUpdateProfile}>\n                {/* Profile Picture Section */}\n                <div style={{ marginBottom: '20px', textAlign: 'center' }}>\n                  <div style={{ marginBottom: '15px' }}>\n                    <img \n                      key={profilePicKey}\n                      src={profilePicturePreview || getProfileImageUrl((user as any)?.profilePicture)}\n                      alt={user.username ? `${user.username}'s profile` : 'User profile'}\n                      style={{ \n                        width: '100px', \n                        height: '100px', \n                        borderRadius: '50%', \n                        objectFit: 'cover',\n                        border: '3px solid #ddd'\n                      }} \n                    />\n                  </div>\n                  <div style={{ marginBottom: '15px' }}>\n                    <label\n                      htmlFor=\"profilePictureInput\"\n                      style={{\n                        display: 'inline-block',\n                        padding: '8px 16px',\n                        backgroundColor: '#f0f0f0',\n                        border: '1px solid #ddd',\n                        borderRadius: '20px',\n                        cursor: 'pointer',\n                        fontSize: '14px',\n                        color: '#333',\n                        width: '100%',\n                        textAlign: 'center'\n                      }}\n                      tabIndex={0}\n                    >\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={handleProfilePictureChange}\n                        style={{ display: 'none' }}\n                        id=\"profilePictureInput\"\n                        aria-label=\"Profile picture\"\n                        autoComplete=\"photo\"\n                      />\n                      <span role=\"button\" style={{fontSize: '18px', verticalAlign: 'middle'}}>\n                        ðŸ“· {t('userProfile.changePhoto')}\n                      </span>\n                    </label>\n                  </div>\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.fullName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"profileNameInput\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleInputChange}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      WebkitUserSelect: 'text',\n                      userSelect: 'text'\n                    }}\n                    required\n                    autoComplete=\"name\"\n                  />\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.phone')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"profileContactNum\"\n                    name=\"contactNum\"\n                    value={formData.phone}\n                    onChange={(e) => setFormData(prev => ({ ...prev, phone: e.target.value }))}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      background: '#fff'\n                    }}\n                    autoComplete=\"off\"\n                    data-form-type=\"other\"\n                    data-lpignore=\"true\"\n                  />\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"profileEmailInput\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleInputChange}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      WebkitUserSelect: 'text',\n                      userSelect: 'text'\n                    }}\n                    required\n                    autoComplete=\"email\"\n                  />\n                </div>\n\n                <div style={{ marginBottom: '16px' }}>\n                  <label style={{ display: 'block', marginBottom: '4px', fontWeight: 'bold' }}>\n                    {t('userProfile.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"profileUsernameInput\"\n                    name=\"username\"\n                    value={formData.username}\n                    onChange={handleInputChange}\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid #ddd',\n                      borderRadius: '4px',\n                      fontSize: '16px',\n                      WebkitUserSelect: 'text',\n                      userSelect: 'text'\n                    }}\n                    required\n                    autoComplete=\"username\"\n                  />\n                </div>\n\n                {/* Password Change Section */}\n                <div style={{ \n                  marginBottom: '20px', \n                  padding: '15px', \n                  backgroundColor: '#f8f9fa', \n                  borderRadius: '8px', \n                  border: '1px solid #e9ecef' \n                }}>\n                  <h4 style={{ margin: '0 0 10px 0', color: '#333', fontSize: '16px' }}>{t('userProfile.password')}</h4>\n                  <p style={{ margin: '0 0 15px 0', fontSize: '14px', color: '#666' }}>\n                    {t('userProfile.passwordInfo')}\n                  </p>\n                  <button\n                    type=\"button\"\n                    onClick={handlePasswordReset}\n                    style={{\n                      padding: '8px 16px',\n                      backgroundColor: '#6c757d',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '20px',\n                      cursor: 'pointer',\n                      fontSize: '14px',\n                      fontWeight: '500'\n                    }}\n                  >\n                    ðŸ”‘ {t('userProfile.sendPasswordReset')}\n                  </button>\n                </div>\n\n                <div style={{ display: 'flex', gap: '12px', marginTop: '20px' }}>\n                  <button\n                    type=\"submit\"\n                    disabled={loading}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#4CAF50',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: loading ? 'not-allowed' : 'pointer',\n                      opacity: loading ? 0.6 : 1\n                    }}\n                  >\n                    {loading ? t('userProfile.saving') : t('userProfile.saveChanges')}\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      console.log('Cancel button clicked');\n                      setIsEditing(false);\n                    }}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#757575',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: 'pointer'\n                    }}\n                  >\n                    {t('userProfile.cancel')}\n                  </button>\n                </div>\n              </form>\n            ) : (\n              <div>\n                <div style={{ marginBottom: '16px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.fullName')}:</span> {user ? user.name : ''}\n                </div>\n                <div style={{ marginBottom: '16px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.email')}:</span> {user ? user.email : ''}\n                </div>\n                <div style={{ marginBottom: '20px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.username')}:</span> {user ? user.username : ''}\n                </div>\n                <div style={{ marginBottom: '16px' }}>\n                  <span style={{ fontWeight: 'bold', fontSize: '1.1em' }}>{t('userProfile.phone')}:</span> {typedUser ? typedUser.phone : ''}\n                </div>\n                <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>\n                  <button\n                    onClick={() => setIsEditing(true)}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#2196F3',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: 'pointer'\n                    }}\n                  >\n                    {t('userProfile.editProfile')}\n                  </button>\n                  <button\n                    onClick={handleDeleteAccount}\n                    disabled={loading}\n                    style={{\n                      padding: '10px 20px',\n                      backgroundColor: '#f44336',\n                      color: 'white',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: loading ? 'not-allowed' : 'pointer',\n                      opacity: loading ? 0.6 : 1\n                    }}\n                  >\n                    {loading ? t('userProfile.deleting') : t('userProfile.deleteAccount')}\n                  </button>\n                </div>\n              </div>\n            )}\n          </>\n        )}\n\n        {/* Wishlist Tab Content */}\n        {activeTab === 'wishlist' && (\n          <div>\n            <h3 style={{ marginBottom: '20px', fontSize: '1.2em' }}>{t('userProfile.myWishlist')} ({wishlist.length})</h3>\n            \n            {loadingWishlist ? (\n              <div style={{ textAlign: 'center', padding: '40px', fontSize: '1.1em' }}>{t('userProfile.loadingWishlist')}</div>\n            ) : wishlist.length === 0 ? (\n              <div style={{ textAlign: 'center', padding: '40px', color: '#666', fontSize: '1.1em' }}>\n                <p>{t('userProfile.emptyWishlist')}</p>\n                <p>{t('userProfile.emptyWishlistHint')}</p>\n              </div>\n            ) : (\n              <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\n                {wishlist.map((dog: any) => (\n                  <div \n                    key={dog._id}\n                    style={{\n                      border: '1px solid #ddd',\n                      borderRadius: '8px',\n                      padding: '15px',\n                      marginBottom: '15px',\n                      display: 'flex',\n                      gap: '15px',\n                      alignItems: 'center'\n                    }}\n                  >\n                    <img\n                      src={(() => {\n                        const url = dog.thumbnail?.url || dog.images?.[0]?.url;\n                        if (!url) return '../img/placeholder-dog.jpg';\n                        if (/^https?:\\/\\//.test(url)) return url;\n                        if (url.startsWith('/uploads/') || url.startsWith('/u/dogs/')) {\n                          const apiBase = process.env.REACT_APP_API_URL || 'http://localhost:3001';\n                          return apiBase + url;\n                        }\n                        // Fallback to placeholder if not a valid path\n                        return '../img/placeholder-dog.jpg';\n                      })()}\n                      alt={dog.name}\n                      style={{\n                        width: '60px',\n                        height: '60px',\n                        borderRadius: '8px',\n                        objectFit: 'cover'\n                      }}\n                    />\n                    <div style={{ flex: 1 }}>\n                      <h4 style={{ margin: '0 0 5px 0', color: '#333' }}>{dog.name}</h4>\n                      <p style={{ margin: '0 0 5px 0', fontSize: '14px', color: '#666' }}>\n                        {dog.breed} â€¢ {dog.age} years â€¢ {dog.size} â€¢ {dog.location || dog.place}\n                      </p>\n                      {dog.description && (\n                        <p style={{ margin: '0', fontSize: '13px', color: '#888', maxWidth: '300px' }}>\n                          {dog.description.length > 100 ? dog.description.substring(0, 100) + '...' : dog.description}\n                        </p>\n                      )}\n                    </div>\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                      {(dog.adoptionStatus === 'pending' && dog.adoptionQueue && user && dog.adoptionQueue.adopter === user._id) ? (\n                        <button\n                          onClick={async () => {\n                            // Odustani (cancel adoption)\n                            try {\n                              const API_URL = getApiUrl();\n                              const resp = await fetch(`${API_URL}/api/dogs/${dog._id}/adopt-cancel`, {\n                                method: 'POST',\n                                headers: {\n                                  'Content-Type': 'application/json',\n                                  'Authorization': token ? `Bearer ${token}` : ''\n                                },\n                                body: JSON.stringify({ reason: '' })\n                              });\n                              const data = await resp.json();\n                              if (!resp.ok) throw new Error(data.message || 'Error');\n                              await loadWishlist();\n                            } catch (e) {\n                              alert(e.message || 'Error');\n                            }\n                          }}\n                          style={{\n                            padding: '8px 16px',\n                            backgroundColor: '#e74c3c',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            fontSize: '14px',\n                            whiteSpace: 'nowrap'\n                          }}\n                        >\n                          {t('button.cancelAdoption') || 'Odustani od posvajanja'}\n                        </button>\n                      ) : dog.adoptionStatus === 'pending' ? (\n                        <button\n                          disabled\n                          style={{\n                            padding: '8px 16px',\n                            backgroundColor: '#aaa',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'not-allowed',\n                            fontSize: '14px',\n                            whiteSpace: 'nowrap'\n                          }}\n                        >\n                          {t('button.requested') || 'Zahtjev poslan'}\n                        </button>\n                      ) : (\n                        <button\n                          onClick={() => {\n                            handleAdopt(dog._id);\n                          }}\n                          style={{\n                            padding: '8px 16px',\n                            backgroundColor: '#4CAF50',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            fontSize: '14px',\n                            whiteSpace: 'nowrap'\n                          }}\n                        >\n                          ðŸ  {t('button.adopt')}\n                        </button>\n                      )}\n                      <button\n                        onClick={async () => {\n                          // const removeKey = t('userProfile.remove');\n                          // const fallbackRemove = t('button.removeFromList');\n                          setWishlist(prev => prev.filter((d: any) => d._id !== dog._id));\n                          await removeFromWishlist(dog._id);\n                          if (user) {\n                            updateUser({\n                              ...user,\n                              wishlist: (user.wishlist || []).filter(id => id !== dog._id)\n                            });\n                          }\n                        }}\n                        style={{\n                          padding: '6px 12px',\n                          backgroundColor: '#ff4444',\n                          color: 'white',\n                          border: 'none',\n                          borderRadius: '20px',\n                          cursor: 'pointer',\n                          fontSize: '14px',\n                          fontWeight: 600,\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: 4,\n                          boxShadow: '0 0 0 2px #ff4444',\n                          transition: 'background 0.2s, box-shadow 0.2s',\n                        }}\n                      >\n                        <span style={{fontSize:18}}>ðŸ’”</span> {t('button.removeFromList', 'Entfernen')}\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n        </div>\n      </div>\n    </div>,\n    modalRoot\n  );\n};\n\nexport default UserProfileModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}